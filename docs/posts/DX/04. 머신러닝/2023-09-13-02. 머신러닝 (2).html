<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.433">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="GC">
<meta name="dcterms.date" content="2023-09-13">

<title>Gangcheol - 02. 머신러닝 (2)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../">
<link href="../../../posts/DX/04. 머신러닝/2023-09-14-03. 머신러닝 (3).html" rel="next">
<link href="../../../posts/DX/04. 머신러닝/2023-09-12-01. 머신러닝 (1).html" rel="prev">
<script src="../../../site_libs/quarto-html/quarto.js"></script>
<script src="../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>
<script type="text/javascript">
window.PlotlyConfig = {MathJaxConfig: 'local'};
if (window.MathJax && window.MathJax.Hub && window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}
if (typeof require !== 'undefined') {
require.undef("plotly");
requirejs.config({
    paths: {
        'plotly': ['https://cdn.plot.ly/plotly-2.25.2.min']
    }
});
require(['plotly'], function(Plotly) {
    window._Plotly = Plotly;
});
}
</script>


  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../../../styles.css">
</head>

<body class="nav-sidebar docked nav-fixed">


<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../../index.html">
    <span class="navbar-title">Gangcheol</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="https://gangcheol.github.io/mysite/" rel="" target="">
 <span class="menu-text">Lecture</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://gangcheol.github.io/TI2023/" rel="" target="">
 <span class="menu-text">Tableau</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://gangcheol.github.io/mysite2/" rel="" target="">
 <span class="menu-text">DX</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://gangcheol.github.io/IA2023/" rel="" target="">
 <span class="menu-text">IA2023</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://gangcheol.github.io/ISLP2023/" rel="" target="">
 <span class="menu-text">ISLP2023</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/gangcheol/" rel="" target=""><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">Posts</li><li class="breadcrumb-item"><a href="../../../posts/DX/2023-07-31-00.intro.html">DX</a></li><li class="breadcrumb-item"><a href="../../../posts/DX/04. 머신러닝/2023-09-11-00. intro.html">04. 머신러닝</a></li><li class="breadcrumb-item"><a href="../../../posts/DX/04. 머신러닝/2023-09-13-02. 머신러닝 (2).html">02. 머신러닝 (2)</a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">02. 머신러닝 (2)</h1>
                                <div class="quarto-categories">
                <div class="quarto-category">머신러닝</div>
                <div class="quarto-category">KNN</div>
                <div class="quarto-category">알고리즘</div>
                <div class="quarto-category">평가지표 함수</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>GC </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">September 13, 2023</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation docked overflow-auto">
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../about.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><strong>About Me</strong></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Posts</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">DX</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth2 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/2023-07-31-00.intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">00. Intro &amp; setting</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/2023-08-19-01. Plotly test.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">01. Plotly test</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/2023-10-26-02. BERTopic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">02. BERTopic</span></a>
  </div>
</li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false">
 <span class="menu-text">00. 데이터 다루기</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth3 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/00. 데이터 다루기/2023-08-09-00. Python Basic (1).html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">00. Python Basic (1)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/00. 데이터 다루기/2023-08-10-01. Python Basic (2) .html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">01. Python Basic (2)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/00. 데이터 다루기/2023-08-11-02. Python Basic (3) .html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">02. Python Basic (3)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/00. 데이터 다루기/2023-08-14-03. Python Basic (4).html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">03. Python Basic (4)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/00. 데이터 다루기/2023-08-16-04. Python Basic (5).html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">04. Python Basic (5)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/00. 데이터 다루기/2023-08-17-05. Python Basic (6).html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">05. Python Basic (6)</span></a>
  </div>
</li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="false">
 <span class="menu-text">Extra</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth4 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/00. 데이터 다루기/extra/2023-08-08-Extra 00. 밈.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Extra 00. 밈</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/00. 데이터 다루기/extra/2023-08-09-Extra 01. 클래스.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Extra 01. 클래스</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/00. 데이터 다루기/extra/2023-08-10-Extra 02. 클래스 탐구 (1).html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Extra 02. 클래스 탐구 (1)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/00. 데이터 다루기/extra/2023-08-14-Extra 03. 클래스 탐구 (2).html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Extra 03. 클래스 탐구 (2)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/00. 데이터 다루기/extra/2023-08-15-Extra 04. 클래스 탐구 (3).html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Extra 04. 클래스 탐구 (3)</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="false">
 <span class="menu-text">01. 데이터 다듬기</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth3 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/01. 데이터 다듬기/2023-08-18-00. numpy &amp; pandas (1).html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">00. numpy &amp; pandas (1)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/01. 데이터 다듬기/2023-08-18-01. numpy &amp; pandas (2).html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">01. numpy &amp; pandas (2)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/01. 데이터 다듬기/2023-08-21-02. numpy &amp; pandas (3).html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">02. numpy &amp; pandas (3)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/01. 데이터 다듬기/2023-08-22-03. numpy &amp; pandas (4).html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">03. numpy &amp; pandas (4)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/01. 데이터 다듬기/2023-08-23-04. numpy &amp; pandas (5).html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">04. numpy &amp; pandas (5)</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="false">
 <span class="menu-text">02. 데이터 분석</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth3 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/02. 데이터 분석/2023-08-28-00. 데이터 분석 (1).html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">00. 데이터 분석 (1)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/02. 데이터 분석/2023-08-29-01. 데이터 분석 (2).html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">01. 데이터 분석 (2)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/02. 데이터 분석/2023-09-01-02. 데이터 분석 (2).html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">02. 데이터 분석 (3)</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="false">
 <span class="menu-text">03. 데이터 수집</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth3 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/03. 데이터 수집/2023-09-04-00. 데이터 수집 (1).html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">00. 데이터 수집 (1)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/03. 데이터 수집/2023-09-05-01. 데이터 수집 (2).html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">01. 데이터 수집 (2)</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="true">
 <span class="menu-text">04. 머신러닝</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth3 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/04. 머신러닝/2023-09-11-00. intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">00. Intro</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/04. 머신러닝/2023-09-12-01. 머신러닝 (1).html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">01. 머신러닝 (1)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/04. 머신러닝/2023-09-13-02. 머신러닝 (2).html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">02. 머신러닝 (2)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/04. 머신러닝/2023-09-14-03. 머신러닝 (3).html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">03. 머신러닝 (3)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/04. 머신러닝/2023-09-15-04. 머신러닝 (4).html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">04. 머신러닝 (4)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/04. 머신러닝/2023-09-15-05. 종합실습.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">05. 종합실습</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/04. 머신러닝/2023-09-18-06. 머신러닝 (5).html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">06. 머신러닝 (5)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/04. 머신러닝/2023-09-19-07. 머신러닝 (6).html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">07. 머신러닝 (6)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/04. 머신러닝/2023-09-28-08. summary (1).html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">08. summary (1)</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" aria-expanded="false">
 <span class="menu-text">05. 딥러닝</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth3 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/05. 딥러닝/2023-10-03-00. 딥러닝 (1).html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">00. 딥러닝 (1)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/05. 딥러닝/2023-10-04-01. 딥러닝 (2).html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">01. 딥러닝 (2)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/05. 딥러닝/2023-10-05-02. 딥러닝 (3).html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">02. 딥러닝 (3)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/05. 딥러닝/2023-10-06-03. 딥러닝 (4).html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">03. 딥러닝 (4)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/05. 딥러닝/2023-10-10-Extra 01. 언어지능 (1).html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Extra 01. 언어지능</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/05. 딥러닝/2023-10-11-Extra 02. 시각지능.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Extra 02. 시각지능</span></a>
  </div>
</li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" aria-expanded="false">
 <span class="menu-text">Summary</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-10" class="collapse list-unstyled sidebar-section depth4 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/05. 딥러닝/summary/2023-10-18-summary 01. RNN.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">summary 01. RNN</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/05. 딥러닝/summary/2023-10-18-summary 02. LSTM.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">summary 02. LSTM</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/05. 딥러닝/summary/2023-10-18-summary 03. transformer.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">summary 03. Transformer</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" aria-expanded="false">
 <span class="menu-text">06. 데이터분석표현</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-11" class="collapse list-unstyled sidebar-section depth3 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/06. 데이터분석표현/2023-10-23-00. streamlit.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">00. streamlit</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-12" aria-expanded="false">
 <span class="menu-text">07. IT 인프라</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-12" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-12" class="collapse list-unstyled sidebar-section depth3 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/07. IT 인프라/2023-11-06-00. IT 인프라 (1).html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">00. IT 인프라 (1)</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-13" aria-expanded="false">
 <span class="menu-text">09. 제안전략수립</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-13" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-13" class="collapse list-unstyled sidebar-section depth3 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/09. 제안전략수립/2023-11-23-00. 제안전략수립.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">00. 제안전략수립</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/09. 제안전략수립/2023-11-24-01. 환경분석 기법의 이해.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">01. 환경분석 기법의 이해</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/09. 제안전략수립/2023-11-27-02. 고객가치정의 및 아이디어 도출.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">02. 고객가치정의 및 아이디어 도출</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/09. 제안전략수립/2023-11-28-03. 실행계획 수립.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">03. 실행계획 수립</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/09. 제안전략수립/2023-11-29-04. 사업정의.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">04. 사업정의</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/09. 제안전략수립/2023-11-30-05. 제안서 작성 (1).html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">05. 제안서 작성 (1)</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-14" aria-expanded="false">
 <span class="menu-text">BP</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-14" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-14" class="collapse list-unstyled sidebar-section depth3 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/BP/2023-12-28-00. model train (1).html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">00. model train (1)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/BP/2023-12-28-01. model train (2).html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">01. model train (2)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/BP/2023-12-28-02. model fit &amp; save.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">02. model fit &amp; save</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/BP/2024-01-01-03. model theory.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">03. model theory</span></a>
  </div>
</li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-15" aria-expanded="false">
 <span class="menu-text">Extra</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-15" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-15" class="collapse list-unstyled sidebar-section depth4 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/BP/Extra/2024-01-15-00. CA (1).html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">00. CA (1)</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-16" aria-expanded="false">
 <span class="menu-text">MP</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-16" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-16" class="collapse list-unstyled sidebar-section depth3 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/MP/2023-08-24-00. MP (1).html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">00. MP (1)</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-17" aria-expanded="false">
 <span class="menu-text">EX</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-17" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-17" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/EX/2023-10-30-00. Churn.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">00. Churn</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/EX/2023-10-31-01. VOC.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">01. VOC</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/EX/2023-11-01-02. iris.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">02. iris</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/EX/2023-11-01-03. Titanic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">03. Titanic</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/EX/2024-01-08-04. MNIST.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">04. MNIST</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#import" id="toc-import" class="nav-link active" data-scroll-target="#import">0. import</a></li>
  <li><a href="#선형회귀" id="toc-선형회귀" class="nav-link" data-scroll-target="#선형회귀">1. 선형회귀</a>
  <ul class="collapse">
  <li><a href="#데이터-로드-및-탐색" id="toc-데이터-로드-및-탐색" class="nav-link" data-scroll-target="#데이터-로드-및-탐색">(1) 데이터 로드 및 탐색</a></li>
  <li><a href="#모델링" id="toc-모델링" class="nav-link" data-scroll-target="#모델링">(2) 모델링</a></li>
  <li><a href="#excercise.-1" id="toc-excercise.-1" class="nav-link" data-scroll-target="#excercise.-1">excercise. 1</a>
  <ul class="collapse">
  <li><a href="#데이터-로드-및-전처리" id="toc-데이터-로드-및-전처리" class="nav-link" data-scroll-target="#데이터-로드-및-전처리">(1). 데이터 로드 및 전처리</a></li>
  <li><a href="#모델링-1" id="toc-모델링-1" class="nav-link" data-scroll-target="#모델링-1">(2). 모델링</a></li>
  </ul></li>
  <li><a href="#excercise.-2" id="toc-excercise.-2" class="nav-link" data-scroll-target="#excercise.-2">excercise. 2</a>
  <ul class="collapse">
  <li><a href="#데이터-탐색-및-전처리" id="toc-데이터-탐색-및-전처리" class="nav-link" data-scroll-target="#데이터-탐색-및-전처리">(1) 데이터 탐색 및 전처리</a></li>
  <li><a href="#모델링-2" id="toc-모델링-2" class="nav-link" data-scroll-target="#모델링-2">(2) 모델링</a></li>
  <li><a href="#시각화-1-회귀계수" id="toc-시각화-1-회귀계수" class="nav-link" data-scroll-target="#시각화-1-회귀계수">(3) 시각화 1 : 회귀계수</a></li>
  <li><a href="#시각화-2-잔차-시각화" id="toc-시각화-2-잔차-시각화" class="nav-link" data-scroll-target="#시각화-2-잔차-시각화">(4) 시각화 2 : 잔차 시각화</a></li>
  <li><a href="#시각화-3-y-hat-y" id="toc-시각화-3-y-hat-y" class="nav-link" data-scroll-target="#시각화-3-y-hat-y">(4) 시각화 3 : <span class="math inline">\((y, \hat y)\)</span></a></li>
  </ul></li>
  </ul></li>
  <li><a href="#knn" id="toc-knn" class="nav-link" data-scroll-target="#knn">2. KNN</a>
  <ul class="collapse">
  <li><a href="#데이터-로드-및-탐색-1" id="toc-데이터-로드-및-탐색-1" class="nav-link" data-scroll-target="#데이터-로드-및-탐색-1">(1) 데이터 로드 및 탐색</a></li>
  <li><a href="#결측치-처리" id="toc-결측치-처리" class="nav-link" data-scroll-target="#결측치-처리">(2) 결측치 처리</a></li>
  <li><a href="#변수-제거" id="toc-변수-제거" class="nav-link" data-scroll-target="#변수-제거">(3) 변수 제거</a></li>
  <li><a href="#모델링-3" id="toc-모델링-3" class="nav-link" data-scroll-target="#모델링-3">(4) 모델링</a></li>
  <li><a href="#결과-시각화" id="toc-결과-시각화" class="nav-link" data-scroll-target="#결과-시각화">(5) 결과 시각화</a></li>
  <li><a href="#exercise.-1" id="toc-exercise.-1" class="nav-link" data-scroll-target="#exercise.-1">exercise. 1</a>
  <ul class="collapse">
  <li><a href="#데이터-탐색-및-전처리-1" id="toc-데이터-탐색-및-전처리-1" class="nav-link" data-scroll-target="#데이터-탐색-및-전처리-1">(1) 데이터 탐색 및 전처리</a></li>
  <li><a href="#모델링-4" id="toc-모델링-4" class="nav-link" data-scroll-target="#모델링-4">(2) 모델링</a></li>
  <li><a href="#결과-시각화-1-y-hat-y-클래스-비교" id="toc-결과-시각화-1-y-hat-y-클래스-비교" class="nav-link" data-scroll-target="#결과-시각화-1-y-hat-y-클래스-비교">(3) 결과 시각화 1 : <span class="math inline">\((y, \hat y)\)</span> 클래스 비교</a></li>
  <li><a href="#결과-시각화-2-평가지표" id="toc-결과-시각화-2-평가지표" class="nav-link" data-scroll-target="#결과-시각화-2-평가지표">(4) 결과 시각화 2 : 평가지표</a></li>
  </ul></li>
  <li><a href="#excercise.-2-불균형-클래스" id="toc-excercise.-2-불균형-클래스" class="nav-link" data-scroll-target="#excercise.-2-불균형-클래스">excercise. 2 (불균형 클래스)</a>
  <ul class="collapse">
  <li><a href="#데이터-로드-및-탐색-2" id="toc-데이터-로드-및-탐색-2" class="nav-link" data-scroll-target="#데이터-로드-및-탐색-2">(1) 데이터 로드 및 탐색</a></li>
  <li><a href="#데이터-준비" id="toc-데이터-준비" class="nav-link" data-scroll-target="#데이터-준비">(2) 데이터 준비</a></li>
  <li><a href="#모델링-5" id="toc-모델링-5" class="nav-link" data-scroll-target="#모델링-5">(3) 모델링</a></li>
  <li><a href="#결과-시각화-1-y-hat-y-클래스-비교-1" id="toc-결과-시각화-1-y-hat-y-클래스-비교-1" class="nav-link" data-scroll-target="#결과-시각화-1-y-hat-y-클래스-비교-1">(4) 결과 시각화 1 : <span class="math inline">\((y, \hat y)\)</span> 클래스 비교</a></li>
  <li><a href="#결과-시각화-2-평가지표-1" id="toc-결과-시각화-2-평가지표-1" class="nav-link" data-scroll-target="#결과-시각화-2-평가지표-1">(5) 결과 시각화 2 : 평가지표</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#decision-tree" id="toc-decision-tree" class="nav-link" data-scroll-target="#decision-tree">3. Decision Tree</a>
  <ul class="collapse">
  <li><a href="#실습" id="toc-실습" class="nav-link" data-scroll-target="#실습">실습</a>
  <ul class="collapse">
  <li><a href="#데이터-로드-및-탐색-3" id="toc-데이터-로드-및-탐색-3" class="nav-link" data-scroll-target="#데이터-로드-및-탐색-3">(1) 데이터 로드 및 탐색</a></li>
  <li><a href="#모델링-6" id="toc-모델링-6" class="nav-link" data-scroll-target="#모델링-6">(2) 모델링</a></li>
  <li><a href="#시각화-1-평가지표" id="toc-시각화-1-평가지표" class="nav-link" data-scroll-target="#시각화-1-평가지표">(3) 시각화 1 : 평가지표</a></li>
  <li><a href="#시각화-2-tree-모델" id="toc-시각화-2-tree-모델" class="nav-link" data-scroll-target="#시각화-2-tree-모델">(4) 시각화 2 : tree 모델</a></li>
  <li><a href="#시각화-3-변수-중요도" id="toc-시각화-3-변수-중요도" class="nav-link" data-scroll-target="#시각화-3-변수-중요도">(5) 시각화 3 : 변수 중요도</a></li>
  </ul></li>
  <li><a href="#excercise.-1-1" id="toc-excercise.-1-1" class="nav-link" data-scroll-target="#excercise.-1-1">excercise. 1</a>
  <ul class="collapse">
  <li><a href="#데이터-로드-및-탐색-4" id="toc-데이터-로드-및-탐색-4" class="nav-link" data-scroll-target="#데이터-로드-및-탐색-4">(1) 데이터 로드 및 탐색</a></li>
  <li><a href="#모델링-7" id="toc-모델링-7" class="nav-link" data-scroll-target="#모델링-7">(2) 모델링</a></li>
  <li><a href="#시각화-1-평가지표-1" id="toc-시각화-1-평가지표-1" class="nav-link" data-scroll-target="#시각화-1-평가지표-1">(3) 시각화 1 : 평가지표</a></li>
  <li><a href="#시각화-2-tree-모델-1" id="toc-시각화-2-tree-모델-1" class="nav-link" data-scroll-target="#시각화-2-tree-모델-1">(4) 시각화 2 : tree 모델</a></li>
  <li><a href="#시각화-3-변수-중요도-1" id="toc-시각화-3-변수-중요도-1" class="nav-link" data-scroll-target="#시각화-3-변수-중요도-1">(5) 시각화 3 : 변수 중요도</a></li>
  </ul></li>
  <li><a href="#excercise.-2-1" id="toc-excercise.-2-1" class="nav-link" data-scroll-target="#excercise.-2-1">excercise. 2</a>
  <ul class="collapse">
  <li><a href="#데이터-로드-및-탐색-5" id="toc-데이터-로드-및-탐색-5" class="nav-link" data-scroll-target="#데이터-로드-및-탐색-5">(1) 데이터 로드 및 탐색</a></li>
  <li><a href="#데이터-분리" id="toc-데이터-분리" class="nav-link" data-scroll-target="#데이터-분리">(2) 데이터 분리</a></li>
  <li><a href="#모델링-8" id="toc-모델링-8" class="nav-link" data-scroll-target="#모델링-8">(3) 모델링</a></li>
  <li><a href="#시각화-1.-평가지표" id="toc-시각화-1.-평가지표" class="nav-link" data-scroll-target="#시각화-1.-평가지표">(4) 시각화 1. 평가지표</a></li>
  <li><a href="#시각화-2-tree-모델-2" id="toc-시각화-2-tree-모델-2" class="nav-link" data-scroll-target="#시각화-2-tree-모델-2">(5) 시각화 2 : tree 모델</a></li>
  <li><a href="#시각화-3-변수-중요도-2" id="toc-시각화-3-변수-중요도-2" class="nav-link" data-scroll-target="#시각화-3-변수-중요도-2">(5) 시각화 3 : 변수 중요도</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#logistic-regression" id="toc-logistic-regression" class="nav-link" data-scroll-target="#logistic-regression">4. Logistic Regression</a>
  <ul class="collapse">
  <li><a href="#데이터-로드-및-탐색-6" id="toc-데이터-로드-및-탐색-6" class="nav-link" data-scroll-target="#데이터-로드-및-탐색-6">(1) 데이터 로드 및 탐색</a></li>
  <li><a href="#데이터-준비-1" id="toc-데이터-준비-1" class="nav-link" data-scroll-target="#데이터-준비-1">(2) 데이터 준비</a></li>
  <li><a href="#모델링-9" id="toc-모델링-9" class="nav-link" data-scroll-target="#모델링-9">(3) 모델링</a></li>
  <li><a href="#extra-확률값-구한-후-결과-계산" id="toc-extra-확률값-구한-후-결과-계산" class="nav-link" data-scroll-target="#extra-확률값-구한-후-결과-계산">(4) extra : 확률값 구한 후 결과 계산</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<section id="import" class="level1">
<h1>0. import</h1>
<div class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1"></a><span class="co"># 라이브러리 불러오기</span></span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="im">import</span> warnings</span>
<span id="cb1-7"><a href="#cb1-7"></a><span class="im">import</span> plotly.express <span class="im">as</span> px</span>
<span id="cb1-8"><a href="#cb1-8"></a><span class="im">import</span> plotly.io <span class="im">as</span> pio</span>
<span id="cb1-9"><a href="#cb1-9"></a>pio.renderers.default <span class="op">=</span> <span class="st">"plotly_mimetype+notebook_connected"</span></span>
<span id="cb1-10"><a href="#cb1-10"></a></span>
<span id="cb1-11"><a href="#cb1-11"></a>warnings.filterwarnings(action<span class="op">=</span><span class="st">'ignore'</span>)</span>
<span id="cb1-12"><a href="#cb1-12"></a><span class="op">%</span>config InlineBackend.figure_format<span class="op">=</span><span class="st">'retina'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="선형회귀" class="level1">
<h1>1. 선형회귀</h1>
<p><code>-</code> <a href="https://gangcheol.github.io/ISLP2023/posts/2023-09-09-00.%20Linear%20Regression.html">review</a></p>
<section id="데이터-로드-및-탐색" class="level2">
<h2 class="anchored" data-anchor-id="데이터-로드-및-탐색">(1) 데이터 로드 및 탐색</h2>
<div class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1"></a><span class="co"># 데이터 읽어오기</span></span>
<span id="cb2-2"><a href="#cb2-2"></a>path <span class="op">=</span> <span class="st">'https://bit.ly/CarsFile'</span></span>
<span id="cb2-3"><a href="#cb2-3"></a>data <span class="op">=</span> pd.read_csv(path)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1"></a>data.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="3">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">speed</th>
<th data-quarto-table-cell-role="th">dist</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>4</td>
<td>2</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>4</td>
<td>10</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>7</td>
<td>4</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>7</td>
<td>22</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>8</td>
<td>16</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1"></a>data.describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="4">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">speed</th>
<th data-quarto-table-cell-role="th">dist</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">count</td>
<td>50.000000</td>
<td>50.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">mean</td>
<td>15.400000</td>
<td>42.980000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">std</td>
<td>5.287644</td>
<td>25.769377</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">min</td>
<td>4.000000</td>
<td>2.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">25%</td>
<td>12.000000</td>
<td>26.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">50%</td>
<td>15.000000</td>
<td>36.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">75%</td>
<td>19.000000</td>
<td>56.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">max</td>
<td>25.000000</td>
<td>120.000000</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1"></a>data.isnull().<span class="bu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="5">
<pre><code>speed    0
dist     0
dtype: int64</code></pre>
</div>
</div>
<p><code>-</code> <span class="math inline">\((x,y)\)</span> 시각화</p>
<div class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1"></a>plt.figure(figsize <span class="op">=</span> (<span class="dv">4</span>, <span class="dv">4</span>))</span>
<span id="cb7-2"><a href="#cb7-2"></a>plt.plot(data.speed, data.dist, <span class="st">".r"</span>, label <span class="op">=</span> <span class="vs">r"$(x, y)$"</span>,alpha <span class="op">=</span> <span class="fl">0.3</span>)</span>
<span id="cb7-3"><a href="#cb7-3"></a>plt.legend()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="6">
<pre><code>&lt;matplotlib.legend.Legend at 0x1c94b19fb90&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="2023-09-13-02. 머신러닝 (2)_files/figure-html/cell-7-output-2.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="모델링" class="level2">
<h2 class="anchored" data-anchor-id="모델링">(2) 모델링</h2>
<div class="cell" data-execution_count="7">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1"></a>target <span class="op">=</span> <span class="st">"dist"</span></span>
<span id="cb9-2"><a href="#cb9-2"></a></span>
<span id="cb9-3"><a href="#cb9-3"></a><span class="co">## step 1. x,y 부리</span></span>
<span id="cb9-4"><a href="#cb9-4"></a>x  <span class="op">=</span> data.drop(target, axis <span class="op">=</span> <span class="dv">1</span>)</span>
<span id="cb9-5"><a href="#cb9-5"></a>y  <span class="op">=</span> data[target]</span>
<span id="cb9-6"><a href="#cb9-6"></a></span>
<span id="cb9-7"><a href="#cb9-7"></a><span class="co">## step 2. 훈련 데이터와 평가 데이터 분리</span></span>
<span id="cb9-8"><a href="#cb9-8"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb9-9"><a href="#cb9-9"></a></span>
<span id="cb9-10"><a href="#cb9-10"></a>x_train, x_test, y_train, y_test <span class="op">=</span> train_test_split(x, y, random_state <span class="op">=</span> <span class="dv">1</span>, test_size <span class="op">=</span> <span class="fl">0.3</span>)</span>
<span id="cb9-11"><a href="#cb9-11"></a></span>
<span id="cb9-12"><a href="#cb9-12"></a><span class="co">## step 3 . 모델 불러오기</span></span>
<span id="cb9-13"><a href="#cb9-13"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span>  LinearRegression</span>
<span id="cb9-14"><a href="#cb9-14"></a>model1 <span class="op">=</span> LinearRegression()</span>
<span id="cb9-15"><a href="#cb9-15"></a></span>
<span id="cb9-16"><a href="#cb9-16"></a><span class="co">## step 4.  모델 fit</span></span>
<span id="cb9-17"><a href="#cb9-17"></a>model1.fit(x_train, y_train)</span>
<span id="cb9-18"><a href="#cb9-18"></a></span>
<span id="cb9-19"><a href="#cb9-19"></a><span class="co">## step 5. 예측</span></span>
<span id="cb9-20"><a href="#cb9-20"></a>y_pred <span class="op">=</span> model1.predict(x_test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><code>-</code> 회귀계수 확인</p>
<div class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1"></a><span class="bu">print</span>(model1.coef_)</span>
<span id="cb10-2"><a href="#cb10-2"></a><span class="bu">print</span>(model1.intercept_)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[3.91046344]
-16.37336414935769</code></pre>
</div>
</div>
<p><code>-</code> 산출된 회귀식</p>
<p><span class="math display">\[\text{dist} \approx 3.9 \times \text{speed} -16.37\]</span></p>
<p><code>-</code> 결과 시각화</p>
<div class="cell" data-execution_count="9">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1"></a>plt.figure(figsize <span class="op">=</span> (<span class="dv">4</span>,<span class="dv">4</span>))</span>
<span id="cb12-2"><a href="#cb12-2"></a>plt.plot(x_test, y_test, <span class="st">".r"</span>, label <span class="op">=</span><span class="vs">r"$(x,y)$"</span>, alpha <span class="op">=</span> <span class="fl">0.3</span>)</span>
<span id="cb12-3"><a href="#cb12-3"></a>plt.plot(x_test, y_pred, label <span class="op">=</span><span class="vs">r"$(x,\hat </span><span class="sc">{y}</span><span class="vs">)$"</span>, alpha <span class="op">=</span> <span class="fl">0.5</span>)</span>
<span id="cb12-4"><a href="#cb12-4"></a>plt.axhline(y_train.mean(),linestyle <span class="op">=</span> <span class="st">"--"</span>, color <span class="op">=</span> <span class="st">"g"</span>, label <span class="op">=</span> <span class="vs">r"$\bar </span><span class="sc">{y}</span><span class="vs">_</span><span class="sc">{train}</span><span class="vs">$"</span>)</span>
<span id="cb12-5"><a href="#cb12-5"></a>plt.axhline(y_test.mean(),linestyle <span class="op">=</span> <span class="st">"--"</span>, color <span class="op">=</span> <span class="st">"y"</span>, label <span class="op">=</span> <span class="vs">r"$\bar </span><span class="sc">{y}</span><span class="vs">_</span><span class="sc">{test}</span><span class="vs">$"</span>)</span>
<span id="cb12-6"><a href="#cb12-6"></a>plt.legend()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="9">
<pre><code>&lt;matplotlib.legend.Legend at 0x1c94e0b02d0&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="2023-09-13-02. 머신러닝 (2)_files/figure-html/cell-10-output-2.png" class="img-fluid"></p>
</div>
</div>
<p><code>-</code> 예측성능확인</p>
<div class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> <span class="op">*</span></span>
<span id="cb14-2"><a href="#cb14-2"></a></span>
<span id="cb14-3"><a href="#cb14-3"></a><span class="bu">print</span>(<span class="ss">f"MAE :  </span><span class="sc">{</span>mean_absolute_error(y_test, y_pred) <span class="sc">: .2f}</span><span class="ss">"</span> )</span>
<span id="cb14-4"><a href="#cb14-4"></a><span class="bu">print</span>(<span class="ss">f"R2 : </span><span class="sc">{</span>r2_score(y_test, y_pred) <span class="sc">: .2f}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>MAE :   15.11
R2 :  0.55</code></pre>
</div>
</div>
<p><code>-</code> 학습 데이터의 평균 성능은?</p>
<div class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1"></a>y_mean <span class="op">=</span> y_train.mean()</span>
<span id="cb16-2"><a href="#cb16-2"></a>y_mean <span class="op">=</span> [y_mean]<span class="op">*</span><span class="bu">len</span>(y_pred)</span>
<span id="cb16-3"><a href="#cb16-3"></a></span>
<span id="cb16-4"><a href="#cb16-4"></a><span class="bu">print</span>(<span class="ss">f"MAE :  </span><span class="sc">{</span>mean_absolute_error(y_test, y_mean) <span class="sc">: .2f}</span><span class="ss">"</span> )</span>
<span id="cb16-5"><a href="#cb16-5"></a><span class="bu">print</span>(<span class="ss">f"R2 : </span><span class="sc">{</span>r2_score(y_test, y_mean) <span class="sc">: .2f}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>MAE :   18.34
R2 : -0.06</code></pre>
</div>
</div>
</section>
<section id="excercise.-1" class="level2">
<h2 class="anchored" data-anchor-id="excercise.-1">excercise. 1</h2>
<section id="데이터-로드-및-전처리" class="level3">
<h3 class="anchored" data-anchor-id="데이터-로드-및-전처리">(1). 데이터 로드 및 전처리</h3>
<div class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1"></a><span class="co"># 데이터 읽어오기</span></span>
<span id="cb18-2"><a href="#cb18-2"></a>path <span class="op">=</span> <span class="st">'https://raw.githubusercontent.com/Jangrae/csv/master/income_happy.csv'</span></span>
<span id="cb18-3"><a href="#cb18-3"></a>data <span class="op">=</span> pd.read_csv(path)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1"></a>data.isna().<span class="bu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="13">
<pre><code>income       0
happiness    0
dtype: int64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1"></a>data.info()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 498 entries, 0 to 497
Data columns (total 2 columns):
 #   Column     Non-Null Count  Dtype  
---  ------     --------------  -----  
 0   income     498 non-null    float64
 1   happiness  498 non-null    float64
dtypes: float64(2)
memory usage: 7.9 KB</code></pre>
</div>
</div>
</section>
<section id="모델링-1" class="level3">
<h3 class="anchored" data-anchor-id="모델링-1">(2). 모델링</h3>
<div class="cell" data-execution_count="15">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1"></a><span class="co"># step 1.  데이터 분리</span></span>
<span id="cb23-2"><a href="#cb23-2"></a>target <span class="op">=</span> <span class="st">"income"</span></span>
<span id="cb23-3"><a href="#cb23-3"></a></span>
<span id="cb23-4"><a href="#cb23-4"></a>x <span class="op">=</span> data.drop(target, axis <span class="op">=</span> <span class="dv">1</span>)</span>
<span id="cb23-5"><a href="#cb23-5"></a>y <span class="op">=</span> data[target]</span>
<span id="cb23-6"><a href="#cb23-6"></a></span>
<span id="cb23-7"><a href="#cb23-7"></a>x_train, x_test, y_train, y_test <span class="op">=</span> train_test_split(x,y, random_state <span class="op">=</span> <span class="dv">1</span>, test_size <span class="op">=</span> <span class="fl">0.3</span>)</span>
<span id="cb23-8"><a href="#cb23-8"></a></span>
<span id="cb23-9"><a href="#cb23-9"></a><span class="co"># step 2.  model 선언 </span></span>
<span id="cb23-10"><a href="#cb23-10"></a>model2 <span class="op">=</span> LinearRegression()</span>
<span id="cb23-11"><a href="#cb23-11"></a></span>
<span id="cb23-12"><a href="#cb23-12"></a><span class="co"># step 3. fit</span></span>
<span id="cb23-13"><a href="#cb23-13"></a>model2.fit(x_train,y_train)</span>
<span id="cb23-14"><a href="#cb23-14"></a></span>
<span id="cb23-15"><a href="#cb23-15"></a><span class="co"># step 4. predict</span></span>
<span id="cb23-16"><a href="#cb23-16"></a>y_pred <span class="op">=</span> model2.predict(x_test)</span>
<span id="cb23-17"><a href="#cb23-17"></a></span>
<span id="cb23-18"><a href="#cb23-18"></a>r2 <span class="op">=</span> r2_score(y_test, y_pred)</span>
<span id="cb23-19"><a href="#cb23-19"></a>MAE <span class="op">=</span> mean_absolute_error(y_test, y_pred)</span>
<span id="cb23-20"><a href="#cb23-20"></a></span>
<span id="cb23-21"><a href="#cb23-21"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">4</span>,<span class="dv">4</span>))</span>
<span id="cb23-22"><a href="#cb23-22"></a>plt.plot(x_test, y_test, <span class="st">".r"</span>, label <span class="op">=</span> <span class="vs">r"$(x,y)$"</span>, alpha <span class="op">=</span> <span class="fl">0.3</span>)</span>
<span id="cb23-23"><a href="#cb23-23"></a>plt.plot(x_test, y_pred, <span class="st">".b"</span>, label <span class="op">=</span> <span class="vs">r"$(x,\hat </span><span class="sc">{y}</span><span class="vs">)$"</span>, alpha <span class="op">=</span> <span class="fl">0.3</span>)</span>
<span id="cb23-24"><a href="#cb23-24"></a>plt.title(<span class="vs">r"$income = 1.03 \times happiness + 0.963,\,   R^</span><span class="sc">{2}</span><span class="vs"> = 0.75, MAE = 0.69$"</span>,fontsize <span class="op">=</span> <span class="dv">10</span>)</span>
<span id="cb23-25"><a href="#cb23-25"></a>plt.legend()</span>
<span id="cb23-26"><a href="#cb23-26"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="2023-09-13-02. 머신러닝 (2)_files/figure-html/cell-16-output-1.png" class="img-fluid"></p>
</div>
</div>
</section>
</section>
<section id="excercise.-2" class="level2">
<h2 class="anchored" data-anchor-id="excercise.-2">excercise. 2</h2>
<p><strong>데이터 설명</strong></p>
<ul>
<li>Sales: 각 지역 판매량(단위: 1,000개)</li>
<li>CompPrice: 경쟁사 가격 (단위: 달러)</li>
<li>Income: 지역 평균 소득 (단위: 1,000달러)</li>
<li>Advertising: 각 지역, 회사의 광고 예산 (단위: 1,000달러)</li>
<li>Population: 지역 인구 수 (단위: 1,000명)</li>
<li>Price: 자사 지역별 판매 가격 (단위: 달러)</li>
<li>ShelveLoc: 진열 상태</li>
<li>Age: 지역 인구의 평균 연령</li>
<li>Education: 각 지역 교육 수준</li>
<li>Urban: 도심 지역 여부 (Yes,No)</li>
<li>US: 매장이 미국에 있는지 여부 (Yes, No)</li>
</ul>
<section id="데이터-탐색-및-전처리" class="level3">
<h3 class="anchored" data-anchor-id="데이터-탐색-및-전처리">(1) 데이터 탐색 및 전처리</h3>
<div class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1"></a><span class="co"># 데이터 읽어오기</span></span>
<span id="cb24-2"><a href="#cb24-2"></a>path <span class="op">=</span> <span class="st">'https://raw.githubusercontent.com/Jangrae/csv/master/Carseats.csv'</span></span>
<span id="cb24-3"><a href="#cb24-3"></a>data <span class="op">=</span> pd.read_csv(path)</span>
<span id="cb24-4"><a href="#cb24-4"></a></span>
<span id="cb24-5"><a href="#cb24-5"></a>data.isna().<span class="bu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="16">
<pre><code>Sales          0
CompPrice      0
Income         0
Advertising    0
Population     0
Price          0
ShelveLoc      0
Age            0
Education      0
Urban          0
US             0
dtype: int64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1"></a>data.select_dtypes(<span class="st">"number"</span>).corr()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="17">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Sales</th>
<th data-quarto-table-cell-role="th">CompPrice</th>
<th data-quarto-table-cell-role="th">Income</th>
<th data-quarto-table-cell-role="th">Advertising</th>
<th data-quarto-table-cell-role="th">Population</th>
<th data-quarto-table-cell-role="th">Price</th>
<th data-quarto-table-cell-role="th">Age</th>
<th data-quarto-table-cell-role="th">Education</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">Sales</td>
<td>1.000000</td>
<td>0.064079</td>
<td>0.151951</td>
<td>0.269507</td>
<td>0.050471</td>
<td>-0.444951</td>
<td>-0.231815</td>
<td>-0.051955</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">CompPrice</td>
<td>0.064079</td>
<td>1.000000</td>
<td>-0.080653</td>
<td>-0.024199</td>
<td>-0.094707</td>
<td>0.584848</td>
<td>-0.100239</td>
<td>0.025197</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Income</td>
<td>0.151951</td>
<td>-0.080653</td>
<td>1.000000</td>
<td>0.058995</td>
<td>-0.007877</td>
<td>-0.056698</td>
<td>-0.004670</td>
<td>-0.056855</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Advertising</td>
<td>0.269507</td>
<td>-0.024199</td>
<td>0.058995</td>
<td>1.000000</td>
<td>0.265652</td>
<td>0.044537</td>
<td>-0.004557</td>
<td>-0.033594</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Population</td>
<td>0.050471</td>
<td>-0.094707</td>
<td>-0.007877</td>
<td>0.265652</td>
<td>1.000000</td>
<td>-0.012144</td>
<td>-0.042663</td>
<td>-0.106378</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Price</td>
<td>-0.444951</td>
<td>0.584848</td>
<td>-0.056698</td>
<td>0.044537</td>
<td>-0.012144</td>
<td>1.000000</td>
<td>-0.102177</td>
<td>0.011747</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Age</td>
<td>-0.231815</td>
<td>-0.100239</td>
<td>-0.004670</td>
<td>-0.004557</td>
<td>-0.042663</td>
<td>-0.102177</td>
<td>1.000000</td>
<td>0.006488</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Education</td>
<td>-0.051955</td>
<td>0.025197</td>
<td>-0.056855</td>
<td>-0.033594</td>
<td>-0.106378</td>
<td>0.011747</td>
<td>0.006488</td>
<td>1.000000</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p><code>-</code> 컬럼 가변수화</p>
<div class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1"></a>d_cols <span class="op">=</span> [<span class="st">"ShelveLoc"</span>, <span class="st">"Education"</span>, <span class="st">"Urban"</span>, <span class="st">"US"</span>]</span>
<span id="cb27-2"><a href="#cb27-2"></a></span>
<span id="cb27-3"><a href="#cb27-3"></a></span>
<span id="cb27-4"><a href="#cb27-4"></a>_data <span class="op">=</span> pd.get_dummies(data, columns<span class="op">=</span> d_cols, drop_first<span class="op">=</span><span class="va">True</span>, dtype <span class="op">=</span> <span class="st">"float"</span>)</span>
<span id="cb27-5"><a href="#cb27-5"></a>_data.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="18">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Sales</th>
<th data-quarto-table-cell-role="th">CompPrice</th>
<th data-quarto-table-cell-role="th">Income</th>
<th data-quarto-table-cell-role="th">Advertising</th>
<th data-quarto-table-cell-role="th">Population</th>
<th data-quarto-table-cell-role="th">Price</th>
<th data-quarto-table-cell-role="th">Age</th>
<th data-quarto-table-cell-role="th">ShelveLoc_Good</th>
<th data-quarto-table-cell-role="th">ShelveLoc_Medium</th>
<th data-quarto-table-cell-role="th">Education_11</th>
<th data-quarto-table-cell-role="th">Education_12</th>
<th data-quarto-table-cell-role="th">Education_13</th>
<th data-quarto-table-cell-role="th">Education_14</th>
<th data-quarto-table-cell-role="th">Education_15</th>
<th data-quarto-table-cell-role="th">Education_16</th>
<th data-quarto-table-cell-role="th">Education_17</th>
<th data-quarto-table-cell-role="th">Education_18</th>
<th data-quarto-table-cell-role="th">Urban_Yes</th>
<th data-quarto-table-cell-role="th">US_Yes</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>9.50</td>
<td>138</td>
<td>73</td>
<td>11</td>
<td>276</td>
<td>120</td>
<td>42</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>1.0</td>
<td>1.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>11.22</td>
<td>111</td>
<td>48</td>
<td>16</td>
<td>260</td>
<td>83</td>
<td>65</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>1.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>10.06</td>
<td>113</td>
<td>35</td>
<td>10</td>
<td>269</td>
<td>80</td>
<td>59</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>1.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>7.40</td>
<td>117</td>
<td>100</td>
<td>4</td>
<td>466</td>
<td>97</td>
<td>55</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>1.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>4.15</td>
<td>141</td>
<td>64</td>
<td>3</td>
<td>340</td>
<td>128</td>
<td>38</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p><code>-</code> 학습용, 평가용 데이터 분리</p>
<div class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1"></a>target  <span class="op">=</span> <span class="st">"Sales"</span></span>
<span id="cb28-2"><a href="#cb28-2"></a>x <span class="op">=</span> _data.drop(target, axis <span class="op">=</span> <span class="dv">1</span>)</span>
<span id="cb28-3"><a href="#cb28-3"></a>y <span class="op">=</span> _data[target]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1"></a>x_train, x_test, y_train, y_test <span class="op">=</span> train_test_split(x, y, random_state <span class="op">=</span> <span class="dv">1</span>, test_size <span class="op">=</span> <span class="fl">0.3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="모델링-2" class="level3">
<h3 class="anchored" data-anchor-id="모델링-2">(2) 모델링</h3>
<div class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1"></a><span class="co">## 1. 모델 선언</span></span>
<span id="cb30-2"><a href="#cb30-2"></a>model3 <span class="op">=</span> LinearRegression()</span>
<span id="cb30-3"><a href="#cb30-3"></a></span>
<span id="cb30-4"><a href="#cb30-4"></a><span class="co">## 2. model fit</span></span>
<span id="cb30-5"><a href="#cb30-5"></a>model3.fit(x_train, y_train)</span>
<span id="cb30-6"><a href="#cb30-6"></a></span>
<span id="cb30-7"><a href="#cb30-7"></a><span class="co">## 3. predict</span></span>
<span id="cb30-8"><a href="#cb30-8"></a>y_pred <span class="op">=</span> model3.predict(x_test)</span>
<span id="cb30-9"><a href="#cb30-9"></a></span>
<span id="cb30-10"><a href="#cb30-10"></a><span class="co">## 5. 결정계수 및 MAE 값 계산</span></span>
<span id="cb30-11"><a href="#cb30-11"></a>r2 <span class="op">=</span> r2_score(y_test, y_pred)</span>
<span id="cb30-12"><a href="#cb30-12"></a>mae <span class="op">=</span> mean_absolute_error(y_test, y_pred)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="시각화-1-회귀계수" class="level3">
<h3 class="anchored" data-anchor-id="시각화-1-회귀계수">(3) 시각화 1 : 회귀계수</h3>
<div class="cell" data-execution_count="22">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1"></a>x_cols <span class="op">=</span> x_train.columns.values</span>
<span id="cb31-2"><a href="#cb31-2"></a>coef <span class="op">=</span> model3.coef_</span>
<span id="cb31-3"><a href="#cb31-3"></a></span>
<span id="cb31-4"><a href="#cb31-4"></a>fig <span class="op">=</span> pd.DataFrame({<span class="st">"X"</span> : x_cols,</span>
<span id="cb31-5"><a href="#cb31-5"></a>                            <span class="st">"coef"</span> : coef}).<span class="op">\</span></span>
<span id="cb31-6"><a href="#cb31-6"></a>                                sort_values(<span class="st">"coef"</span>,ascending<span class="op">=</span><span class="va">False</span>).<span class="op">\</span></span>
<span id="cb31-7"><a href="#cb31-7"></a>                                                        plot(x<span class="op">=</span><span class="st">"coef"</span>, y<span class="op">=</span><span class="st">"X"</span>,</span>
<span id="cb31-8"><a href="#cb31-8"></a>                                                               color<span class="op">=</span> <span class="st">"X"</span>,kind<span class="op">=</span> <span class="st">"barh"</span>,</span>
<span id="cb31-9"><a href="#cb31-9"></a>                                                                backend <span class="op">=</span> <span class="st">"plotly"</span>,width <span class="op">=</span> <span class="dv">700</span>, height <span class="op">=</span> <span class="dv">450</span>)</span>
<span id="cb31-10"><a href="#cb31-10"></a>fig.update_layout(showlegend<span class="op">=</span><span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">

<div>                            <div id="a724d846-08c8-48be-b40a-7448152615ab" class="plotly-graph-div" style="height:450px; width:700px;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("a724d846-08c8-48be-b40a-7448152615ab")) {                    Plotly.newPlot(                        "a724d846-08c8-48be-b40a-7448152615ab",                        [{"alignmentgroup":"True","hovertemplate":"X=%{y}\u003cbr\u003ecoef=%{x}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"ShelveLoc_Good","marker":{"color":"#636efa","pattern":{"shape":""}},"name":"ShelveLoc_Good","offsetgroup":"ShelveLoc_Good","orientation":"h","showlegend":true,"textposition":"auto","x":[4.8561025463957845],"xaxis":"x","y":["ShelveLoc_Good"],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","hovertemplate":"X=%{y}\u003cbr\u003ecoef=%{x}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"ShelveLoc_Medium","marker":{"color":"#EF553B","pattern":{"shape":""}},"name":"ShelveLoc_Medium","offsetgroup":"ShelveLoc_Medium","orientation":"h","showlegend":true,"textposition":"auto","x":[2.02857909397667],"xaxis":"x","y":["ShelveLoc_Medium"],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","hovertemplate":"X=%{y}\u003cbr\u003ecoef=%{x}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"Urban_Yes","marker":{"color":"#00cc96","pattern":{"shape":""}},"name":"Urban_Yes","offsetgroup":"Urban_Yes","orientation":"h","showlegend":true,"textposition":"auto","x":[0.17829308034821667],"xaxis":"x","y":["Urban_Yes"],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","hovertemplate":"X=%{y}\u003cbr\u003ecoef=%{x}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"Advertising","marker":{"color":"#ab63fa","pattern":{"shape":""}},"name":"Advertising","offsetgroup":"Advertising","orientation":"h","showlegend":true,"textposition":"auto","x":[0.12953154786492782],"xaxis":"x","y":["Advertising"],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","hovertemplate":"X=%{y}\u003cbr\u003ecoef=%{x}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"Education_15","marker":{"color":"#FFA15A","pattern":{"shape":""}},"name":"Education_15","offsetgroup":"Education_15","orientation":"h","showlegend":true,"textposition":"auto","x":[0.12259417086221071],"xaxis":"x","y":["Education_15"],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","hovertemplate":"X=%{y}\u003cbr\u003ecoef=%{x}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"CompPrice","marker":{"color":"#19d3f3","pattern":{"shape":""}},"name":"CompPrice","offsetgroup":"CompPrice","orientation":"h","showlegend":true,"textposition":"auto","x":[0.09422335454873186],"xaxis":"x","y":["CompPrice"],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","hovertemplate":"X=%{y}\u003cbr\u003ecoef=%{x}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"Income","marker":{"color":"#FF6692","pattern":{"shape":""}},"name":"Income","offsetgroup":"Income","orientation":"h","showlegend":true,"textposition":"auto","x":[0.013835428993130484],"xaxis":"x","y":["Income"],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","hovertemplate":"X=%{y}\u003cbr\u003ecoef=%{x}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"Population","marker":{"color":"#B6E880","pattern":{"shape":""}},"name":"Population","offsetgroup":"Population","orientation":"h","showlegend":true,"textposition":"auto","x":[-0.0005236245440930146],"xaxis":"x","y":["Population"],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","hovertemplate":"X=%{y}\u003cbr\u003ecoef=%{x}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"Age","marker":{"color":"#FF97FF","pattern":{"shape":""}},"name":"Age","offsetgroup":"Age","orientation":"h","showlegend":true,"textposition":"auto","x":[-0.05148786433506783],"xaxis":"x","y":["Age"],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","hovertemplate":"X=%{y}\u003cbr\u003ecoef=%{x}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"Price","marker":{"color":"#FECB52","pattern":{"shape":""}},"name":"Price","offsetgroup":"Price","orientation":"h","showlegend":true,"textposition":"auto","x":[-0.09671763935671276],"xaxis":"x","y":["Price"],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","hovertemplate":"X=%{y}\u003cbr\u003ecoef=%{x}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"Education_14","marker":{"color":"#636efa","pattern":{"shape":""}},"name":"Education_14","offsetgroup":"Education_14","orientation":"h","showlegend":true,"textposition":"auto","x":[-0.12991285820016601],"xaxis":"x","y":["Education_14"],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","hovertemplate":"X=%{y}\u003cbr\u003ecoef=%{x}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"Education_13","marker":{"color":"#EF553B","pattern":{"shape":""}},"name":"Education_13","offsetgroup":"Education_13","orientation":"h","showlegend":true,"textposition":"auto","x":[-0.2150068643643919],"xaxis":"x","y":["Education_13"],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","hovertemplate":"X=%{y}\u003cbr\u003ecoef=%{x}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"Education_12","marker":{"color":"#00cc96","pattern":{"shape":""}},"name":"Education_12","offsetgroup":"Education_12","orientation":"h","showlegend":true,"textposition":"auto","x":[-0.22441437567854702],"xaxis":"x","y":["Education_12"],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","hovertemplate":"X=%{y}\u003cbr\u003ecoef=%{x}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"US_Yes","marker":{"color":"#ab63fa","pattern":{"shape":""}},"name":"US_Yes","offsetgroup":"US_Yes","orientation":"h","showlegend":true,"textposition":"auto","x":[-0.24113911482945294],"xaxis":"x","y":["US_Yes"],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","hovertemplate":"X=%{y}\u003cbr\u003ecoef=%{x}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"Education_11","marker":{"color":"#FFA15A","pattern":{"shape":""}},"name":"Education_11","offsetgroup":"Education_11","orientation":"h","showlegend":true,"textposition":"auto","x":[-0.2759402702261809],"xaxis":"x","y":["Education_11"],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","hovertemplate":"X=%{y}\u003cbr\u003ecoef=%{x}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"Education_17","marker":{"color":"#19d3f3","pattern":{"shape":""}},"name":"Education_17","offsetgroup":"Education_17","orientation":"h","showlegend":true,"textposition":"auto","x":[-0.3345112183341193],"xaxis":"x","y":["Education_17"],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","hovertemplate":"X=%{y}\u003cbr\u003ecoef=%{x}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"Education_16","marker":{"color":"#FF6692","pattern":{"shape":""}},"name":"Education_16","offsetgroup":"Education_16","orientation":"h","showlegend":true,"textposition":"auto","x":[-0.36763844604615686],"xaxis":"x","y":["Education_16"],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","hovertemplate":"X=%{y}\u003cbr\u003ecoef=%{x}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"Education_18","marker":{"color":"#B6E880","pattern":{"shape":""}},"name":"Education_18","offsetgroup":"Education_18","orientation":"h","showlegend":true,"textposition":"auto","x":[-0.3844117440544679],"xaxis":"x","y":["Education_18"],"yaxis":"y","type":"bar"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"coef"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"X"},"categoryorder":"array","categoryarray":["Education_18","Education_16","Education_17","Education_11","US_Yes","Education_12","Education_13","Education_14","Price","Age","Population","Income","CompPrice","Education_15","Advertising","Urban_Yes","ShelveLoc_Medium","ShelveLoc_Good"]},"legend":{"title":{"text":"X"},"tracegroupgap":0},"margin":{"t":60},"barmode":"relative","height":450,"width":700,"showlegend":false},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('a724d846-08c8-48be-b40a-7448152615ab');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
</section>
<section id="시각화-2-잔차-시각화" class="level3">
<h3 class="anchored" data-anchor-id="시각화-2-잔차-시각화">(4) 시각화 2 : 잔차 시각화</h3>
<p><code>-</code> 잔차를 살펴보니 잔차의 평균으로부터 분포가 일정하다. (회귀선이 안정적으로 추정된 것 같다!)</p>
<div class="cell" data-execution_count="23">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1"></a>e <span class="op">=</span> y_test <span class="op">-</span> y_pred</span>
<span id="cb32-2"><a href="#cb32-2"></a>e_m <span class="op">=</span> e.mean()</span>
<span id="cb32-3"><a href="#cb32-3"></a></span>
<span id="cb32-4"><a href="#cb32-4"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">5</span>,<span class="dv">4</span>))</span>
<span id="cb32-5"><a href="#cb32-5"></a>plt.plot(e,<span class="st">'.'</span>,label <span class="op">=</span> <span class="vs">r"$\varepsilon$"</span>)</span>
<span id="cb32-6"><a href="#cb32-6"></a>plt.axhline(e_m, linestyle <span class="op">=</span> <span class="st">"--"</span>, color <span class="op">=</span> <span class="st">"red"</span>, label <span class="op">=</span> <span class="vs">r"$E(\varepsilon)$"</span>)</span>
<span id="cb32-7"><a href="#cb32-7"></a>plt.title(<span class="vs">r"$\varepsilon \sim  N(0, \sigma^2)$"</span>)</span>
<span id="cb32-8"><a href="#cb32-8"></a>plt.legend()</span>
<span id="cb32-9"><a href="#cb32-9"></a>plt.ylim(<span class="op">-</span><span class="dv">5</span>,<span class="dv">5</span>)</span>
<span id="cb32-10"><a href="#cb32-10"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="2023-09-13-02. 머신러닝 (2)_files/figure-html/cell-24-output-1.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="시각화-3-y-hat-y" class="level3">
<h3 class="anchored" data-anchor-id="시각화-3-y-hat-y">(4) 시각화 3 : <span class="math inline">\((y, \hat y)\)</span></h3>
<div class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1"></a>plt.plot(y_test.reset_index(drop<span class="op">=</span><span class="va">True</span>), <span class="st">"--r"</span>, label <span class="op">=</span> <span class="vs">r"$y$"</span>,alpha <span class="op">=</span> <span class="fl">0.3</span>)</span>
<span id="cb33-2"><a href="#cb33-2"></a>plt.plot(y_pred, <span class="st">"b"</span>, label <span class="op">=</span> <span class="vs">r"$\hat </span><span class="sc">{y}</span><span class="vs">$"</span>,alpha<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb33-3"><a href="#cb33-3"></a>plt.legend()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="24">
<pre><code>&lt;matplotlib.legend.Legend at 0x1c94e3cf890&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="2023-09-13-02. 머신러닝 (2)_files/figure-html/cell-25-output-2.png" class="img-fluid"></p>
</div>
</div>
</section>
</section>
</section>
<section id="knn" class="level1">
<h1>2. KNN</h1>
<p><code>-</code> 학습을 안함 <span class="math inline">\(\to\)</span> 걍 옆에 있는 애들을 평균내서 값을 구해주기 때문</p>
<ul>
<li><p>예측할 떄만 옆에 있는 녀석들과의 거리를 구해서 값을 계산함. <span class="math inline">\(\to\)</span> <span class="math inline">\(\hat {y}\)</span>가 범주일 때는 예측시 투표방식, 연속형일 때는 주변을 평균내서 구함</p></li>
<li><p>그래서 KNN은 <span class="math inline">\(k\)</span>가 커질수록 모델이 단순해짐.</p></li>
</ul>
<p><code>-</code> 주변 관측치 <span class="math inline">\(k\)</span> 를 홀수로 설정 <span class="math inline">\(\to\)</span> 짝수로 설정시 과반수 이상의 투표가 나오지 않을 수 있음.</p>
<p><code>-</code> KNN은 스케일링 여부에 따라 모델 성능이 달라질 수 있다. <span class="math inline">\(\to\)</span> <span class="math inline">\((1 \leq x \leq 2), (4000 \leq y \leq 10000)\)</span></p>
<ul>
<li><p>위의 경우 시각화로 표현 시 <span class="math inline">\(y\)</span>값에 범위와 <span class="math inline">\(x\)</span>값의 범위가 차이가 심하기 때문에 잘못된 분류를 할 가능성이 높다.</p></li>
<li><p>위 같은 문제점을 해결하기 위해 <code>scaling</code>이 필요하다. (근데 만약 안했을 때 성능이 좋다면 안해도 된다, 그때그때 다름)</p></li>
</ul>
<p><code>-</code> 정규화 (Normalization)</p>
<p><span class="math display">\[X_{norm} = \frac {x-x_{min}}{x_{max} - x_{min}},\quad (1  \leq X_{norm} \leq 1)\]</span></p>
<p><code>-</code> 표준화 (standardization)</p>
<p><span class="math display">\[X_{z} = \frac {x-x_{mean}}{x_{std}},\,\quad X_{std} \sim N(0, 1)\]</span></p>
<section id="데이터-로드-및-탐색-1" class="level2">
<h2 class="anchored" data-anchor-id="데이터-로드-및-탐색-1">(1) 데이터 로드 및 탐색</h2>
<div class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1"></a><span class="co"># 데이터 읽어오기</span></span>
<span id="cb35-2"><a href="#cb35-2"></a>path <span class="op">=</span> <span class="st">'https://raw.githubusercontent.com/Jangrae/csv/master/airquality_simple.csv'</span></span>
<span id="cb35-3"><a href="#cb35-3"></a>data <span class="op">=</span> pd.read_csv(path)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1"></a>data.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="26">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Ozone</th>
<th data-quarto-table-cell-role="th">Solar.R</th>
<th data-quarto-table-cell-role="th">Wind</th>
<th data-quarto-table-cell-role="th">Temp</th>
<th data-quarto-table-cell-role="th">Month</th>
<th data-quarto-table-cell-role="th">Day</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>41</td>
<td>190.0</td>
<td>7.4</td>
<td>67</td>
<td>5</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>36</td>
<td>118.0</td>
<td>8.0</td>
<td>72</td>
<td>5</td>
<td>2</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>12</td>
<td>149.0</td>
<td>12.6</td>
<td>74</td>
<td>5</td>
<td>3</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>18</td>
<td>313.0</td>
<td>11.5</td>
<td>62</td>
<td>5</td>
<td>4</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>19</td>
<td>NaN</td>
<td>14.3</td>
<td>56</td>
<td>5</td>
<td>5</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1"></a>data.info()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 153 entries, 0 to 152
Data columns (total 6 columns):
 #   Column   Non-Null Count  Dtype  
---  ------   --------------  -----  
 0   Ozone    153 non-null    int64  
 1   Solar.R  146 non-null    float64
 2   Wind     153 non-null    float64
 3   Temp     153 non-null    int64  
 4   Month    153 non-null    int64  
 5   Day      153 non-null    int64  
dtypes: float64(2), int64(4)
memory usage: 7.3 KB</code></pre>
</div>
</div>
<div class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1"></a>data.isna().<span class="bu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="28">
<pre><code>Ozone      0
Solar.R    7
Wind       0
Temp       0
Month      0
Day        0
dtype: int64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1"></a>data.corr()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="29">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Ozone</th>
<th data-quarto-table-cell-role="th">Solar.R</th>
<th data-quarto-table-cell-role="th">Wind</th>
<th data-quarto-table-cell-role="th">Temp</th>
<th data-quarto-table-cell-role="th">Month</th>
<th data-quarto-table-cell-role="th">Day</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">Ozone</td>
<td>1.000000</td>
<td>0.280068</td>
<td>-0.605478</td>
<td>0.683372</td>
<td>0.174197</td>
<td>0.004419</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Solar.R</td>
<td>0.280068</td>
<td>1.000000</td>
<td>-0.056792</td>
<td>0.275840</td>
<td>-0.075301</td>
<td>-0.150275</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Wind</td>
<td>-0.605478</td>
<td>-0.056792</td>
<td>1.000000</td>
<td>-0.457988</td>
<td>-0.178293</td>
<td>0.027181</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Temp</td>
<td>0.683372</td>
<td>0.275840</td>
<td>-0.457988</td>
<td>1.000000</td>
<td>0.420947</td>
<td>-0.130593</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Month</td>
<td>0.174197</td>
<td>-0.075301</td>
<td>-0.178293</td>
<td>0.420947</td>
<td>1.000000</td>
<td>-0.007962</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Day</td>
<td>0.004419</td>
<td>-0.150275</td>
<td>0.027181</td>
<td>-0.130593</td>
<td>-0.007962</td>
<td>1.000000</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="결측치-처리" class="level2">
<h2 class="anchored" data-anchor-id="결측치-처리">(2) 결측치 처리</h2>
<p><code>-</code> 시계열 데이터이므로 선형보간법으로 채움</p>
<div class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1"></a>data[<span class="st">"Solar.R"</span>].interpolate(method <span class="op">=</span> <span class="st">"linear"</span>, inplace <span class="op">=</span> <span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1"></a>data.isna().<span class="bu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="31">
<pre><code>Ozone      0
Solar.R    0
Wind       0
Temp       0
Month      0
Day        0
dtype: int64</code></pre>
</div>
</div>
</section>
<section id="변수-제거" class="level2">
<h2 class="anchored" data-anchor-id="변수-제거">(3) 변수 제거</h2>
<div class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1"></a><span class="co">#  변수 제거</span></span>
<span id="cb45-2"><a href="#cb45-2"></a>drop_cols <span class="op">=</span> [<span class="st">'Month'</span>, <span class="st">'Day'</span>]</span>
<span id="cb45-3"><a href="#cb45-3"></a>data.drop(drop_cols, axis<span class="op">=</span><span class="dv">1</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb45-4"><a href="#cb45-4"></a></span>
<span id="cb45-5"><a href="#cb45-5"></a><span class="co"># 확인</span></span>
<span id="cb45-6"><a href="#cb45-6"></a>data.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="32">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Ozone</th>
<th data-quarto-table-cell-role="th">Solar.R</th>
<th data-quarto-table-cell-role="th">Wind</th>
<th data-quarto-table-cell-role="th">Temp</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>41</td>
<td>190.000000</td>
<td>7.4</td>
<td>67</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>36</td>
<td>118.000000</td>
<td>8.0</td>
<td>72</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>12</td>
<td>149.000000</td>
<td>12.6</td>
<td>74</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>18</td>
<td>313.000000</td>
<td>11.5</td>
<td>62</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>19</td>
<td>308.333333</td>
<td>14.3</td>
<td>56</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="모델링-3" class="level2">
<h2 class="anchored" data-anchor-id="모델링-3">(4) 모델링</h2>
<div class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1"></a><span class="co"># target 확인</span></span>
<span id="cb46-2"><a href="#cb46-2"></a>target <span class="op">=</span> <span class="st">'Ozone'</span></span>
<span id="cb46-3"><a href="#cb46-3"></a></span>
<span id="cb46-4"><a href="#cb46-4"></a><span class="co"># 데이터 분리</span></span>
<span id="cb46-5"><a href="#cb46-5"></a>x <span class="op">=</span> data.drop(target, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb46-6"><a href="#cb46-6"></a>y <span class="op">=</span> data.loc[:, target]</span>
<span id="cb46-7"><a href="#cb46-7"></a></span>
<span id="cb46-8"><a href="#cb46-8"></a><span class="co"># 모듈 불러오기</span></span>
<span id="cb46-9"><a href="#cb46-9"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb46-10"><a href="#cb46-10"></a></span>
<span id="cb46-11"><a href="#cb46-11"></a><span class="co"># 데이터 분리</span></span>
<span id="cb46-12"><a href="#cb46-12"></a>x_train, x_test, y_train, y_test <span class="op">=</span> train_test_split(x, y, test_size<span class="op">=</span><span class="fl">0.3</span>, random_state<span class="op">=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><code>-</code> 스케일링</p>
<div class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1"></a><span class="co"># 1.  손계산</span></span>
<span id="cb47-2"><a href="#cb47-2"></a>x_train <span class="op">=</span> x_train.<span class="bu">apply</span>(<span class="kw">lambda</span> x : </span>
<span id="cb47-3"><a href="#cb47-3"></a>                                            (x<span class="op">-</span><span class="bu">min</span>(x))<span class="op">/</span>(<span class="bu">max</span>(x)<span class="op">-</span><span class="bu">min</span>(x)),axis<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb47-4"><a href="#cb47-4"></a></span>
<span id="cb47-5"><a href="#cb47-5"></a>x_test <span class="op">=</span> x_test.<span class="bu">apply</span>(<span class="kw">lambda</span> x : </span>
<span id="cb47-6"><a href="#cb47-6"></a>                                            (x<span class="op">-</span><span class="bu">min</span>(x))<span class="op">/</span>(<span class="bu">max</span>(x)<span class="op">-</span><span class="bu">min</span>(x)),axis<span class="op">=</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceCode" id="cb48"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1"></a><span class="co"># 2. 모듈 이용</span></span>
<span id="cb48-2"><a href="#cb48-2"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> MinMaxScaler</span>
<span id="cb48-3"><a href="#cb48-3"></a>scaler <span class="op">=</span> MinMaxScaler()</span>
<span id="cb48-4"><a href="#cb48-4"></a></span>
<span id="cb48-5"><a href="#cb48-5"></a>x_train <span class="op">=</span> scaler.fit_transform(x_train)</span>
<span id="cb48-6"><a href="#cb48-6"></a>x_test <span class="op">=</span> scaler.transform(x_test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><code>-</code> 모델링 수행</p>
<div class="cell" data-execution_count="35">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1"></a><span class="im">from</span> sklearn.neighbors <span class="im">import</span> KNeighborsRegressor</span>
<span id="cb49-2"><a href="#cb49-2"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> mean_absolute_error, r2_score</span>
<span id="cb49-3"><a href="#cb49-3"></a></span>
<span id="cb49-4"><a href="#cb49-4"></a>model <span class="op">=</span> KNeighborsRegressor()</span>
<span id="cb49-5"><a href="#cb49-5"></a></span>
<span id="cb49-6"><a href="#cb49-6"></a>model.fit(x_train, y_train)</span>
<span id="cb49-7"><a href="#cb49-7"></a></span>
<span id="cb49-8"><a href="#cb49-8"></a>y_pred <span class="op">=</span> model.predict(x_test)</span>
<span id="cb49-9"><a href="#cb49-9"></a></span>
<span id="cb49-10"><a href="#cb49-10"></a><span class="bu">print</span>(<span class="ss">f"MAE : </span><span class="sc">{</span>mean_absolute_error(y_test, y_pred )<span class="sc">: .2f}</span><span class="ss">, R2 = </span><span class="sc">{</span>r2_score(y_test, y_pred)<span class="sc">: .2f}</span><span class="ss"> "</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>MAE :  13.68, R2 =  0.57 </code></pre>
</div>
</div>
</section>
<section id="결과-시각화" class="level2">
<h2 class="anchored" data-anchor-id="결과-시각화">(5) 결과 시각화</h2>
<div class="cell" data-execution_count="36">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1"></a>plt.figure(figsize <span class="op">=</span> (<span class="dv">5</span>,<span class="dv">4</span>))</span>
<span id="cb51-2"><a href="#cb51-2"></a>plt.plot(y_test.reset_index(drop<span class="op">=</span><span class="va">True</span>),<span class="st">"--r"</span>,label <span class="op">=</span> <span class="vs">r"$y$"</span>,alpha <span class="op">=</span> <span class="fl">.3</span>)</span>
<span id="cb51-3"><a href="#cb51-3"></a>plt.plot(y_pred,<span class="st">"--b"</span>,label <span class="op">=</span> <span class="vs">r"$\hat y$"</span>)</span>
<span id="cb51-4"><a href="#cb51-4"></a>plt.legend()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="36">
<pre><code>&lt;matplotlib.legend.Legend at 0x1c94e3cfb90&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="2023-09-13-02. 머신러닝 (2)_files/figure-html/cell-37-output-2.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="exercise.-1" class="level2">
<h2 class="anchored" data-anchor-id="exercise.-1">exercise. 1</h2>
<section id="데이터-탐색-및-전처리-1" class="level3">
<h3 class="anchored" data-anchor-id="데이터-탐색-및-전처리-1">(1) 데이터 탐색 및 전처리</h3>
<p><strong>데이터설명</strong></p>
<p>피마 인디언 당뇨 데이터셋은 몇 명의 여성 피마 인디언의 진료 자료와 진단 후 5년 내 당뇨 발병 여부로 구성됨</p>
<ul>
<li>Pregnancies: 임신 횟수</li>
<li>Glucose: 포도당 부하 검사 수치</li>
<li>BloodPressure: 혈압(mm Hg)</li>
<li>SkinThickness: 팔 삼두근 뒤쪽의 피하지방 측정값(mm)</li>
<li>Insulin: 혈청 인슐린(mu U/ml)</li>
<li>BMI: 체질량지수(체중(kg)/키(m))^2</li>
<li>DiabetesPedigreeFunction: 당뇨 내력 가중치 값</li>
<li>Age: 나이</li>
<li>Outcome: 클래스 결정 값(0 또는 1)</li>
</ul>
<p><strong>diabetes</strong></p>
<ul>
<li>당뇨병(糖尿病, diabetes)은 높은 혈당 수치가 오랜 기간 지속되는 대사 질환이다.</li>
<li>혈당이 높을 때의 증상으로는 소변이 잦아지고, 갈증과 배고픔이 심해진다.</li>
<li>이를 치료하지 않으면 다른 합병증을 유발할 수 있다. (출처: 위키백과)</li>
</ul>
<div class="cell" data-execution_count="37">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1"></a>path <span class="op">=</span> <span class="st">'https://raw.githubusercontent.com/jangrae/csv/master/diabetes.csv'</span></span>
<span id="cb53-2"><a href="#cb53-2"></a>data <span class="op">=</span> pd.read_csv(path)</span>
<span id="cb53-3"><a href="#cb53-3"></a>data.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="37">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Pregnancies</th>
<th data-quarto-table-cell-role="th">Glucose</th>
<th data-quarto-table-cell-role="th">BloodPressure</th>
<th data-quarto-table-cell-role="th">SkinThickness</th>
<th data-quarto-table-cell-role="th">Insulin</th>
<th data-quarto-table-cell-role="th">BMI</th>
<th data-quarto-table-cell-role="th">DiabetesPedigreeFunction</th>
<th data-quarto-table-cell-role="th">Age</th>
<th data-quarto-table-cell-role="th">Outcome</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>6</td>
<td>148</td>
<td>72</td>
<td>35</td>
<td>0</td>
<td>33.6</td>
<td>0.627</td>
<td>50</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>1</td>
<td>85</td>
<td>66</td>
<td>29</td>
<td>0</td>
<td>26.6</td>
<td>0.351</td>
<td>31</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>8</td>
<td>183</td>
<td>64</td>
<td>0</td>
<td>0</td>
<td>23.3</td>
<td>0.672</td>
<td>32</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>1</td>
<td>89</td>
<td>66</td>
<td>23</td>
<td>94</td>
<td>28.1</td>
<td>0.167</td>
<td>21</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>0</td>
<td>137</td>
<td>40</td>
<td>35</td>
<td>168</td>
<td>43.1</td>
<td>2.288</td>
<td>33</td>
<td>1</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell" data-execution_count="38">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1"></a>data.info()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 768 entries, 0 to 767
Data columns (total 9 columns):
 #   Column                    Non-Null Count  Dtype  
---  ------                    --------------  -----  
 0   Pregnancies               768 non-null    int64  
 1   Glucose                   768 non-null    int64  
 2   BloodPressure             768 non-null    int64  
 3   SkinThickness             768 non-null    int64  
 4   Insulin                   768 non-null    int64  
 5   BMI                       768 non-null    float64
 6   DiabetesPedigreeFunction  768 non-null    float64
 7   Age                       768 non-null    int64  
 8   Outcome                   768 non-null    int64  
dtypes: float64(2), int64(7)
memory usage: 54.1 KB</code></pre>
</div>
</div>
<div class="cell" data-execution_count="39">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1"></a>data.isna().<span class="bu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="39">
<pre><code>Pregnancies                 0
Glucose                     0
BloodPressure               0
SkinThickness               0
Insulin                     0
BMI                         0
DiabetesPedigreeFunction    0
Age                         0
Outcome                     0
dtype: int64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="40">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1"></a>data.Outcome.value_counts()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="40">
<pre><code>Outcome
0    500
1    268
Name: count, dtype: int64</code></pre>
</div>
</div>
</section>
<section id="모델링-4" class="level3">
<h3 class="anchored" data-anchor-id="모델링-4">(2) 모델링</h3>
<div class="cell" data-execution_count="41">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1"></a><span class="co"># step 1. 데이터 분리</span></span>
<span id="cb60-2"><a href="#cb60-2"></a>target <span class="op">=</span> <span class="st">"Outcome"</span></span>
<span id="cb60-3"><a href="#cb60-3"></a></span>
<span id="cb60-4"><a href="#cb60-4"></a>x <span class="op">=</span> data.drop(target, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb60-5"><a href="#cb60-5"></a>y <span class="op">=</span> data[target]</span>
<span id="cb60-6"><a href="#cb60-6"></a></span>
<span id="cb60-7"><a href="#cb60-7"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb60-8"><a href="#cb60-8"></a></span>
<span id="cb60-9"><a href="#cb60-9"></a>x_train, x_test, y_train, y_test <span class="op">=</span> train_test_split(x, y, random_state <span class="op">=</span> <span class="dv">1</span>, test_size <span class="op">=</span> <span class="fl">0.3</span>)</span>
<span id="cb60-10"><a href="#cb60-10"></a></span>
<span id="cb60-11"><a href="#cb60-11"></a><span class="co"># step 2.  정규화</span></span>
<span id="cb60-12"><a href="#cb60-12"></a></span>
<span id="cb60-13"><a href="#cb60-13"></a>scale <span class="op">=</span> <span class="kw">lambda</span>  x : (x<span class="op">-</span><span class="bu">min</span>(x)) <span class="op">/</span>(<span class="bu">max</span>(x)<span class="op">-</span><span class="bu">min</span>(x))</span>
<span id="cb60-14"><a href="#cb60-14"></a></span>
<span id="cb60-15"><a href="#cb60-15"></a>x_train <span class="op">=</span> x_train.<span class="bu">apply</span>(scale, axis<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb60-16"><a href="#cb60-16"></a>x_test <span class="op">=</span> x_test.<span class="bu">apply</span>(scale, axis<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb60-17"><a href="#cb60-17"></a></span>
<span id="cb60-18"><a href="#cb60-18"></a><span class="co"># step 3. 모델 호출 및 예측</span></span>
<span id="cb60-19"><a href="#cb60-19"></a><span class="im">from</span> sklearn.neighbors <span class="im">import</span> KNeighborsClassifier</span>
<span id="cb60-20"><a href="#cb60-20"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span>  accuracy_score, precision_score, recall_score, f1_score</span>
<span id="cb60-21"><a href="#cb60-21"></a></span>
<span id="cb60-22"><a href="#cb60-22"></a>model <span class="op">=</span> KNeighborsClassifier()</span>
<span id="cb60-23"><a href="#cb60-23"></a>model.fit(x_train, y_train)</span>
<span id="cb60-24"><a href="#cb60-24"></a></span>
<span id="cb60-25"><a href="#cb60-25"></a>y_pred <span class="op">=</span> model.predict(x_test)</span>
<span id="cb60-26"><a href="#cb60-26"></a></span>
<span id="cb60-27"><a href="#cb60-27"></a><span class="bu">print</span>(<span class="ss">f"accuracy : </span><span class="sc">{</span>accuracy_score(y_pred, y_test) <span class="sc">: .3}</span><span class="ss">"</span>)</span>
<span id="cb60-28"><a href="#cb60-28"></a><span class="bu">print</span>(<span class="ss">f"precision : </span><span class="sc">{</span>precision_score(y_pred, y_test) <span class="sc">: .3}</span><span class="ss">"</span>)</span>
<span id="cb60-29"><a href="#cb60-29"></a><span class="bu">print</span>(<span class="ss">f"recall : </span><span class="sc">{</span>recall_score(y_pred, y_test) <span class="sc">: .3}</span><span class="ss">"</span>)</span>
<span id="cb60-30"><a href="#cb60-30"></a><span class="bu">print</span>(<span class="ss">f"F1-score : </span><span class="sc">{</span>f1_score(y_pred, y_test) <span class="sc">: .3}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>accuracy :  0.779
precision :  0.506
recall :  0.827
F1-score :  0.628</code></pre>
</div>
</div>
</section>
<section id="결과-시각화-1-y-hat-y-클래스-비교" class="level3">
<h3 class="anchored" data-anchor-id="결과-시각화-1-y-hat-y-클래스-비교">(3) 결과 시각화 1 : <span class="math inline">\((y, \hat y)\)</span> 클래스 비교</h3>
<div class="cell" data-execution_count="42">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1"></a>pd.DataFrame({<span class="st">"y_test"</span> : y_test.astype(<span class="bu">str</span>),</span>
<span id="cb62-2"><a href="#cb62-2"></a>                             <span class="st">"y_pred"</span> : y_pred.astype(<span class="bu">str</span>)}).<span class="op">\</span></span>
<span id="cb62-3"><a href="#cb62-3"></a>                                    melt(var_name <span class="op">=</span> <span class="st">"label"</span>, </span>
<span id="cb62-4"><a href="#cb62-4"></a>                                     value_name<span class="op">=</span> <span class="st">"Outcome"</span>).<span class="op">\</span></span>
<span id="cb62-5"><a href="#cb62-5"></a>                                     groupby(<span class="st">"label"</span>,as_index<span class="op">=</span><span class="va">False</span>)[[<span class="st">"Outcome"</span>]].value_counts().<span class="op">\</span></span>
<span id="cb62-6"><a href="#cb62-6"></a>                                            plot(x <span class="op">=</span> <span class="st">"label"</span>,y <span class="op">=</span> <span class="st">"count"</span>, </span>
<span id="cb62-7"><a href="#cb62-7"></a>                                                    kind <span class="op">=</span><span class="st">"bar"</span>, backend <span class="op">=</span> <span class="st">"plotly"</span>,</span>
<span id="cb62-8"><a href="#cb62-8"></a>                                                     color <span class="op">=</span> <span class="st">"label"</span>, facet_col <span class="op">=</span> <span class="st">"Outcome"</span>,width <span class="op">=</span> <span class="dv">500</span>, height <span class="op">=</span> <span class="dv">400</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<div>                            <div id="fc810f9a-b250-43d1-87ce-a6d667277bb6" class="plotly-graph-div" style="height:400px; width:500px;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("fc810f9a-b250-43d1-87ce-a6d667277bb6")) {                    Plotly.newPlot(                        "fc810f9a-b250-43d1-87ce-a6d667277bb6",                        [{"alignmentgroup":"True","hovertemplate":"label=%{x}\u003cbr\u003eOutcome=0\u003cbr\u003ecount=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"y_pred","marker":{"color":"#636efa","pattern":{"shape":""}},"name":"y_pred","offsetgroup":"y_pred","orientation":"v","showlegend":true,"textposition":"auto","x":["y_pred"],"xaxis":"x","y":[179],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","hovertemplate":"label=%{x}\u003cbr\u003eOutcome=1\u003cbr\u003ecount=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"y_pred","marker":{"color":"#636efa","pattern":{"shape":""}},"name":"y_pred","offsetgroup":"y_pred","orientation":"v","showlegend":false,"textposition":"auto","x":["y_pred"],"xaxis":"x2","y":[52],"yaxis":"y2","type":"bar"},{"alignmentgroup":"True","hovertemplate":"label=%{x}\u003cbr\u003eOutcome=0\u003cbr\u003ecount=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"y_test","marker":{"color":"#EF553B","pattern":{"shape":""}},"name":"y_test","offsetgroup":"y_test","orientation":"v","showlegend":true,"textposition":"auto","x":["y_test"],"xaxis":"x","y":[146],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","hovertemplate":"label=%{x}\u003cbr\u003eOutcome=1\u003cbr\u003ecount=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"y_test","marker":{"color":"#EF553B","pattern":{"shape":""}},"name":"y_test","offsetgroup":"y_test","orientation":"v","showlegend":false,"textposition":"auto","x":["y_test"],"xaxis":"x2","y":[85],"yaxis":"y2","type":"bar"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"xaxis":{"anchor":"y","domain":[0.0,0.49],"title":{"text":"label"},"categoryorder":"array","categoryarray":["y_pred","y_test"]},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"count"}},"xaxis2":{"anchor":"y2","domain":[0.51,1.0],"matches":"x","title":{"text":"label"},"categoryorder":"array","categoryarray":["y_pred","y_test"]},"yaxis2":{"anchor":"x2","domain":[0.0,1.0],"matches":"y","showticklabels":false},"annotations":[{"font":{},"showarrow":false,"text":"Outcome=0","x":0.245,"xanchor":"center","xref":"paper","y":1.0,"yanchor":"bottom","yref":"paper"},{"font":{},"showarrow":false,"text":"Outcome=1","x":0.755,"xanchor":"center","xref":"paper","y":1.0,"yanchor":"bottom","yref":"paper"}],"legend":{"title":{"text":"label"},"tracegroupgap":0},"margin":{"t":60},"barmode":"relative","height":400,"width":500},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('fc810f9a-b250-43d1-87ce-a6d667277bb6');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
</section>
<section id="결과-시각화-2-평가지표" class="level3">
<h3 class="anchored" data-anchor-id="결과-시각화-2-평가지표">(4) 결과 시각화 2 : 평가지표</h3>
<div class="cell" data-execution_count="43">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1"></a>acc <span class="op">=</span> accuracy_score(y_pred, y_test)</span>
<span id="cb63-2"><a href="#cb63-2"></a>pre <span class="op">=</span> precision_score(y_pred, y_test)</span>
<span id="cb63-3"><a href="#cb63-3"></a>recall <span class="op">=</span> recall_score(y_pred, y_test)</span>
<span id="cb63-4"><a href="#cb63-4"></a>f1 <span class="op">=</span> f1_score(y_pred, y_test)</span>
<span id="cb63-5"><a href="#cb63-5"></a></span>
<span id="cb63-6"><a href="#cb63-6"></a>result <span class="op">=</span> [acc, pre, recall, f1]</span>
<span id="cb63-7"><a href="#cb63-7"></a>col <span class="op">=</span> [<span class="st">"accuracy"</span>, <span class="st">"precision"</span>, <span class="st">"recall"</span>, <span class="st">"F1-score"</span>]</span>
<span id="cb63-8"><a href="#cb63-8"></a></span>
<span id="cb63-9"><a href="#cb63-9"></a>pd.DataFrame(result,columns<span class="op">=</span>[<span class="st">"value"</span>],index<span class="op">=</span>col).reset_index().<span class="op">\</span></span>
<span id="cb63-10"><a href="#cb63-10"></a>                plot(x<span class="op">=</span><span class="st">"index"</span>, y<span class="op">=</span> <span class="st">"value"</span>,kind<span class="op">=</span><span class="st">"bar"</span>,color<span class="op">=</span> <span class="st">"index"</span>, backend <span class="op">=</span> <span class="st">"plotly"</span>,</span>
<span id="cb63-11"><a href="#cb63-11"></a>                        height <span class="op">=</span> <span class="dv">400</span>, width <span class="op">=</span> <span class="dv">600</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<div>                            <div id="f7d5a422-dbde-4ceb-ad60-6347f46cbe85" class="plotly-graph-div" style="height:400px; width:600px;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("f7d5a422-dbde-4ceb-ad60-6347f46cbe85")) {                    Plotly.newPlot(                        "f7d5a422-dbde-4ceb-ad60-6347f46cbe85",                        [{"alignmentgroup":"True","hovertemplate":"index=%{x}\u003cbr\u003evalue=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"accuracy","marker":{"color":"#636efa","pattern":{"shape":""}},"name":"accuracy","offsetgroup":"accuracy","orientation":"v","showlegend":true,"textposition":"auto","x":["accuracy"],"xaxis":"x","y":[0.7792207792207793],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","hovertemplate":"index=%{x}\u003cbr\u003evalue=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"precision","marker":{"color":"#EF553B","pattern":{"shape":""}},"name":"precision","offsetgroup":"precision","orientation":"v","showlegend":true,"textposition":"auto","x":["precision"],"xaxis":"x","y":[0.5058823529411764],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","hovertemplate":"index=%{x}\u003cbr\u003evalue=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"recall","marker":{"color":"#00cc96","pattern":{"shape":""}},"name":"recall","offsetgroup":"recall","orientation":"v","showlegend":true,"textposition":"auto","x":["recall"],"xaxis":"x","y":[0.8269230769230769],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","hovertemplate":"index=%{x}\u003cbr\u003evalue=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"F1-score","marker":{"color":"#ab63fa","pattern":{"shape":""}},"name":"F1-score","offsetgroup":"F1-score","orientation":"v","showlegend":true,"textposition":"auto","x":["F1-score"],"xaxis":"x","y":[0.6277372262773723],"yaxis":"y","type":"bar"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"index"},"categoryorder":"array","categoryarray":["accuracy","precision","recall","F1-score"]},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"value"}},"legend":{"title":{"text":"index"},"tracegroupgap":0},"margin":{"t":60},"barmode":"relative","height":400,"width":600},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('f7d5a422-dbde-4ceb-ad60-6347f46cbe85');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
</section>
</section>
<section id="excercise.-2-불균형-클래스" class="level2">
<h2 class="anchored" data-anchor-id="excercise.-2-불균형-클래스">excercise. 2 (불균형 클래스)</h2>
<p><strong>데이터 설명</strong></p>
<ul>
<li>Attrition: 이직 여부 (1: 이직, 0: 잔류)</li>
<li>Age: 나이</li>
<li>DistanceFromHome: 집-직장 거리 (단위: 마일)</li>
<li>EmployeeNumber: 사번</li>
<li>Gender: 성별 (Male, Female)</li>
<li>JobSatisfaction: 직무 만족도(1: Low, 2: Medium, 3: High, 4: Very High)</li>
<li>MaritalStatus: 결혼 상태 (Single, Married, Divorced)</li>
<li>MonthlyIncome: 월급 (단위: 달러)</li>
<li>OverTime: 야근 여부 (Yes, No)</li>
<li>PercentSalaryHike: 전년 대비 급여 인상율(단위: %)</li>
<li>TotalWorkingYears: 총 경력 연수</li>
</ul>
<section id="데이터-로드-및-탐색-2" class="level3">
<h3 class="anchored" data-anchor-id="데이터-로드-및-탐색-2">(1) 데이터 로드 및 탐색</h3>
<div class="cell" data-execution_count="44">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1"></a><span class="co"># 데이터 읽어오기</span></span>
<span id="cb64-2"><a href="#cb64-2"></a>path <span class="op">=</span> <span class="st">'https://raw.githubusercontent.com/jangrae/csv/master/Attrition_simple2.csv'</span></span>
<span id="cb64-3"><a href="#cb64-3"></a>data <span class="op">=</span> pd.read_csv(path)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="45">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1"></a>data.info()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 1196 entries, 0 to 1195
Data columns (total 11 columns):
 #   Column             Non-Null Count  Dtype 
---  ------             --------------  ----- 
 0   Attrition          1196 non-null   int64 
 1   Age                1196 non-null   int64 
 2   DistanceFromHome   1196 non-null   int64 
 3   EmployeeNumber     1196 non-null   int64 
 4   Gender             1196 non-null   object
 5   JobSatisfaction    1196 non-null   int64 
 6   MaritalStatus      1196 non-null   object
 7   MonthlyIncome      1196 non-null   int64 
 8   OverTime           1196 non-null   object
 9   PercentSalaryHike  1196 non-null   int64 
 10  TotalWorkingYears  1196 non-null   int64 
dtypes: int64(8), object(3)
memory usage: 102.9+ KB</code></pre>
</div>
</div>
<div class="cell" data-execution_count="46">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb67-1"><a href="#cb67-1"></a>data.isna().<span class="bu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="46">
<pre><code>Attrition            0
Age                  0
DistanceFromHome     0
EmployeeNumber       0
Gender               0
JobSatisfaction      0
MaritalStatus        0
MonthlyIncome        0
OverTime             0
PercentSalaryHike    0
TotalWorkingYears    0
dtype: int64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="47">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb69-1"><a href="#cb69-1"></a>data.describe().T</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="47">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">count</th>
<th data-quarto-table-cell-role="th">mean</th>
<th data-quarto-table-cell-role="th">std</th>
<th data-quarto-table-cell-role="th">min</th>
<th data-quarto-table-cell-role="th">25%</th>
<th data-quarto-table-cell-role="th">50%</th>
<th data-quarto-table-cell-role="th">75%</th>
<th data-quarto-table-cell-role="th">max</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">Attrition</td>
<td>1196.0</td>
<td>0.163043</td>
<td>0.369560</td>
<td>0.0</td>
<td>0.00</td>
<td>0.0</td>
<td>0.00</td>
<td>1.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Age</td>
<td>1196.0</td>
<td>36.943980</td>
<td>9.092700</td>
<td>18.0</td>
<td>30.00</td>
<td>36.0</td>
<td>43.00</td>
<td>60.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">DistanceFromHome</td>
<td>1196.0</td>
<td>9.258361</td>
<td>8.166016</td>
<td>1.0</td>
<td>2.00</td>
<td>7.0</td>
<td>14.00</td>
<td>29.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">EmployeeNumber</td>
<td>1196.0</td>
<td>1035.629599</td>
<td>604.340130</td>
<td>1.0</td>
<td>507.75</td>
<td>1028.0</td>
<td>1581.25</td>
<td>2068.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">JobSatisfaction</td>
<td>1196.0</td>
<td>2.716555</td>
<td>1.110962</td>
<td>1.0</td>
<td>2.00</td>
<td>3.0</td>
<td>4.00</td>
<td>4.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">MonthlyIncome</td>
<td>1196.0</td>
<td>6520.104515</td>
<td>4665.902253</td>
<td>1009.0</td>
<td>2928.25</td>
<td>4973.5</td>
<td>8420.50</td>
<td>19999.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">PercentSalaryHike</td>
<td>1196.0</td>
<td>15.251672</td>
<td>3.625946</td>
<td>11.0</td>
<td>12.00</td>
<td>14.0</td>
<td>18.00</td>
<td>25.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">TotalWorkingYears</td>
<td>1196.0</td>
<td>11.330268</td>
<td>7.823821</td>
<td>0.0</td>
<td>6.00</td>
<td>10.0</td>
<td>15.00</td>
<td>40.0</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell" data-execution_count="48">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb70-1"><a href="#cb70-1"></a>data.select_dtypes(<span class="st">"number"</span>).corr()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="48">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Attrition</th>
<th data-quarto-table-cell-role="th">Age</th>
<th data-quarto-table-cell-role="th">DistanceFromHome</th>
<th data-quarto-table-cell-role="th">EmployeeNumber</th>
<th data-quarto-table-cell-role="th">JobSatisfaction</th>
<th data-quarto-table-cell-role="th">MonthlyIncome</th>
<th data-quarto-table-cell-role="th">PercentSalaryHike</th>
<th data-quarto-table-cell-role="th">TotalWorkingYears</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">Attrition</td>
<td>1.000000</td>
<td>-0.167866</td>
<td>0.081973</td>
<td>-0.008707</td>
<td>-0.078936</td>
<td>-0.163572</td>
<td>-0.000048</td>
<td>-0.182162</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Age</td>
<td>-0.167866</td>
<td>1.000000</td>
<td>-0.010917</td>
<td>-0.023786</td>
<td>-0.012425</td>
<td>0.490107</td>
<td>-0.008303</td>
<td>0.674331</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">DistanceFromHome</td>
<td>0.081973</td>
<td>-0.010917</td>
<td>1.000000</td>
<td>0.054948</td>
<td>-0.021623</td>
<td>-0.012803</td>
<td>0.052348</td>
<td>0.002606</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">EmployeeNumber</td>
<td>-0.008707</td>
<td>-0.023786</td>
<td>0.054948</td>
<td>1.000000</td>
<td>-0.022863</td>
<td>-0.014032</td>
<td>-0.009514</td>
<td>-0.016317</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">JobSatisfaction</td>
<td>-0.078936</td>
<td>-0.012425</td>
<td>-0.021623</td>
<td>-0.022863</td>
<td>1.000000</td>
<td>-0.025082</td>
<td>0.030811</td>
<td>-0.039380</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">MonthlyIncome</td>
<td>-0.163572</td>
<td>0.490107</td>
<td>-0.012803</td>
<td>-0.014032</td>
<td>-0.025082</td>
<td>1.000000</td>
<td>-0.021334</td>
<td>0.768437</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">PercentSalaryHike</td>
<td>-0.000048</td>
<td>-0.008303</td>
<td>0.052348</td>
<td>-0.009514</td>
<td>0.030811</td>
<td>-0.021334</td>
<td>1.000000</td>
<td>-0.021988</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">TotalWorkingYears</td>
<td>-0.182162</td>
<td>0.674331</td>
<td>0.002606</td>
<td>-0.016317</td>
<td>-0.039380</td>
<td>0.768437</td>
<td>-0.021988</td>
<td>1.000000</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="데이터-준비" class="level3">
<h3 class="anchored" data-anchor-id="데이터-준비">(2) 데이터 준비</h3>
<p><code>-</code> 변수 제거</p>
<div class="cell" data-execution_count="49">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb71-1"><a href="#cb71-1"></a>data.drop(<span class="st">"EmployeeNumber"</span>, axis<span class="op">=</span><span class="dv">1</span>, inplace <span class="op">=</span><span class="va">True</span>)</span>
<span id="cb71-2"><a href="#cb71-2"></a>data.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="49">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Attrition</th>
<th data-quarto-table-cell-role="th">Age</th>
<th data-quarto-table-cell-role="th">DistanceFromHome</th>
<th data-quarto-table-cell-role="th">Gender</th>
<th data-quarto-table-cell-role="th">JobSatisfaction</th>
<th data-quarto-table-cell-role="th">MaritalStatus</th>
<th data-quarto-table-cell-role="th">MonthlyIncome</th>
<th data-quarto-table-cell-role="th">OverTime</th>
<th data-quarto-table-cell-role="th">PercentSalaryHike</th>
<th data-quarto-table-cell-role="th">TotalWorkingYears</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>0</td>
<td>33</td>
<td>7</td>
<td>Male</td>
<td>3</td>
<td>Married</td>
<td>11691</td>
<td>No</td>
<td>11</td>
<td>14</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>0</td>
<td>35</td>
<td>18</td>
<td>Male</td>
<td>4</td>
<td>Single</td>
<td>9362</td>
<td>No</td>
<td>11</td>
<td>10</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>0</td>
<td>42</td>
<td>6</td>
<td>Male</td>
<td>1</td>
<td>Married</td>
<td>13348</td>
<td>No</td>
<td>13</td>
<td>18</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>0</td>
<td>46</td>
<td>2</td>
<td>Female</td>
<td>1</td>
<td>Married</td>
<td>17048</td>
<td>No</td>
<td>23</td>
<td>28</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>1</td>
<td>22</td>
<td>4</td>
<td>Male</td>
<td>3</td>
<td>Single</td>
<td>3894</td>
<td>No</td>
<td>16</td>
<td>4</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p><code>-</code> x, y 분리</p>
<div class="cell" data-execution_count="50">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb72-1"><a href="#cb72-1"></a>target <span class="op">=</span> <span class="st">"Attrition"</span></span>
<span id="cb72-2"><a href="#cb72-2"></a></span>
<span id="cb72-3"><a href="#cb72-3"></a>x <span class="op">=</span> data.drop(target, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb72-4"><a href="#cb72-4"></a>y <span class="op">=</span> data[target]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><code>-</code> 가변수화</p>
<div class="cell" data-execution_count="51">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb73-1"><a href="#cb73-1"></a>dum_col <span class="op">=</span> [<span class="st">"Gender"</span>, <span class="st">"JobSatisfaction"</span>, <span class="st">"MaritalStatus"</span>, <span class="st">"OverTime"</span>]</span>
<span id="cb73-2"><a href="#cb73-2"></a></span>
<span id="cb73-3"><a href="#cb73-3"></a>x <span class="op">=</span> pd.get_dummies(x, columns <span class="op">=</span> dum_col, drop_first<span class="op">=</span> <span class="va">True</span>, dtype <span class="op">=</span> <span class="bu">float</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="52">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb74-1"><a href="#cb74-1"></a>data.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="52">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Attrition</th>
<th data-quarto-table-cell-role="th">Age</th>
<th data-quarto-table-cell-role="th">DistanceFromHome</th>
<th data-quarto-table-cell-role="th">Gender</th>
<th data-quarto-table-cell-role="th">JobSatisfaction</th>
<th data-quarto-table-cell-role="th">MaritalStatus</th>
<th data-quarto-table-cell-role="th">MonthlyIncome</th>
<th data-quarto-table-cell-role="th">OverTime</th>
<th data-quarto-table-cell-role="th">PercentSalaryHike</th>
<th data-quarto-table-cell-role="th">TotalWorkingYears</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>0</td>
<td>33</td>
<td>7</td>
<td>Male</td>
<td>3</td>
<td>Married</td>
<td>11691</td>
<td>No</td>
<td>11</td>
<td>14</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>0</td>
<td>35</td>
<td>18</td>
<td>Male</td>
<td>4</td>
<td>Single</td>
<td>9362</td>
<td>No</td>
<td>11</td>
<td>10</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>0</td>
<td>42</td>
<td>6</td>
<td>Male</td>
<td>1</td>
<td>Married</td>
<td>13348</td>
<td>No</td>
<td>13</td>
<td>18</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>0</td>
<td>46</td>
<td>2</td>
<td>Female</td>
<td>1</td>
<td>Married</td>
<td>17048</td>
<td>No</td>
<td>23</td>
<td>28</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>1</td>
<td>22</td>
<td>4</td>
<td>Male</td>
<td>3</td>
<td>Single</td>
<td>3894</td>
<td>No</td>
<td>16</td>
<td>4</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p><code>-</code> 학슴용 평가 데이터 분리</p>
<div class="cell" data-execution_count="53">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb75-1"><a href="#cb75-1"></a>x_train, x_test, y_train, y_test <span class="op">=</span> train_test_split(x, y.astype(<span class="bu">str</span>), random_state <span class="op">=</span> <span class="dv">1</span>, test_size <span class="op">=</span> <span class="fl">0.3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><code>-</code> 정규화</p>
<div class="cell" data-execution_count="54">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb76-1"><a href="#cb76-1"></a>scale <span class="op">=</span> <span class="kw">lambda</span>  x : (x <span class="op">-</span> <span class="bu">min</span>(x))<span class="op">/</span>(<span class="bu">max</span>(x)<span class="op">-</span><span class="bu">min</span>(x))</span>
<span id="cb76-2"><a href="#cb76-2"></a></span>
<span id="cb76-3"><a href="#cb76-3"></a>x_train <span class="op">=</span> x_train.<span class="bu">apply</span>(scale, axis <span class="op">=</span>  <span class="dv">0</span>)</span>
<span id="cb76-4"><a href="#cb76-4"></a>x_test <span class="op">=</span> x_test.<span class="bu">apply</span>(scale, axis <span class="op">=</span>  <span class="dv">0</span>)</span>
<span id="cb76-5"><a href="#cb76-5"></a>x_train.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="54">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Age</th>
<th data-quarto-table-cell-role="th">DistanceFromHome</th>
<th data-quarto-table-cell-role="th">MonthlyIncome</th>
<th data-quarto-table-cell-role="th">PercentSalaryHike</th>
<th data-quarto-table-cell-role="th">TotalWorkingYears</th>
<th data-quarto-table-cell-role="th">Gender_Male</th>
<th data-quarto-table-cell-role="th">JobSatisfaction_2</th>
<th data-quarto-table-cell-role="th">JobSatisfaction_3</th>
<th data-quarto-table-cell-role="th">JobSatisfaction_4</th>
<th data-quarto-table-cell-role="th">MaritalStatus_Married</th>
<th data-quarto-table-cell-role="th">MaritalStatus_Single</th>
<th data-quarto-table-cell-role="th">OverTime_Yes</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">567</td>
<td>0.214286</td>
<td>0.321429</td>
<td>0.248997</td>
<td>0.000000</td>
<td>0.150</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>1.0</td>
<td>0.0</td>
<td>1.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">330</td>
<td>0.547619</td>
<td>0.071429</td>
<td>0.416244</td>
<td>0.000000</td>
<td>0.350</td>
<td>1.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">785</td>
<td>0.285714</td>
<td>0.071429</td>
<td>0.084758</td>
<td>0.000000</td>
<td>0.200</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>1.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">11</td>
<td>0.357143</td>
<td>0.500000</td>
<td>0.662814</td>
<td>0.071429</td>
<td>0.375</td>
<td>1.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>1.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">885</td>
<td>0.380952</td>
<td>0.071429</td>
<td>0.353863</td>
<td>0.428571</td>
<td>0.175</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="모델링-5" class="level3">
<h3 class="anchored" data-anchor-id="모델링-5">(3) 모델링</h3>
<div class="cell" data-execution_count="55">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb77-1"><a href="#cb77-1"></a><span class="im">from</span> sklearn.neighbors <span class="im">import</span> KNeighborsClassifier</span>
<span id="cb77-2"><a href="#cb77-2"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> accuracy_score, recall_score, precision_score, f1_score</span>
<span id="cb77-3"><a href="#cb77-3"></a></span>
<span id="cb77-4"><a href="#cb77-4"></a>model <span class="op">=</span> KNeighborsClassifier()</span>
<span id="cb77-5"><a href="#cb77-5"></a></span>
<span id="cb77-6"><a href="#cb77-6"></a>model.fit(x_train, y_train)</span>
<span id="cb77-7"><a href="#cb77-7"></a></span>
<span id="cb77-8"><a href="#cb77-8"></a>y_pred <span class="op">=</span> model.predict(x_test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="결과-시각화-1-y-hat-y-클래스-비교-1" class="level3">
<h3 class="anchored" data-anchor-id="결과-시각화-1-y-hat-y-클래스-비교-1">(4) 결과 시각화 1 : <span class="math inline">\((y, \hat y)\)</span> 클래스 비교</h3>
<div class="cell" data-execution_count="56">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb78-1"><a href="#cb78-1"></a>fig <span class="op">=</span> pd.DataFrame({<span class="st">"y_test"</span> : y_test, <span class="st">"y_pred"</span> : y_pred}).<span class="op">\</span></span>
<span id="cb78-2"><a href="#cb78-2"></a>                        melt(var_name <span class="op">=</span> <span class="st">"label"</span>,value_name <span class="op">=</span> <span class="st">"Attrition"</span>).<span class="op">\</span></span>
<span id="cb78-3"><a href="#cb78-3"></a>                            groupby(<span class="st">"label"</span>,as_index<span class="op">=</span><span class="va">False</span>)[[<span class="st">"Attrition"</span>]].value_counts().<span class="op">\</span></span>
<span id="cb78-4"><a href="#cb78-4"></a>                                plot(x<span class="op">=</span><span class="st">"label"</span>,y<span class="op">=</span> <span class="st">"count"</span>, backend <span class="op">=</span> <span class="st">"plotly"</span>,</span>
<span id="cb78-5"><a href="#cb78-5"></a>                                        facet_col <span class="op">=</span> <span class="st">"Attrition"</span>, kind<span class="op">=</span><span class="st">"bar"</span>,color <span class="op">=</span> <span class="st">"label"</span>,height <span class="op">=</span> <span class="dv">400</span>, width <span class="op">=</span> <span class="dv">600</span>)</span>
<span id="cb78-6"><a href="#cb78-6"></a>fig</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<div>                            <div id="ecf89fd1-9270-4b47-820d-7b9ee464d40a" class="plotly-graph-div" style="height:400px; width:600px;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("ecf89fd1-9270-4b47-820d-7b9ee464d40a")) {                    Plotly.newPlot(                        "ecf89fd1-9270-4b47-820d-7b9ee464d40a",                        [{"alignmentgroup":"True","hovertemplate":"label=%{x}\u003cbr\u003eAttrition=0\u003cbr\u003ecount=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"y_pred","marker":{"color":"#636efa","pattern":{"shape":""}},"name":"y_pred","offsetgroup":"y_pred","orientation":"v","showlegend":true,"textposition":"auto","x":["y_pred"],"xaxis":"x","y":[330],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","hovertemplate":"label=%{x}\u003cbr\u003eAttrition=1\u003cbr\u003ecount=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"y_pred","marker":{"color":"#636efa","pattern":{"shape":""}},"name":"y_pred","offsetgroup":"y_pred","orientation":"v","showlegend":false,"textposition":"auto","x":["y_pred"],"xaxis":"x2","y":[29],"yaxis":"y2","type":"bar"},{"alignmentgroup":"True","hovertemplate":"label=%{x}\u003cbr\u003eAttrition=0\u003cbr\u003ecount=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"y_test","marker":{"color":"#EF553B","pattern":{"shape":""}},"name":"y_test","offsetgroup":"y_test","orientation":"v","showlegend":true,"textposition":"auto","x":["y_test"],"xaxis":"x","y":[300],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","hovertemplate":"label=%{x}\u003cbr\u003eAttrition=1\u003cbr\u003ecount=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"y_test","marker":{"color":"#EF553B","pattern":{"shape":""}},"name":"y_test","offsetgroup":"y_test","orientation":"v","showlegend":false,"textposition":"auto","x":["y_test"],"xaxis":"x2","y":[59],"yaxis":"y2","type":"bar"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"xaxis":{"anchor":"y","domain":[0.0,0.49],"title":{"text":"label"},"categoryorder":"array","categoryarray":["y_pred","y_test"]},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"count"}},"xaxis2":{"anchor":"y2","domain":[0.51,1.0],"matches":"x","title":{"text":"label"},"categoryorder":"array","categoryarray":["y_pred","y_test"]},"yaxis2":{"anchor":"x2","domain":[0.0,1.0],"matches":"y","showticklabels":false},"annotations":[{"font":{},"showarrow":false,"text":"Attrition=0","x":0.245,"xanchor":"center","xref":"paper","y":1.0,"yanchor":"bottom","yref":"paper"},{"font":{},"showarrow":false,"text":"Attrition=1","x":0.755,"xanchor":"center","xref":"paper","y":1.0,"yanchor":"bottom","yref":"paper"}],"legend":{"title":{"text":"label"},"tracegroupgap":0},"margin":{"t":60},"barmode":"relative","height":400,"width":600},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('ecf89fd1-9270-4b47-820d-7b9ee464d40a');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
</section>
<section id="결과-시각화-2-평가지표-1" class="level3">
<h3 class="anchored" data-anchor-id="결과-시각화-2-평가지표-1">(5) 결과 시각화 2 : 평가지표</h3>
<div class="cell" data-execution_count="57">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb79-1"><a href="#cb79-1"></a>acc <span class="op">=</span> accuracy_score(y_pred, y_test)</span>
<span id="cb79-2"><a href="#cb79-2"></a>pre <span class="op">=</span> precision_score(y_pred, y_test, pos_label <span class="op">=</span> <span class="st">"1"</span>)</span>
<span id="cb79-3"><a href="#cb79-3"></a>recall <span class="op">=</span> recall_score(y_pred, y_test,pos_label <span class="op">=</span> <span class="st">"1"</span>)</span>
<span id="cb79-4"><a href="#cb79-4"></a>f1 <span class="op">=</span> f1_score(y_pred, y_test,pos_label <span class="op">=</span> <span class="st">"1"</span>)</span>
<span id="cb79-5"><a href="#cb79-5"></a></span>
<span id="cb79-6"><a href="#cb79-6"></a>result <span class="op">=</span> [acc, pre, recall, f1]</span>
<span id="cb79-7"><a href="#cb79-7"></a>col <span class="op">=</span> [<span class="st">"accuracy"</span>, <span class="st">"precision"</span>, <span class="st">"recall"</span>, <span class="st">"F1-score"</span>]</span>
<span id="cb79-8"><a href="#cb79-8"></a></span>
<span id="cb79-9"><a href="#cb79-9"></a>pd.DataFrame(result,columns<span class="op">=</span>[<span class="st">"value"</span>],index<span class="op">=</span>col).reset_index().<span class="op">\</span></span>
<span id="cb79-10"><a href="#cb79-10"></a>                plot(x<span class="op">=</span><span class="st">"index"</span>, y<span class="op">=</span> <span class="st">"value"</span>,kind<span class="op">=</span><span class="st">"bar"</span>,color<span class="op">=</span> <span class="st">"index"</span>, backend <span class="op">=</span> <span class="st">"plotly"</span>,</span>
<span id="cb79-11"><a href="#cb79-11"></a>                        height <span class="op">=</span> <span class="dv">400</span>, width <span class="op">=</span> <span class="dv">600</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<div>                            <div id="115d8b71-81f3-4251-87a4-a73b15c7c841" class="plotly-graph-div" style="height:400px; width:600px;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("115d8b71-81f3-4251-87a4-a73b15c7c841")) {                    Plotly.newPlot(                        "115d8b71-81f3-4251-87a4-a73b15c7c841",                        [{"alignmentgroup":"True","hovertemplate":"index=%{x}\u003cbr\u003evalue=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"accuracy","marker":{"color":"#636efa","pattern":{"shape":""}},"name":"accuracy","offsetgroup":"accuracy","orientation":"v","showlegend":true,"textposition":"auto","x":["accuracy"],"xaxis":"x","y":[0.8161559888579387],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","hovertemplate":"index=%{x}\u003cbr\u003evalue=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"precision","marker":{"color":"#EF553B","pattern":{"shape":""}},"name":"precision","offsetgroup":"precision","orientation":"v","showlegend":true,"textposition":"auto","x":["precision"],"xaxis":"x","y":[0.1864406779661017],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","hovertemplate":"index=%{x}\u003cbr\u003evalue=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"recall","marker":{"color":"#00cc96","pattern":{"shape":""}},"name":"recall","offsetgroup":"recall","orientation":"v","showlegend":true,"textposition":"auto","x":["recall"],"xaxis":"x","y":[0.3793103448275862],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","hovertemplate":"index=%{x}\u003cbr\u003evalue=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"F1-score","marker":{"color":"#ab63fa","pattern":{"shape":""}},"name":"F1-score","offsetgroup":"F1-score","orientation":"v","showlegend":true,"textposition":"auto","x":["F1-score"],"xaxis":"x","y":[0.24999999999999994],"yaxis":"y","type":"bar"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"index"},"categoryorder":"array","categoryarray":["accuracy","precision","recall","F1-score"]},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"value"}},"legend":{"title":{"text":"index"},"tracegroupgap":0},"margin":{"t":60},"barmode":"relative","height":400,"width":600},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('115d8b71-81f3-4251-87a4-a73b15c7c841');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
</section>
</section>
</section>
<section id="decision-tree" class="level1">
<h1>3. Decision Tree</h1>
<p><code>-</code> 특징</p>
<ol type="1">
<li><p>특정 변수에 대한 의사결정 규칙을 나무 가지가 뻗는 형태로 분류해 나감</p></li>
<li><p>분류와 회귀 모두에 사용되는 지도학습 알고리즘</p></li>
<li><p>분석 과정이 직관적이며, 이해와 설명하기가 쉬움</p></li>
<li><p>스케일링 등의 전처리 영향도가 크지 않음</p></li>
<li><p>분석 과정을 실제로 눈으로 확인할 수 있음 → 화이트박스 모델</p></li>
<li><p>훈련 데이터에 대한 제약 사항이 거의 없는 유연한 모델</p>
<ul>
<li><p>과적합으로 모델 성능이 떨어지기 쉬움</p></li>
<li><p>트리 깊이를 제한하는(=가지치기) 튜닝이 필요</p></li>
</ul></li>
</ol>
<p><code>-</code> 용어</p>
<ol type="1">
<li><p>Root Node(뿌리 마디): 전체 자료를 갖는 시작하는 마디</p></li>
<li><p>Child Node(자식 마디): 마디 하나로부터 분리된 2개 이상의 마디</p></li>
<li><p>Parent Node(부모 마디): 주어진 마디의 상위 마디</p></li>
<li><p>Terminal Node(끝 마디): 자식 마디가 없는 마디(=Leaf Node)</p></li>
<li><p>Internal Node(중간 마디): 부모 마디와 자식 마디가 모두 있는 마디</p></li>
<li><p>Branch(가지): 연결되어 있는 2개 이상의 마디 집합</p></li>
<li><p>Depth(깊이): 뿌리 마디로부터 끝 마디까지 연결된 마디 개수</p></li>
</ol>
<p><code>-</code> 비용함수 1. 지니 불순도</p>
<p><span class="math display">\[\text {Gini}  = 1 - \sum_{i=1}^{c} (p_i)^2\]</span></p>
<ul>
<li><p>완벽하게 섞이면 <span class="math inline">\(\to\)</span> 1</p></li>
<li><p>반반 섞이면 <span class="math inline">\(\to\)</span> 0.5</p></li>
</ul>
<p><code>-</code> 비용함수 2. 엔트로피</p>
<p><span class="math display">\[\text {Entropy} = -\sum_{i=1}^m p_i \log_2 p_i\]</span></p>
<ul>
<li><p>완벽하게 섞이면 <span class="math inline">\(\to\)</span> 1</p></li>
<li><p>반반 섞이면 <span class="math inline">\(\to\)</span> 0.5</p></li>
</ul>
<p><code>-</code> <strong>정보이득</strong></p>
<ul>
<li><p>엔트로피는 단지 속성의 불순도를 표현한다.</p></li>
<li><p>우리가 알고 싶은것은 <strong>“어떤 feature가 얼마나 많은 정보를 제공하는가!”</strong> 이다.</p></li>
</ul>
<p><span class="math display">\[Gain(T,X) = Entropy(T) - Entropy(T,X)\]</span></p>
<ul>
<li><p>어떤 피처에서 <span class="math inline">\(Gain(T,X)\)</span>가 크다는 것은 불순도가 작다는 것을 의미한다.</p></li>
<li><p>일단 모든 속성에 대해 분할 후 Gain을 계산 후, Gain이 가장 큰 속성부터 분할!</p></li>
</ul>
<p><code>-</code> 가지치기 : 과적합을 막기 위한 방법</p>
<ul>
<li><p>max_depth : tree의 깊이</p></li>
<li><p><strong>min_samples_leaf(default = 1)</strong> : leaf 노드가 되기 위한 최소한의 샘플 수</p>
<ul>
<li>불균형 클래인 경우 이를 고려하여 작은 앖을 설정할 필요가 있음</li>
</ul></li>
<li><p><strong>min_samples_split(default = 2)</strong> : 노드를 분할하기 위한 최소한의 샘플 개수 (값을 작게 설정할 수록 계속 분할되어, 과적합 발생이 가능)</p></li>
<li><p><strong>max_feature</strong> : 최선의 분할을 위해 고려할 Feature 수</p>
<ul>
<li>sqrt : 전체 변수의 루트값</li>
<li>auto : sqrt와 같은 의미</li>
<li>log : <span class="math inline">\(\log_2 \text{(전체 변수의 수)}\)</span></li>
<li>max_leaf_node : 리프 노드의 최대 개수</li>
</ul></li>
</ul>
<section id="실습" class="level2">
<h2 class="anchored" data-anchor-id="실습">실습</h2>
<section id="데이터-로드-및-탐색-3" class="level3">
<h3 class="anchored" data-anchor-id="데이터-로드-및-탐색-3">(1) 데이터 로드 및 탐색</h3>
<div class="cell" data-execution_count="58">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb80-1"><a href="#cb80-1"></a><span class="co"># 데이터 읽어오기</span></span>
<span id="cb80-2"><a href="#cb80-2"></a>path <span class="op">=</span> <span class="st">'https://raw.githubusercontent.com/jangrae/csv/master/titanic_train.csv'</span></span>
<span id="cb80-3"><a href="#cb80-3"></a>data <span class="op">=</span> pd.read_csv(path)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="59">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb81-1"><a href="#cb81-1"></a>data.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="59">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">PassengerId</th>
<th data-quarto-table-cell-role="th">Survived</th>
<th data-quarto-table-cell-role="th">Pclass</th>
<th data-quarto-table-cell-role="th">Name</th>
<th data-quarto-table-cell-role="th">Sex</th>
<th data-quarto-table-cell-role="th">Age</th>
<th data-quarto-table-cell-role="th">SibSp</th>
<th data-quarto-table-cell-role="th">Parch</th>
<th data-quarto-table-cell-role="th">Ticket</th>
<th data-quarto-table-cell-role="th">Fare</th>
<th data-quarto-table-cell-role="th">Cabin</th>
<th data-quarto-table-cell-role="th">Embarked</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>1</td>
<td>0</td>
<td>3</td>
<td>Braund, Mr. Owen Harris</td>
<td>male</td>
<td>22.0</td>
<td>1</td>
<td>0</td>
<td>A/5 21171</td>
<td>7.2500</td>
<td>NaN</td>
<td>S</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>2</td>
<td>1</td>
<td>1</td>
<td>Cumings, Mrs. John Bradley (Florence Briggs Th...</td>
<td>female</td>
<td>38.0</td>
<td>1</td>
<td>0</td>
<td>PC 17599</td>
<td>71.2833</td>
<td>C85</td>
<td>C</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>3</td>
<td>1</td>
<td>3</td>
<td>Heikkinen, Miss. Laina</td>
<td>female</td>
<td>26.0</td>
<td>0</td>
<td>0</td>
<td>STON/O2. 3101282</td>
<td>7.9250</td>
<td>NaN</td>
<td>S</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>4</td>
<td>1</td>
<td>1</td>
<td>Futrelle, Mrs. Jacques Heath (Lily May Peel)</td>
<td>female</td>
<td>35.0</td>
<td>1</td>
<td>0</td>
<td>113803</td>
<td>53.1000</td>
<td>C123</td>
<td>S</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>5</td>
<td>0</td>
<td>3</td>
<td>Allen, Mr. William Henry</td>
<td>male</td>
<td>35.0</td>
<td>0</td>
<td>0</td>
<td>373450</td>
<td>8.0500</td>
<td>NaN</td>
<td>S</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell" data-execution_count="60">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb82-1"><a href="#cb82-1"></a>data.info()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 891 entries, 0 to 890
Data columns (total 12 columns):
 #   Column       Non-Null Count  Dtype  
---  ------       --------------  -----  
 0   PassengerId  891 non-null    int64  
 1   Survived     891 non-null    int64  
 2   Pclass       891 non-null    int64  
 3   Name         891 non-null    object 
 4   Sex          891 non-null    object 
 5   Age          714 non-null    float64
 6   SibSp        891 non-null    int64  
 7   Parch        891 non-null    int64  
 8   Ticket       891 non-null    object 
 9   Fare         891 non-null    float64
 10  Cabin        204 non-null    object 
 11  Embarked     889 non-null    object 
dtypes: float64(2), int64(5), object(5)
memory usage: 83.7+ KB</code></pre>
</div>
</div>
<div class="cell" data-execution_count="61">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb84-1"><a href="#cb84-1"></a>data[<span class="st">"Survived"</span>].value_counts()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="61">
<pre><code>Survived
0    549
1    342
Name: count, dtype: int64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="62">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb86-1"><a href="#cb86-1"></a>data.isna().<span class="bu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="62">
<pre><code>PassengerId      0
Survived         0
Pclass           0
Name             0
Sex              0
Age            177
SibSp            0
Parch            0
Ticket           0
Fare             0
Cabin          687
Embarked         2
dtype: int64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="63">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb88-1"><a href="#cb88-1"></a>data.select_dtypes(<span class="st">"number"</span>).corr()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="63">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">PassengerId</th>
<th data-quarto-table-cell-role="th">Survived</th>
<th data-quarto-table-cell-role="th">Pclass</th>
<th data-quarto-table-cell-role="th">Age</th>
<th data-quarto-table-cell-role="th">SibSp</th>
<th data-quarto-table-cell-role="th">Parch</th>
<th data-quarto-table-cell-role="th">Fare</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">PassengerId</td>
<td>1.000000</td>
<td>-0.005007</td>
<td>-0.035144</td>
<td>0.036847</td>
<td>-0.057527</td>
<td>-0.001652</td>
<td>0.012658</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Survived</td>
<td>-0.005007</td>
<td>1.000000</td>
<td>-0.338481</td>
<td>-0.077221</td>
<td>-0.035322</td>
<td>0.081629</td>
<td>0.257307</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Pclass</td>
<td>-0.035144</td>
<td>-0.338481</td>
<td>1.000000</td>
<td>-0.369226</td>
<td>0.083081</td>
<td>0.018443</td>
<td>-0.549500</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Age</td>
<td>0.036847</td>
<td>-0.077221</td>
<td>-0.369226</td>
<td>1.000000</td>
<td>-0.308247</td>
<td>-0.189119</td>
<td>0.096067</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">SibSp</td>
<td>-0.057527</td>
<td>-0.035322</td>
<td>0.083081</td>
<td>-0.308247</td>
<td>1.000000</td>
<td>0.414838</td>
<td>0.159651</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Parch</td>
<td>-0.001652</td>
<td>0.081629</td>
<td>0.018443</td>
<td>-0.189119</td>
<td>0.414838</td>
<td>1.000000</td>
<td>0.216225</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Fare</td>
<td>0.012658</td>
<td>0.257307</td>
<td>-0.549500</td>
<td>0.096067</td>
<td>0.159651</td>
<td>0.216225</td>
<td>1.000000</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell" data-execution_count="64">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb89-1"><a href="#cb89-1"></a><span class="co"># 제거 대상: PassengerId, Name, Ticket, Cabin</span></span>
<span id="cb89-2"><a href="#cb89-2"></a>drop_cols <span class="op">=</span> [<span class="st">'PassengerId'</span>, <span class="st">'Name'</span>, <span class="st">'Ticket'</span>, <span class="st">'Cabin'</span>]</span>
<span id="cb89-3"><a href="#cb89-3"></a></span>
<span id="cb89-4"><a href="#cb89-4"></a><span class="co"># 변수 제거</span></span>
<span id="cb89-5"><a href="#cb89-5"></a>data.drop(drop_cols, axis<span class="op">=</span><span class="dv">1</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb89-6"><a href="#cb89-6"></a></span>
<span id="cb89-7"><a href="#cb89-7"></a><span class="co"># 확인</span></span>
<span id="cb89-8"><a href="#cb89-8"></a>data.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="64">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Survived</th>
<th data-quarto-table-cell-role="th">Pclass</th>
<th data-quarto-table-cell-role="th">Sex</th>
<th data-quarto-table-cell-role="th">Age</th>
<th data-quarto-table-cell-role="th">SibSp</th>
<th data-quarto-table-cell-role="th">Parch</th>
<th data-quarto-table-cell-role="th">Fare</th>
<th data-quarto-table-cell-role="th">Embarked</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>0</td>
<td>3</td>
<td>male</td>
<td>22.0</td>
<td>1</td>
<td>0</td>
<td>7.2500</td>
<td>S</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>1</td>
<td>1</td>
<td>female</td>
<td>38.0</td>
<td>1</td>
<td>0</td>
<td>71.2833</td>
<td>C</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>1</td>
<td>3</td>
<td>female</td>
<td>26.0</td>
<td>0</td>
<td>0</td>
<td>7.9250</td>
<td>S</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>1</td>
<td>1</td>
<td>female</td>
<td>35.0</td>
<td>1</td>
<td>0</td>
<td>53.1000</td>
<td>S</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>0</td>
<td>3</td>
<td>male</td>
<td>35.0</td>
<td>0</td>
<td>0</td>
<td>8.0500</td>
<td>S</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell" data-execution_count="65">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb90-1"><a href="#cb90-1"></a><span class="co"># Age 결측치를 중앙값으로 채우기</span></span>
<span id="cb90-2"><a href="#cb90-2"></a>age_median <span class="op">=</span> data[<span class="st">'Age'</span>].median()</span>
<span id="cb90-3"><a href="#cb90-3"></a>data[<span class="st">'Age'</span>].fillna(age_median, inplace<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="66">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb91-1"><a href="#cb91-1"></a><span class="co"># Embarked 최빈값으로 채우기</span></span>
<span id="cb91-2"><a href="#cb91-2"></a>emb_freq <span class="op">=</span> data[<span class="st">'Embarked'</span>].mode()[<span class="dv">0</span>]</span>
<span id="cb91-3"><a href="#cb91-3"></a>data[<span class="st">'Embarked'</span>].fillna(emb_freq, inplace<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="67">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb92-1"><a href="#cb92-1"></a><span class="co"># target 확인</span></span>
<span id="cb92-2"><a href="#cb92-2"></a>target <span class="op">=</span> <span class="st">'Survived'</span></span>
<span id="cb92-3"><a href="#cb92-3"></a></span>
<span id="cb92-4"><a href="#cb92-4"></a><span class="co"># 데이터 분리</span></span>
<span id="cb92-5"><a href="#cb92-5"></a>x <span class="op">=</span> data.drop(target, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb92-6"><a href="#cb92-6"></a>y <span class="op">=</span> data.loc[:, target]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="68">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb93-1"><a href="#cb93-1"></a><span class="co"># 가변수화 대상: Pclass, Sex, Embarked</span></span>
<span id="cb93-2"><a href="#cb93-2"></a>dumm_cols <span class="op">=</span> [<span class="st">'Pclass'</span>, <span class="st">'Sex'</span>, <span class="st">'Embarked'</span>]</span>
<span id="cb93-3"><a href="#cb93-3"></a></span>
<span id="cb93-4"><a href="#cb93-4"></a><span class="co"># 가변수화</span></span>
<span id="cb93-5"><a href="#cb93-5"></a>x <span class="op">=</span> pd.get_dummies(x, columns<span class="op">=</span>dumm_cols, drop_first<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb93-6"><a href="#cb93-6"></a></span>
<span id="cb93-7"><a href="#cb93-7"></a><span class="co"># 확인</span></span>
<span id="cb93-8"><a href="#cb93-8"></a>x.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="68">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Age</th>
<th data-quarto-table-cell-role="th">SibSp</th>
<th data-quarto-table-cell-role="th">Parch</th>
<th data-quarto-table-cell-role="th">Fare</th>
<th data-quarto-table-cell-role="th">Pclass_2</th>
<th data-quarto-table-cell-role="th">Pclass_3</th>
<th data-quarto-table-cell-role="th">Sex_male</th>
<th data-quarto-table-cell-role="th">Embarked_Q</th>
<th data-quarto-table-cell-role="th">Embarked_S</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>22.0</td>
<td>1</td>
<td>0</td>
<td>7.2500</td>
<td>False</td>
<td>True</td>
<td>True</td>
<td>False</td>
<td>True</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>38.0</td>
<td>1</td>
<td>0</td>
<td>71.2833</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>26.0</td>
<td>0</td>
<td>0</td>
<td>7.9250</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>True</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>35.0</td>
<td>1</td>
<td>0</td>
<td>53.1000</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>True</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>35.0</td>
<td>0</td>
<td>0</td>
<td>8.0500</td>
<td>False</td>
<td>True</td>
<td>True</td>
<td>False</td>
<td>True</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell" data-execution_count="69">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb94-1"><a href="#cb94-1"></a><span class="co"># 모듈 불러오기</span></span>
<span id="cb94-2"><a href="#cb94-2"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb94-3"><a href="#cb94-3"></a></span>
<span id="cb94-4"><a href="#cb94-4"></a><span class="co"># 7:3으로 분리</span></span>
<span id="cb94-5"><a href="#cb94-5"></a>x_train, x_test, y_train, y_test <span class="op">=</span> train_test_split(x, y, test_size<span class="op">=</span><span class="fl">0.3</span>, random_state<span class="op">=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="모델링-6" class="level3">
<h3 class="anchored" data-anchor-id="모델링-6">(2) 모델링</h3>
<div class="cell" data-execution_count="70">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb95-1"><a href="#cb95-1"></a><span class="co"># step 1.  모듈 로드</span></span>
<span id="cb95-2"><a href="#cb95-2"></a><span class="im">from</span> sklearn.tree <span class="im">import</span> DecisionTreeClassifier</span>
<span id="cb95-3"><a href="#cb95-3"></a></span>
<span id="cb95-4"><a href="#cb95-4"></a><span class="co"># step 2.  선언하기</span></span>
<span id="cb95-5"><a href="#cb95-5"></a></span>
<span id="cb95-6"><a href="#cb95-6"></a>model <span class="op">=</span> DecisionTreeClassifier(max_depth <span class="op">=</span> <span class="dv">5</span>)</span>
<span id="cb95-7"><a href="#cb95-7"></a></span>
<span id="cb95-8"><a href="#cb95-8"></a><span class="co"># step 3. 학습하기</span></span>
<span id="cb95-9"><a href="#cb95-9"></a></span>
<span id="cb95-10"><a href="#cb95-10"></a>model.fit(x_train, y_train)</span>
<span id="cb95-11"><a href="#cb95-11"></a></span>
<span id="cb95-12"><a href="#cb95-12"></a><span class="co"># step 4.  예측하기</span></span>
<span id="cb95-13"><a href="#cb95-13"></a>y_pred <span class="op">=</span> model.predict(x_test)</span>
<span id="cb95-14"><a href="#cb95-14"></a></span>
<span id="cb95-15"><a href="#cb95-15"></a><span class="co"># step 5. 평가하기</span></span>
<span id="cb95-16"><a href="#cb95-16"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> accuracy_score, precision_score, recall_score, f1_score</span>
<span id="cb95-17"><a href="#cb95-17"></a>acc <span class="op">=</span> accuracy_score(y_test, y_pred)</span>
<span id="cb95-18"><a href="#cb95-18"></a>pre <span class="op">=</span> precision_score(y_test, y_pred) </span>
<span id="cb95-19"><a href="#cb95-19"></a>recall <span class="op">=</span> recall_score(y_test, y_pred)</span>
<span id="cb95-20"><a href="#cb95-20"></a>f1_score <span class="op">=</span> f1_score(y_test, y_pred)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="시각화-1-평가지표" class="level3">
<h3 class="anchored" data-anchor-id="시각화-1-평가지표">(3) 시각화 1 : 평가지표</h3>
<div class="cell" data-execution_count="71">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb96-1"><a href="#cb96-1"></a>fig <span class="op">=</span> pd.DataFrame({<span class="st">"score"</span> : [acc,pre,recall,f1_score],</span>
<span id="cb96-2"><a href="#cb96-2"></a>                            <span class="st">"measure"</span> : [<span class="st">"acc"</span>,<span class="st">"precision"</span>,<span class="st">"recall"</span>,<span class="st">"f1_score"</span>]}).<span class="op">\</span></span>
<span id="cb96-3"><a href="#cb96-3"></a>                                    plot(x <span class="op">=</span> <span class="st">"measure"</span>, y <span class="op">=</span> <span class="st">"score"</span>,  color <span class="op">=</span> <span class="st">"measure"</span>,</span>
<span id="cb96-4"><a href="#cb96-4"></a>                                            backend <span class="op">=</span> <span class="st">"plotly"</span>, kind <span class="op">=</span>  <span class="st">"bar"</span>,height <span class="op">=</span> <span class="dv">500</span>, width <span class="op">=</span> <span class="dv">600</span>)</span>
<span id="cb96-5"><a href="#cb96-5"></a>fig.update_yaxes(<span class="bu">range</span> <span class="op">=</span> [<span class="fl">0.5</span>, <span class="fl">0.85</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<div>                            <div id="e1ca77d7-7c71-4613-b52f-c49a120657a1" class="plotly-graph-div" style="height:500px; width:600px;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("e1ca77d7-7c71-4613-b52f-c49a120657a1")) {                    Plotly.newPlot(                        "e1ca77d7-7c71-4613-b52f-c49a120657a1",                        [{"alignmentgroup":"True","hovertemplate":"measure=%{x}\u003cbr\u003escore=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"acc","marker":{"color":"#636efa","pattern":{"shape":""}},"name":"acc","offsetgroup":"acc","orientation":"v","showlegend":true,"textposition":"auto","x":["acc"],"xaxis":"x","y":[0.7686567164179104],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","hovertemplate":"measure=%{x}\u003cbr\u003escore=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"precision","marker":{"color":"#EF553B","pattern":{"shape":""}},"name":"precision","offsetgroup":"precision","orientation":"v","showlegend":true,"textposition":"auto","x":["precision"],"xaxis":"x","y":[0.8117647058823529],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","hovertemplate":"measure=%{x}\u003cbr\u003escore=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"recall","marker":{"color":"#00cc96","pattern":{"shape":""}},"name":"recall","offsetgroup":"recall","orientation":"v","showlegend":true,"textposition":"auto","x":["recall"],"xaxis":"x","y":[0.6],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","hovertemplate":"measure=%{x}\u003cbr\u003escore=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"f1_score","marker":{"color":"#ab63fa","pattern":{"shape":""}},"name":"f1_score","offsetgroup":"f1_score","orientation":"v","showlegend":true,"textposition":"auto","x":["f1_score"],"xaxis":"x","y":[0.6900000000000001],"yaxis":"y","type":"bar"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"measure"},"categoryorder":"array","categoryarray":["acc","precision","recall","f1_score"]},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"score"},"range":[0.5,0.85]},"legend":{"title":{"text":"measure"},"tracegroupgap":0},"margin":{"t":60},"barmode":"relative","height":500,"width":600},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('e1ca77d7-7c71-4613-b52f-c49a120657a1');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
</section>
<section id="시각화-2-tree-모델" class="level3">
<h3 class="anchored" data-anchor-id="시각화-2-tree-모델">(4) 시각화 2 : tree 모델</h3>
<div class="cell" data-execution_count="72">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb97-1"><a href="#cb97-1"></a><span class="co"># 시각화 모듈 불러오기</span></span>
<span id="cb97-2"><a href="#cb97-2"></a><span class="im">from</span> sklearn.tree <span class="im">import</span> export_graphviz</span>
<span id="cb97-3"><a href="#cb97-3"></a><span class="im">from</span> IPython.display <span class="im">import</span> Image</span>
<span id="cb97-4"><a href="#cb97-4"></a></span>
<span id="cb97-5"><a href="#cb97-5"></a><span class="co"># 이미지 파일 만들기</span></span>
<span id="cb97-6"><a href="#cb97-6"></a>export_graphviz(model,                                 <span class="co"># 모델 이름</span></span>
<span id="cb97-7"><a href="#cb97-7"></a>                out_file<span class="op">=</span><span class="st">'tree.dot'</span>,                   <span class="co"># 파일 이름</span></span>
<span id="cb97-8"><a href="#cb97-8"></a>                feature_names<span class="op">=</span>x.columns,               <span class="co"># Feature 이름</span></span>
<span id="cb97-9"><a href="#cb97-9"></a>                class_names<span class="op">=</span>[<span class="st">'die'</span>, <span class="st">'survived'</span>],       <span class="co"># Target Class 이름</span></span>
<span id="cb97-10"><a href="#cb97-10"></a>                rounded<span class="op">=</span><span class="va">True</span>,                          <span class="co"># 둥근 테두리</span></span>
<span id="cb97-11"><a href="#cb97-11"></a>                precision<span class="op">=</span><span class="dv">2</span>,                           <span class="co"># 불순도 소숫점 자리수</span></span>
<span id="cb97-12"><a href="#cb97-12"></a>                filled<span class="op">=</span><span class="va">True</span>,                              <span class="co"># 박스 내부 채우기</span></span>
<span id="cb97-13"><a href="#cb97-13"></a>                max_depth<span class="op">=</span><span class="dv">3</span>)                         <span class="co"># 그래프에 표시할 트리의 깊이</span></span>
<span id="cb97-14"><a href="#cb97-14"></a></span>
<span id="cb97-15"><a href="#cb97-15"></a><span class="co"># 파일 변환</span></span>
<span id="cb97-16"><a href="#cb97-16"></a><span class="op">!</span>dot tree.dot <span class="op">-</span>Tpng <span class="op">-</span>otree.png <span class="op">-</span>Gdpi<span class="op">=</span><span class="dv">300</span></span>
<span id="cb97-17"><a href="#cb97-17"></a></span>
<span id="cb97-18"><a href="#cb97-18"></a><span class="co"># 이미지 파일 표시</span></span>
<span id="cb97-19"><a href="#cb97-19"></a>Image(filename<span class="op">=</span><span class="st">'tree.png'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="72">
<p><img src="2023-09-13-02. 머신러닝 (2)_files/figure-html/cell-73-output-1.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="시각화-3-변수-중요도" class="level3">
<h3 class="anchored" data-anchor-id="시각화-3-변수-중요도">(5) 시각화 3 : 변수 중요도</h3>
<div class="cell" data-execution_count="73">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb98-1"><a href="#cb98-1"></a>ipt <span class="op">=</span> model.feature_importances_</span>
<span id="cb98-2"><a href="#cb98-2"></a>pd.DataFrame({<span class="st">"importance"</span> : ipt, <span class="st">"var"</span> : <span class="bu">list</span>(x)}).<span class="op">\</span></span>
<span id="cb98-3"><a href="#cb98-3"></a>                            sort_values(<span class="st">"importance"</span>, ascending <span class="op">=</span> <span class="va">False</span>).<span class="op">\</span></span>
<span id="cb98-4"><a href="#cb98-4"></a>                            plot( x <span class="op">=</span> <span class="st">"importance"</span>, y<span class="op">=</span> <span class="st">"var"</span>, </span>
<span id="cb98-5"><a href="#cb98-5"></a>                                     kind <span class="op">=</span> <span class="st">"barh"</span>, backend <span class="op">=</span> <span class="st">"plotly"</span>,</span>
<span id="cb98-6"><a href="#cb98-6"></a>                                     height <span class="op">=</span> <span class="dv">400</span>, width <span class="op">=</span> <span class="dv">600</span>,color <span class="op">=</span> <span class="st">"var"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<div>                            <div id="cde49260-c1e4-4397-a329-04fdd5603f9e" class="plotly-graph-div" style="height:400px; width:600px;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("cde49260-c1e4-4397-a329-04fdd5603f9e")) {                    Plotly.newPlot(                        "cde49260-c1e4-4397-a329-04fdd5603f9e",                        [{"alignmentgroup":"True","hovertemplate":"var=%{y}\u003cbr\u003eimportance=%{x}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"Sex_male","marker":{"color":"#636efa","pattern":{"shape":""}},"name":"Sex_male","offsetgroup":"Sex_male","orientation":"h","showlegend":true,"textposition":"auto","x":[0.53213395379656],"xaxis":"x","y":["Sex_male"],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","hovertemplate":"var=%{y}\u003cbr\u003eimportance=%{x}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"Pclass_3","marker":{"color":"#EF553B","pattern":{"shape":""}},"name":"Pclass_3","offsetgroup":"Pclass_3","orientation":"h","showlegend":true,"textposition":"auto","x":[0.1303435275253384],"xaxis":"x","y":["Pclass_3"],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","hovertemplate":"var=%{y}\u003cbr\u003eimportance=%{x}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"Age","marker":{"color":"#00cc96","pattern":{"shape":""}},"name":"Age","offsetgroup":"Age","orientation":"h","showlegend":true,"textposition":"auto","x":[0.12605790568912636],"xaxis":"x","y":["Age"],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","hovertemplate":"var=%{y}\u003cbr\u003eimportance=%{x}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"Fare","marker":{"color":"#ab63fa","pattern":{"shape":""}},"name":"Fare","offsetgroup":"Fare","orientation":"h","showlegend":true,"textposition":"auto","x":[0.10091981700807877],"xaxis":"x","y":["Fare"],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","hovertemplate":"var=%{y}\u003cbr\u003eimportance=%{x}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"SibSp","marker":{"color":"#FFA15A","pattern":{"shape":""}},"name":"SibSp","offsetgroup":"SibSp","orientation":"h","showlegend":true,"textposition":"auto","x":[0.0593912430643297],"xaxis":"x","y":["SibSp"],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","hovertemplate":"var=%{y}\u003cbr\u003eimportance=%{x}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"Embarked_S","marker":{"color":"#19d3f3","pattern":{"shape":""}},"name":"Embarked_S","offsetgroup":"Embarked_S","orientation":"h","showlegend":true,"textposition":"auto","x":[0.04368588095794391],"xaxis":"x","y":["Embarked_S"],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","hovertemplate":"var=%{y}\u003cbr\u003eimportance=%{x}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"Pclass_2","marker":{"color":"#FF6692","pattern":{"shape":""}},"name":"Pclass_2","offsetgroup":"Pclass_2","orientation":"h","showlegend":true,"textposition":"auto","x":[0.0057443630450945285],"xaxis":"x","y":["Pclass_2"],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","hovertemplate":"var=%{y}\u003cbr\u003eimportance=%{x}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"Parch","marker":{"color":"#B6E880","pattern":{"shape":""}},"name":"Parch","offsetgroup":"Parch","orientation":"h","showlegend":true,"textposition":"auto","x":[0.0017233089135283615],"xaxis":"x","y":["Parch"],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","hovertemplate":"var=%{y}\u003cbr\u003eimportance=%{x}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"Embarked_Q","marker":{"color":"#FF97FF","pattern":{"shape":""}},"name":"Embarked_Q","offsetgroup":"Embarked_Q","orientation":"h","showlegend":true,"textposition":"auto","x":[0.0],"xaxis":"x","y":["Embarked_Q"],"yaxis":"y","type":"bar"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"importance"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"var"},"categoryorder":"array","categoryarray":["Embarked_Q","Parch","Pclass_2","Embarked_S","SibSp","Fare","Age","Pclass_3","Sex_male"]},"legend":{"title":{"text":"var"},"tracegroupgap":0},"margin":{"t":60},"barmode":"relative","height":400,"width":600},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('cde49260-c1e4-4397-a329-04fdd5603f9e');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
</section>
</section>
<section id="excercise.-1-1" class="level2">
<h2 class="anchored" data-anchor-id="excercise.-1-1">excercise. 1</h2>
<section id="데이터-로드-및-탐색-4" class="level3">
<h3 class="anchored" data-anchor-id="데이터-로드-및-탐색-4">(1) 데이터 로드 및 탐색</h3>
<p><strong>데이터 설명</strong></p>
<ul>
<li>COLLEGE: 대학 졸업여부</li>
<li>INCOME: 연수입</li>
<li>OVERAGE: 월평균 초과사용 시간(분)</li>
<li>LEFTOVER: 월평균 잔여시간비율(%)</li>
<li>HOUSE: 집값</li>
<li>HANDSET_PRICE: 스마트폰 가격</li>
<li>OVER_15MINS_CALLS_PER_MONTH: 월평균 장기통화(15분이상) 횟수</li>
<li>AVERAGE_CALL_DURATION: 평균 통화 시간</li>
<li>REPORTED_SATISFACTION: 만족도 설문조사 결과</li>
<li>REPORTED_USAGE_LEVEL: 사용도 자가진단 결과</li>
<li>CONSIDERING_CHANGE_OF_PLAN: 향후 변경계획 설문조사 결과</li>
<li>CHURN: 이탈(번호이동) 여부 (Target 변수)</li>
</ul>
<div class="cell" data-execution_count="74">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb99-1"><a href="#cb99-1"></a><span class="co"># 데이터 읽어오기</span></span>
<span id="cb99-2"><a href="#cb99-2"></a>path <span class="op">=</span> <span class="st">'https://raw.githubusercontent.com/jangrae/csv/master/mobile_cust_churn.csv'</span></span>
<span id="cb99-3"><a href="#cb99-3"></a>data <span class="op">=</span> pd.read_csv(path)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="75">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb100-1"><a href="#cb100-1"></a>data.info()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 20000 entries, 0 to 19999
Data columns (total 13 columns):
 #   Column                       Non-Null Count  Dtype 
---  ------                       --------------  ----- 
 0   id                           20000 non-null  int64 
 1   COLLEGE                      20000 non-null  int64 
 2   INCOME                       20000 non-null  int64 
 3   OVERAGE                      20000 non-null  int64 
 4   LEFTOVER                     20000 non-null  int64 
 5   HOUSE                        20000 non-null  int64 
 6   HANDSET_PRICE                20000 non-null  int64 
 7   OVER_15MINS_CALLS_PER_MONTH  20000 non-null  int64 
 8   AVERAGE_CALL_DURATION        20000 non-null  int64 
 9   REPORTED_SATISFACTION        20000 non-null  object
 10  REPORTED_USAGE_LEVEL         20000 non-null  object
 11  CONSIDERING_CHANGE_OF_PLAN   20000 non-null  object
 12  CHURN                        20000 non-null  object
dtypes: int64(9), object(4)
memory usage: 2.0+ MB</code></pre>
</div>
</div>
<div class="cell" data-execution_count="76">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb102-1"><a href="#cb102-1"></a>data[<span class="st">"CHURN"</span>].value_counts()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="76">
<pre><code>CHURN
STAY     10148
LEAVE     9852
Name: count, dtype: int64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="77">
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb104-1"><a href="#cb104-1"></a>data.select_dtypes(<span class="st">"number"</span>).corr()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="77">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">id</th>
<th data-quarto-table-cell-role="th">COLLEGE</th>
<th data-quarto-table-cell-role="th">INCOME</th>
<th data-quarto-table-cell-role="th">OVERAGE</th>
<th data-quarto-table-cell-role="th">LEFTOVER</th>
<th data-quarto-table-cell-role="th">HOUSE</th>
<th data-quarto-table-cell-role="th">HANDSET_PRICE</th>
<th data-quarto-table-cell-role="th">OVER_15MINS_CALLS_PER_MONTH</th>
<th data-quarto-table-cell-role="th">AVERAGE_CALL_DURATION</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">id</td>
<td>1.000000</td>
<td>-0.005557</td>
<td>0.003686</td>
<td>-0.006050</td>
<td>0.006069</td>
<td>0.011347</td>
<td>-0.007838</td>
<td>0.001254</td>
<td>-0.005830</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">COLLEGE</td>
<td>-0.005557</td>
<td>1.000000</td>
<td>0.011122</td>
<td>-0.003091</td>
<td>-0.003925</td>
<td>-0.000217</td>
<td>0.009950</td>
<td>-0.007205</td>
<td>-0.001490</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">INCOME</td>
<td>0.003686</td>
<td>0.011122</td>
<td>1.000000</td>
<td>0.000458</td>
<td>0.006515</td>
<td>-0.010964</td>
<td>0.727200</td>
<td>0.002136</td>
<td>-0.007219</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">OVERAGE</td>
<td>-0.006050</td>
<td>-0.003091</td>
<td>0.000458</td>
<td>1.000000</td>
<td>-0.003123</td>
<td>0.002412</td>
<td>0.000324</td>
<td>0.770557</td>
<td>0.000653</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">LEFTOVER</td>
<td>0.006069</td>
<td>-0.003925</td>
<td>0.006515</td>
<td>-0.003123</td>
<td>1.000000</td>
<td>0.006530</td>
<td>0.004004</td>
<td>-0.010411</td>
<td>-0.660285</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">HOUSE</td>
<td>0.011347</td>
<td>-0.000217</td>
<td>-0.010964</td>
<td>0.002412</td>
<td>0.006530</td>
<td>1.000000</td>
<td>-0.007756</td>
<td>0.007410</td>
<td>-0.009359</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">HANDSET_PRICE</td>
<td>-0.007838</td>
<td>0.009950</td>
<td>0.727200</td>
<td>0.000324</td>
<td>0.004004</td>
<td>-0.007756</td>
<td>1.000000</td>
<td>0.002680</td>
<td>-0.005190</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">OVER_15MINS_CALLS_PER_MONTH</td>
<td>0.001254</td>
<td>-0.007205</td>
<td>0.002136</td>
<td>0.770557</td>
<td>-0.010411</td>
<td>0.007410</td>
<td>0.002680</td>
<td>1.000000</td>
<td>0.007769</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">AVERAGE_CALL_DURATION</td>
<td>-0.005830</td>
<td>-0.001490</td>
<td>-0.007219</td>
<td>0.000653</td>
<td>-0.660285</td>
<td>-0.009359</td>
<td>-0.005190</td>
<td>0.007769</td>
<td>1.000000</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell" data-execution_count="78">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb105-1"><a href="#cb105-1"></a>data.isna().<span class="bu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="78">
<pre><code>id                             0
COLLEGE                        0
INCOME                         0
OVERAGE                        0
LEFTOVER                       0
HOUSE                          0
HANDSET_PRICE                  0
OVER_15MINS_CALLS_PER_MONTH    0
AVERAGE_CALL_DURATION          0
REPORTED_SATISFACTION          0
REPORTED_USAGE_LEVEL           0
CONSIDERING_CHANGE_OF_PLAN     0
CHURN                          0
dtype: int64</code></pre>
</div>
</div>
<section id="a.-데이터-준비" class="level4">
<h4 class="anchored" data-anchor-id="a.-데이터-준비">(a). 데이터 준비</h4>
<p><code>-</code> 변수 제거</p>
<div class="cell" data-execution_count="79">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb107-1"><a href="#cb107-1"></a>_data <span class="op">=</span> data.drop(<span class="st">"id"</span>, axis <span class="op">=</span> <span class="dv">1</span>).copy()</span>
<span id="cb107-2"><a href="#cb107-2"></a>_data.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="79">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">COLLEGE</th>
<th data-quarto-table-cell-role="th">INCOME</th>
<th data-quarto-table-cell-role="th">OVERAGE</th>
<th data-quarto-table-cell-role="th">LEFTOVER</th>
<th data-quarto-table-cell-role="th">HOUSE</th>
<th data-quarto-table-cell-role="th">HANDSET_PRICE</th>
<th data-quarto-table-cell-role="th">OVER_15MINS_CALLS_PER_MONTH</th>
<th data-quarto-table-cell-role="th">AVERAGE_CALL_DURATION</th>
<th data-quarto-table-cell-role="th">REPORTED_SATISFACTION</th>
<th data-quarto-table-cell-role="th">REPORTED_USAGE_LEVEL</th>
<th data-quarto-table-cell-role="th">CONSIDERING_CHANGE_OF_PLAN</th>
<th data-quarto-table-cell-role="th">CHURN</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>0</td>
<td>31953</td>
<td>0</td>
<td>6</td>
<td>313378</td>
<td>161</td>
<td>0</td>
<td>4</td>
<td>unsat</td>
<td>little</td>
<td>no</td>
<td>STAY</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>1</td>
<td>36147</td>
<td>0</td>
<td>13</td>
<td>800586</td>
<td>244</td>
<td>0</td>
<td>6</td>
<td>unsat</td>
<td>little</td>
<td>considering</td>
<td>STAY</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>1</td>
<td>27273</td>
<td>230</td>
<td>0</td>
<td>305049</td>
<td>201</td>
<td>16</td>
<td>15</td>
<td>unsat</td>
<td>very_little</td>
<td>perhaps</td>
<td>STAY</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>0</td>
<td>120070</td>
<td>38</td>
<td>33</td>
<td>788235</td>
<td>780</td>
<td>3</td>
<td>2</td>
<td>unsat</td>
<td>very_high</td>
<td>considering</td>
<td>LEAVE</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>1</td>
<td>29215</td>
<td>208</td>
<td>85</td>
<td>224784</td>
<td>241</td>
<td>21</td>
<td>1</td>
<td>very_unsat</td>
<td>little</td>
<td>never_thought</td>
<td>STAY</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p><code>=</code> x, y 분리</p>
<div class="cell" data-execution_count="80">
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb108-1"><a href="#cb108-1"></a>target <span class="op">=</span> <span class="st">"CHURN"</span></span>
<span id="cb108-2"><a href="#cb108-2"></a></span>
<span id="cb108-3"><a href="#cb108-3"></a>x <span class="op">=</span> _data.drop(target, axis <span class="op">=</span> <span class="dv">1</span>)</span>
<span id="cb108-4"><a href="#cb108-4"></a>y <span class="op">=</span> _data[target]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><code>-</code> 가변수화</p>
<div class="cell" data-execution_count="81">
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb109-1"><a href="#cb109-1"></a>d_cols <span class="op">=</span> [<span class="st">"REPORTED_SATISFACTION"</span>, <span class="st">"REPORTED_USAGE_LEVEL"</span>, <span class="st">"CONSIDERING_CHANGE_OF_PLAN"</span>]</span>
<span id="cb109-2"><a href="#cb109-2"></a></span>
<span id="cb109-3"><a href="#cb109-3"></a>x <span class="op">=</span> pd.get_dummies(x, columns <span class="op">=</span> d_cols, drop_first <span class="op">=</span> <span class="va">True</span>, dtype <span class="op">=</span> <span class="bu">float</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><code>-</code> 훈련, 평가 데이터 분리</p>
<div class="cell" data-execution_count="82">
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb110-1"><a href="#cb110-1"></a>x_train, x_test, y_train , y_test <span class="op">=</span> train_test_split(x, y, test_size <span class="op">=</span> <span class="fl">0.3</span>, random_state <span class="op">=</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="모델링-7" class="level3">
<h3 class="anchored" data-anchor-id="모델링-7">(2) 모델링</h3>
<div class="cell" data-execution_count="83">
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb111-1"><a href="#cb111-1"></a><span class="im">from</span> sklearn.tree <span class="im">import</span> DecisionTreeClassifier</span>
<span id="cb111-2"><a href="#cb111-2"></a></span>
<span id="cb111-3"><a href="#cb111-3"></a><span class="co"># step 1. 모델 선언</span></span>
<span id="cb111-4"><a href="#cb111-4"></a>model  <span class="op">=</span> DecisionTreeClassifier(max_depth <span class="op">=</span> <span class="dv">5</span>,random_state<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb111-5"><a href="#cb111-5"></a><span class="co"># step 2.  모델 fit</span></span>
<span id="cb111-6"><a href="#cb111-6"></a>model.fit(x_train,y_train)</span>
<span id="cb111-7"><a href="#cb111-7"></a></span>
<span id="cb111-8"><a href="#cb111-8"></a><span class="co"># step 3. 모델 pred</span></span>
<span id="cb111-9"><a href="#cb111-9"></a>y_pred <span class="op">=</span> model.predict(x_test)</span>
<span id="cb111-10"><a href="#cb111-10"></a></span>
<span id="cb111-11"><a href="#cb111-11"></a><span class="co"># step 4.  평가지표 산출</span></span>
<span id="cb111-12"><a href="#cb111-12"></a><span class="im">from</span> sklearn <span class="im">import</span> metrics</span>
<span id="cb111-13"><a href="#cb111-13"></a>acc <span class="op">=</span> accuracy_score(y_pred, y_test)</span>
<span id="cb111-14"><a href="#cb111-14"></a>pre <span class="op">=</span> precision_score(y_pred, y_test, pos_label <span class="op">=</span> <span class="st">"LEAVE"</span>)</span>
<span id="cb111-15"><a href="#cb111-15"></a>rec <span class="op">=</span>  recall_score(y_pred, y_test,  pos_label <span class="op">=</span> <span class="st">"LEAVE"</span>)</span>
<span id="cb111-16"><a href="#cb111-16"></a>f1 <span class="op">=</span> metrics.f1_score(y_test,y_pred, pos_label <span class="op">=</span> <span class="st">"LEAVE"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="시각화-1-평가지표-1" class="level3">
<h3 class="anchored" data-anchor-id="시각화-1-평가지표-1">(3) 시각화 1 : 평가지표</h3>
<div class="cell" data-execution_count="84">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb112-1"><a href="#cb112-1"></a>fig <span class="op">=</span> pd.DataFrame({<span class="st">"score"</span> : [acc,pre,recall,f1_score],</span>
<span id="cb112-2"><a href="#cb112-2"></a>                            <span class="st">"measure"</span> : [<span class="st">"acc"</span>,<span class="st">"precision"</span>,<span class="st">"recall"</span>,<span class="st">"f1_score"</span>]}).<span class="op">\</span></span>
<span id="cb112-3"><a href="#cb112-3"></a>                                    plot(x <span class="op">=</span> <span class="st">"measure"</span>, y <span class="op">=</span> <span class="st">"score"</span>,  color <span class="op">=</span> <span class="st">"measure"</span>,</span>
<span id="cb112-4"><a href="#cb112-4"></a>                                            backend <span class="op">=</span> <span class="st">"plotly"</span>, kind <span class="op">=</span>  <span class="st">"bar"</span>,height <span class="op">=</span> <span class="dv">500</span>, width <span class="op">=</span> <span class="dv">600</span>)</span>
<span id="cb112-5"><a href="#cb112-5"></a>fig.update_yaxes(<span class="bu">range</span> <span class="op">=</span> [<span class="fl">0.5</span>, <span class="fl">0.71</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<div>                            <div id="640b4c16-4662-49ce-ae94-96b43f524f1e" class="plotly-graph-div" style="height:500px; width:600px;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("640b4c16-4662-49ce-ae94-96b43f524f1e")) {                    Plotly.newPlot(                        "640b4c16-4662-49ce-ae94-96b43f524f1e",                        [{"alignmentgroup":"True","hovertemplate":"measure=%{x}\u003cbr\u003escore=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"acc","marker":{"color":"#636efa","pattern":{"shape":""}},"name":"acc","offsetgroup":"acc","orientation":"v","showlegend":true,"textposition":"auto","x":["acc"],"xaxis":"x","y":[0.6981666666666667],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","hovertemplate":"measure=%{x}\u003cbr\u003escore=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"precision","marker":{"color":"#EF553B","pattern":{"shape":""}},"name":"precision","offsetgroup":"precision","orientation":"v","showlegend":true,"textposition":"auto","x":["precision"],"xaxis":"x","y":[0.7076660988074958],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","hovertemplate":"measure=%{x}\u003cbr\u003escore=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"recall","marker":{"color":"#00cc96","pattern":{"shape":""}},"name":"recall","offsetgroup":"recall","orientation":"v","showlegend":true,"textposition":"auto","x":["recall"],"xaxis":"x","y":[0.6],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","hovertemplate":"measure=%{x}\u003cbr\u003escore=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"f1_score","marker":{"color":"#ab63fa","pattern":{"shape":""}},"name":"f1_score","offsetgroup":"f1_score","orientation":"v","showlegend":true,"textposition":"auto","x":["f1_score"],"xaxis":"x","y":[0.6900000000000001],"yaxis":"y","type":"bar"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"measure"},"categoryorder":"array","categoryarray":["acc","precision","recall","f1_score"]},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"score"},"range":[0.5,0.71]},"legend":{"title":{"text":"measure"},"tracegroupgap":0},"margin":{"t":60},"barmode":"relative","height":500,"width":600},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('640b4c16-4662-49ce-ae94-96b43f524f1e');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
</section>
<section id="시각화-2-tree-모델-1" class="level3">
<h3 class="anchored" data-anchor-id="시각화-2-tree-모델-1">(4) 시각화 2 : tree 모델</h3>
<div class="cell" data-execution_count="85">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb113-1"><a href="#cb113-1"></a><span class="co"># 시각화 모듈 불러오기</span></span>
<span id="cb113-2"><a href="#cb113-2"></a><span class="im">from</span> sklearn.tree <span class="im">import</span> export_graphviz</span>
<span id="cb113-3"><a href="#cb113-3"></a><span class="im">from</span> IPython.display <span class="im">import</span> Image</span>
<span id="cb113-4"><a href="#cb113-4"></a></span>
<span id="cb113-5"><a href="#cb113-5"></a><span class="co"># 이미지 파일 만들기</span></span>
<span id="cb113-6"><a href="#cb113-6"></a>export_graphviz(model,                                 <span class="co"># 모델 이름</span></span>
<span id="cb113-7"><a href="#cb113-7"></a>                out_file<span class="op">=</span><span class="st">'tree.dot'</span>,                   <span class="co"># 파일 이름</span></span>
<span id="cb113-8"><a href="#cb113-8"></a>                feature_names<span class="op">=</span>x.columns,               <span class="co"># Feature 이름</span></span>
<span id="cb113-9"><a href="#cb113-9"></a>                class_names<span class="op">=</span>[<span class="st">'Leave'</span>, <span class="st">'Stay'</span>],       <span class="co"># Target Class 이름</span></span>
<span id="cb113-10"><a href="#cb113-10"></a>                rounded<span class="op">=</span><span class="va">True</span>,                          <span class="co"># 둥근 테두리</span></span>
<span id="cb113-11"><a href="#cb113-11"></a>                precision<span class="op">=</span><span class="dv">2</span>,                           <span class="co"># 불순도 소숫점 자리수</span></span>
<span id="cb113-12"><a href="#cb113-12"></a>                filled<span class="op">=</span><span class="va">True</span>,                              <span class="co"># 박스 내부 채우기</span></span>
<span id="cb113-13"><a href="#cb113-13"></a>                max_depth<span class="op">=</span><span class="dv">3</span>)                         <span class="co"># 그래프에 표시할 트리의 깊이</span></span>
<span id="cb113-14"><a href="#cb113-14"></a></span>
<span id="cb113-15"><a href="#cb113-15"></a><span class="co"># 파일 변환</span></span>
<span id="cb113-16"><a href="#cb113-16"></a><span class="op">!</span>dot tree.dot <span class="op">-</span>Tpng <span class="op">-</span>otree.png <span class="op">-</span>Gdpi<span class="op">=</span><span class="dv">300</span></span>
<span id="cb113-17"><a href="#cb113-17"></a></span>
<span id="cb113-18"><a href="#cb113-18"></a><span class="co"># 이미지 파일 표시</span></span>
<span id="cb113-19"><a href="#cb113-19"></a>Image(filename<span class="op">=</span><span class="st">'tree.png'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="85">
<p><img src="2023-09-13-02. 머신러닝 (2)_files/figure-html/cell-86-output-1.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="시각화-3-변수-중요도-1" class="level3">
<h3 class="anchored" data-anchor-id="시각화-3-변수-중요도-1">(5) 시각화 3 : 변수 중요도</h3>
<div class="cell" data-execution_count="86">
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb114-1"><a href="#cb114-1"></a>ipt <span class="op">=</span> model.feature_importances_</span>
<span id="cb114-2"><a href="#cb114-2"></a>fig <span class="op">=</span> pd.DataFrame({<span class="st">"importance"</span> : ipt, <span class="st">"var"</span> : <span class="bu">list</span>(x)}).<span class="op">\</span></span>
<span id="cb114-3"><a href="#cb114-3"></a>                            sort_values(<span class="st">"importance"</span>, ascending <span class="op">=</span> <span class="va">False</span>).<span class="op">\</span></span>
<span id="cb114-4"><a href="#cb114-4"></a>                            plot( y <span class="op">=</span> <span class="st">"importance"</span>, x<span class="op">=</span> <span class="st">"var"</span>, </span>
<span id="cb114-5"><a href="#cb114-5"></a>                                     kind <span class="op">=</span> <span class="st">"bar"</span>, backend <span class="op">=</span> <span class="st">"plotly"</span>,</span>
<span id="cb114-6"><a href="#cb114-6"></a>                                     height <span class="op">=</span> <span class="dv">400</span>, width <span class="op">=</span> <span class="dv">600</span>,color <span class="op">=</span> <span class="st">"var"</span>)</span>
<span id="cb114-7"><a href="#cb114-7"></a>fig.update_layout(showlegend <span class="op">=</span> <span class="va">False</span>)</span>
<span id="cb114-8"><a href="#cb114-8"></a>fig.update_xaxes(showticklabels<span class="op">=</span><span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<div>                            <div id="6ac1a3f2-b672-490c-b434-3d5e6c134d7e" class="plotly-graph-div" style="height:400px; width:600px;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("6ac1a3f2-b672-490c-b434-3d5e6c134d7e")) {                    Plotly.newPlot(                        "6ac1a3f2-b672-490c-b434-3d5e6c134d7e",                        [{"alignmentgroup":"True","hovertemplate":"var=%{x}\u003cbr\u003eimportance=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"OVERAGE","marker":{"color":"#636efa","pattern":{"shape":""}},"name":"OVERAGE","offsetgroup":"OVERAGE","orientation":"v","showlegend":true,"textposition":"auto","x":["OVERAGE"],"xaxis":"x","y":[0.3759923381185798],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","hovertemplate":"var=%{x}\u003cbr\u003eimportance=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"HOUSE","marker":{"color":"#EF553B","pattern":{"shape":""}},"name":"HOUSE","offsetgroup":"HOUSE","orientation":"v","showlegend":true,"textposition":"auto","x":["HOUSE"],"xaxis":"x","y":[0.2707956950755841],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","hovertemplate":"var=%{x}\u003cbr\u003eimportance=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"INCOME","marker":{"color":"#00cc96","pattern":{"shape":""}},"name":"INCOME","offsetgroup":"INCOME","orientation":"v","showlegend":true,"textposition":"auto","x":["INCOME"],"xaxis":"x","y":[0.212063606277205],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","hovertemplate":"var=%{x}\u003cbr\u003eimportance=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"LEFTOVER","marker":{"color":"#ab63fa","pattern":{"shape":""}},"name":"LEFTOVER","offsetgroup":"LEFTOVER","orientation":"v","showlegend":true,"textposition":"auto","x":["LEFTOVER"],"xaxis":"x","y":[0.12609640452547738],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","hovertemplate":"var=%{x}\u003cbr\u003eimportance=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"HANDSET_PRICE","marker":{"color":"#FFA15A","pattern":{"shape":""}},"name":"HANDSET_PRICE","offsetgroup":"HANDSET_PRICE","orientation":"v","showlegend":true,"textposition":"auto","x":["HANDSET_PRICE"],"xaxis":"x","y":[0.010619429142221805],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","hovertemplate":"var=%{x}\u003cbr\u003eimportance=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"REPORTED_USAGE_LEVEL_high","marker":{"color":"#19d3f3","pattern":{"shape":""}},"name":"REPORTED_USAGE_LEVEL_high","offsetgroup":"REPORTED_USAGE_LEVEL_high","orientation":"v","showlegend":true,"textposition":"auto","x":["REPORTED_USAGE_LEVEL_high"],"xaxis":"x","y":[0.0017020825192466229],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","hovertemplate":"var=%{x}\u003cbr\u003eimportance=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"COLLEGE","marker":{"color":"#FF6692","pattern":{"shape":""}},"name":"COLLEGE","offsetgroup":"COLLEGE","orientation":"v","showlegend":true,"textposition":"auto","x":["COLLEGE"],"xaxis":"x","y":[0.0010245379525857185],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","hovertemplate":"var=%{x}\u003cbr\u003eimportance=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"REPORTED_USAGE_LEVEL_little","marker":{"color":"#B6E880","pattern":{"shape":""}},"name":"REPORTED_USAGE_LEVEL_little","offsetgroup":"REPORTED_USAGE_LEVEL_little","orientation":"v","showlegend":true,"textposition":"auto","x":["REPORTED_USAGE_LEVEL_little"],"xaxis":"x","y":[0.0010211253578389801],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","hovertemplate":"var=%{x}\u003cbr\u003eimportance=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"AVERAGE_CALL_DURATION","marker":{"color":"#FF97FF","pattern":{"shape":""}},"name":"AVERAGE_CALL_DURATION","offsetgroup":"AVERAGE_CALL_DURATION","orientation":"v","showlegend":true,"textposition":"auto","x":["AVERAGE_CALL_DURATION"],"xaxis":"x","y":[0.0005931174286510017],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","hovertemplate":"var=%{x}\u003cbr\u003eimportance=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"CONSIDERING_CHANGE_OF_PLAN_no","marker":{"color":"#FECB52","pattern":{"shape":""}},"name":"CONSIDERING_CHANGE_OF_PLAN_no","offsetgroup":"CONSIDERING_CHANGE_OF_PLAN_no","orientation":"v","showlegend":true,"textposition":"auto","x":["CONSIDERING_CHANGE_OF_PLAN_no"],"xaxis":"x","y":[9.166360260969972e-05],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","hovertemplate":"var=%{x}\u003cbr\u003eimportance=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"REPORTED_USAGE_LEVEL_very_high","marker":{"color":"#636efa","pattern":{"shape":""}},"name":"REPORTED_USAGE_LEVEL_very_high","offsetgroup":"REPORTED_USAGE_LEVEL_very_high","orientation":"v","showlegend":true,"textposition":"auto","x":["REPORTED_USAGE_LEVEL_very_high"],"xaxis":"x","y":[0.0],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","hovertemplate":"var=%{x}\u003cbr\u003eimportance=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"CONSIDERING_CHANGE_OF_PLAN_never_thought","marker":{"color":"#EF553B","pattern":{"shape":""}},"name":"CONSIDERING_CHANGE_OF_PLAN_never_thought","offsetgroup":"CONSIDERING_CHANGE_OF_PLAN_never_thought","orientation":"v","showlegend":true,"textposition":"auto","x":["CONSIDERING_CHANGE_OF_PLAN_never_thought"],"xaxis":"x","y":[0.0],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","hovertemplate":"var=%{x}\u003cbr\u003eimportance=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"CONSIDERING_CHANGE_OF_PLAN_considering","marker":{"color":"#00cc96","pattern":{"shape":""}},"name":"CONSIDERING_CHANGE_OF_PLAN_considering","offsetgroup":"CONSIDERING_CHANGE_OF_PLAN_considering","orientation":"v","showlegend":true,"textposition":"auto","x":["CONSIDERING_CHANGE_OF_PLAN_considering"],"xaxis":"x","y":[0.0],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","hovertemplate":"var=%{x}\u003cbr\u003eimportance=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"REPORTED_USAGE_LEVEL_very_little","marker":{"color":"#ab63fa","pattern":{"shape":""}},"name":"REPORTED_USAGE_LEVEL_very_little","offsetgroup":"REPORTED_USAGE_LEVEL_very_little","orientation":"v","showlegend":true,"textposition":"auto","x":["REPORTED_USAGE_LEVEL_very_little"],"xaxis":"x","y":[0.0],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","hovertemplate":"var=%{x}\u003cbr\u003eimportance=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"REPORTED_SATISFACTION_very_sat","marker":{"color":"#FFA15A","pattern":{"shape":""}},"name":"REPORTED_SATISFACTION_very_sat","offsetgroup":"REPORTED_SATISFACTION_very_sat","orientation":"v","showlegend":true,"textposition":"auto","x":["REPORTED_SATISFACTION_very_sat"],"xaxis":"x","y":[0.0],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","hovertemplate":"var=%{x}\u003cbr\u003eimportance=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"REPORTED_SATISFACTION_very_unsat","marker":{"color":"#19d3f3","pattern":{"shape":""}},"name":"REPORTED_SATISFACTION_very_unsat","offsetgroup":"REPORTED_SATISFACTION_very_unsat","orientation":"v","showlegend":true,"textposition":"auto","x":["REPORTED_SATISFACTION_very_unsat"],"xaxis":"x","y":[0.0],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","hovertemplate":"var=%{x}\u003cbr\u003eimportance=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"REPORTED_SATISFACTION_unsat","marker":{"color":"#FF6692","pattern":{"shape":""}},"name":"REPORTED_SATISFACTION_unsat","offsetgroup":"REPORTED_SATISFACTION_unsat","orientation":"v","showlegend":true,"textposition":"auto","x":["REPORTED_SATISFACTION_unsat"],"xaxis":"x","y":[0.0],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","hovertemplate":"var=%{x}\u003cbr\u003eimportance=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"REPORTED_SATISFACTION_sat","marker":{"color":"#B6E880","pattern":{"shape":""}},"name":"REPORTED_SATISFACTION_sat","offsetgroup":"REPORTED_SATISFACTION_sat","orientation":"v","showlegend":true,"textposition":"auto","x":["REPORTED_SATISFACTION_sat"],"xaxis":"x","y":[0.0],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","hovertemplate":"var=%{x}\u003cbr\u003eimportance=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"OVER_15MINS_CALLS_PER_MONTH","marker":{"color":"#FF97FF","pattern":{"shape":""}},"name":"OVER_15MINS_CALLS_PER_MONTH","offsetgroup":"OVER_15MINS_CALLS_PER_MONTH","orientation":"v","showlegend":true,"textposition":"auto","x":["OVER_15MINS_CALLS_PER_MONTH"],"xaxis":"x","y":[0.0],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","hovertemplate":"var=%{x}\u003cbr\u003eimportance=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"CONSIDERING_CHANGE_OF_PLAN_perhaps","marker":{"color":"#FECB52","pattern":{"shape":""}},"name":"CONSIDERING_CHANGE_OF_PLAN_perhaps","offsetgroup":"CONSIDERING_CHANGE_OF_PLAN_perhaps","orientation":"v","showlegend":true,"textposition":"auto","x":["CONSIDERING_CHANGE_OF_PLAN_perhaps"],"xaxis":"x","y":[0.0],"yaxis":"y","type":"bar"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"var"},"categoryorder":"array","categoryarray":["OVERAGE","HOUSE","INCOME","LEFTOVER","HANDSET_PRICE","REPORTED_USAGE_LEVEL_high","COLLEGE","REPORTED_USAGE_LEVEL_little","AVERAGE_CALL_DURATION","CONSIDERING_CHANGE_OF_PLAN_no","REPORTED_USAGE_LEVEL_very_high","CONSIDERING_CHANGE_OF_PLAN_never_thought","CONSIDERING_CHANGE_OF_PLAN_considering","REPORTED_USAGE_LEVEL_very_little","REPORTED_SATISFACTION_very_sat","REPORTED_SATISFACTION_very_unsat","REPORTED_SATISFACTION_unsat","REPORTED_SATISFACTION_sat","OVER_15MINS_CALLS_PER_MONTH","CONSIDERING_CHANGE_OF_PLAN_perhaps"],"showticklabels":false},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"importance"}},"legend":{"title":{"text":"var"},"tracegroupgap":0},"margin":{"t":60},"barmode":"relative","height":400,"width":600,"showlegend":false},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('6ac1a3f2-b672-490c-b434-3d5e6c134d7e');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
</section>
</section>
<section id="excercise.-2-1" class="level2">
<h2 class="anchored" data-anchor-id="excercise.-2-1">excercise. 2</h2>
<section id="데이터-로드-및-탐색-5" class="level3">
<h3 class="anchored" data-anchor-id="데이터-로드-및-탐색-5">(1) 데이터 로드 및 탐색</h3>
<p><strong>데이터설명</strong></p>
<p>피마 인디언 당뇨 데이터셋은 몇 명의 여성 피마 인디언의 진료 자료와 진단 후 5년 내 당뇨 발병 여부로 구성됨</p>
<ul>
<li>Pregnancies: 임신 횟수</li>
<li>Glucose: 포도당 부하 검사 수치</li>
<li>BloodPressure: 혈압(mm Hg)</li>
<li>SkinThickness: 팔 삼두근 뒤쪽의 피하지방 측정값(mm)</li>
<li>Insulin: 혈청 인슐린(mu U/ml)</li>
<li>BMI: 체질량지수(체중(kg)/키(m))^2</li>
<li>DiabetesPedigreeFunction: 당뇨 내력 가중치 값</li>
<li>Age: 나이</li>
<li>Outcome: 클래스 결정 값(0 또는 1)</li>
</ul>
<p><strong>diabetes</strong></p>
<ul>
<li>당뇨병(糖尿病, diabetes)은 높은 혈당 수치가 오랜 기간 지속되는 대사 질환이다.</li>
<li>혈당이 높을 때의 증상으로는 소변이 잦아지고, 갈증과 배고픔이 심해진다.</li>
<li>이를 치료하지 않으면 다른 합병증을 유발할 수 있다. (출처: 위키백과)</li>
</ul>
<div class="cell" data-execution_count="87">
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb115-1"><a href="#cb115-1"></a><span class="co"># 데이터 읽어오기</span></span>
<span id="cb115-2"><a href="#cb115-2"></a>path <span class="op">=</span> <span class="st">'https://raw.githubusercontent.com/jangrae/csv/master/diabetes.csv'</span></span>
<span id="cb115-3"><a href="#cb115-3"></a>data <span class="op">=</span> pd.read_csv(path)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="88">
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb116-1"><a href="#cb116-1"></a>data.info()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 768 entries, 0 to 767
Data columns (total 9 columns):
 #   Column                    Non-Null Count  Dtype  
---  ------                    --------------  -----  
 0   Pregnancies               768 non-null    int64  
 1   Glucose                   768 non-null    int64  
 2   BloodPressure             768 non-null    int64  
 3   SkinThickness             768 non-null    int64  
 4   Insulin                   768 non-null    int64  
 5   BMI                       768 non-null    float64
 6   DiabetesPedigreeFunction  768 non-null    float64
 7   Age                       768 non-null    int64  
 8   Outcome                   768 non-null    int64  
dtypes: float64(2), int64(7)
memory usage: 54.1 KB</code></pre>
</div>
</div>
<div class="cell" data-execution_count="89">
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb118-1"><a href="#cb118-1"></a>data.isna().<span class="bu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="89">
<pre><code>Pregnancies                 0
Glucose                     0
BloodPressure               0
SkinThickness               0
Insulin                     0
BMI                         0
DiabetesPedigreeFunction    0
Age                         0
Outcome                     0
dtype: int64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="90">
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb120-1"><a href="#cb120-1"></a>data.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="90">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Pregnancies</th>
<th data-quarto-table-cell-role="th">Glucose</th>
<th data-quarto-table-cell-role="th">BloodPressure</th>
<th data-quarto-table-cell-role="th">SkinThickness</th>
<th data-quarto-table-cell-role="th">Insulin</th>
<th data-quarto-table-cell-role="th">BMI</th>
<th data-quarto-table-cell-role="th">DiabetesPedigreeFunction</th>
<th data-quarto-table-cell-role="th">Age</th>
<th data-quarto-table-cell-role="th">Outcome</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>6</td>
<td>148</td>
<td>72</td>
<td>35</td>
<td>0</td>
<td>33.6</td>
<td>0.627</td>
<td>50</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>1</td>
<td>85</td>
<td>66</td>
<td>29</td>
<td>0</td>
<td>26.6</td>
<td>0.351</td>
<td>31</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>8</td>
<td>183</td>
<td>64</td>
<td>0</td>
<td>0</td>
<td>23.3</td>
<td>0.672</td>
<td>32</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>1</td>
<td>89</td>
<td>66</td>
<td>23</td>
<td>94</td>
<td>28.1</td>
<td>0.167</td>
<td>21</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>0</td>
<td>137</td>
<td>40</td>
<td>35</td>
<td>168</td>
<td>43.1</td>
<td>2.288</td>
<td>33</td>
<td>1</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell" data-execution_count="91">
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb121-1"><a href="#cb121-1"></a>data.corr()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="91">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Pregnancies</th>
<th data-quarto-table-cell-role="th">Glucose</th>
<th data-quarto-table-cell-role="th">BloodPressure</th>
<th data-quarto-table-cell-role="th">SkinThickness</th>
<th data-quarto-table-cell-role="th">Insulin</th>
<th data-quarto-table-cell-role="th">BMI</th>
<th data-quarto-table-cell-role="th">DiabetesPedigreeFunction</th>
<th data-quarto-table-cell-role="th">Age</th>
<th data-quarto-table-cell-role="th">Outcome</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">Pregnancies</td>
<td>1.000000</td>
<td>0.129459</td>
<td>0.141282</td>
<td>-0.081672</td>
<td>-0.073535</td>
<td>0.017683</td>
<td>-0.033523</td>
<td>0.544341</td>
<td>0.221898</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Glucose</td>
<td>0.129459</td>
<td>1.000000</td>
<td>0.152590</td>
<td>0.057328</td>
<td>0.331357</td>
<td>0.221071</td>
<td>0.137337</td>
<td>0.263514</td>
<td>0.466581</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">BloodPressure</td>
<td>0.141282</td>
<td>0.152590</td>
<td>1.000000</td>
<td>0.207371</td>
<td>0.088933</td>
<td>0.281805</td>
<td>0.041265</td>
<td>0.239528</td>
<td>0.065068</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">SkinThickness</td>
<td>-0.081672</td>
<td>0.057328</td>
<td>0.207371</td>
<td>1.000000</td>
<td>0.436783</td>
<td>0.392573</td>
<td>0.183928</td>
<td>-0.113970</td>
<td>0.074752</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Insulin</td>
<td>-0.073535</td>
<td>0.331357</td>
<td>0.088933</td>
<td>0.436783</td>
<td>1.000000</td>
<td>0.197859</td>
<td>0.185071</td>
<td>-0.042163</td>
<td>0.130548</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">BMI</td>
<td>0.017683</td>
<td>0.221071</td>
<td>0.281805</td>
<td>0.392573</td>
<td>0.197859</td>
<td>1.000000</td>
<td>0.140647</td>
<td>0.036242</td>
<td>0.292695</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">DiabetesPedigreeFunction</td>
<td>-0.033523</td>
<td>0.137337</td>
<td>0.041265</td>
<td>0.183928</td>
<td>0.185071</td>
<td>0.140647</td>
<td>1.000000</td>
<td>0.033561</td>
<td>0.173844</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Age</td>
<td>0.544341</td>
<td>0.263514</td>
<td>0.239528</td>
<td>-0.113970</td>
<td>-0.042163</td>
<td>0.036242</td>
<td>0.033561</td>
<td>1.000000</td>
<td>0.238356</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Outcome</td>
<td>0.221898</td>
<td>0.466581</td>
<td>0.065068</td>
<td>0.074752</td>
<td>0.130548</td>
<td>0.292695</td>
<td>0.173844</td>
<td>0.238356</td>
<td>1.000000</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell" data-execution_count="92">
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb122-1"><a href="#cb122-1"></a>data.Outcome.value_counts()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="92">
<pre><code>Outcome
0    500
1    268
Name: count, dtype: int64</code></pre>
</div>
</div>
</section>
<section id="데이터-분리" class="level3">
<h3 class="anchored" data-anchor-id="데이터-분리">(2) 데이터 분리</h3>
<div class="cell" data-execution_count="93">
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb124-1"><a href="#cb124-1"></a>target <span class="op">=</span> <span class="st">"Outcome"</span></span>
<span id="cb124-2"><a href="#cb124-2"></a></span>
<span id="cb124-3"><a href="#cb124-3"></a>x <span class="op">=</span> data.drop(target, axis <span class="op">=</span> <span class="dv">1</span>)</span>
<span id="cb124-4"><a href="#cb124-4"></a>y <span class="op">=</span> data[target]</span>
<span id="cb124-5"><a href="#cb124-5"></a></span>
<span id="cb124-6"><a href="#cb124-6"></a>x_train, x_test, y_train, y_test <span class="op">=</span> train_test_split(x, y,  random_state <span class="op">=</span> <span class="dv">1</span>, test_size <span class="op">=</span> <span class="fl">0.3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="모델링-8" class="level3">
<h3 class="anchored" data-anchor-id="모델링-8">(3) 모델링</h3>
<div class="cell" data-execution_count="94">
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb125-1"><a href="#cb125-1"></a><span class="im">from</span> sklearn.tree <span class="im">import</span> DecisionTreeClassifier</span>
<span id="cb125-2"><a href="#cb125-2"></a></span>
<span id="cb125-3"><a href="#cb125-3"></a>model <span class="op">=</span> DecisionTreeClassifier()</span>
<span id="cb125-4"><a href="#cb125-4"></a></span>
<span id="cb125-5"><a href="#cb125-5"></a>model.fit(x_train,y_train)</span>
<span id="cb125-6"><a href="#cb125-6"></a></span>
<span id="cb125-7"><a href="#cb125-7"></a>y_pred <span class="op">=</span> model.predict(x_test)</span>
<span id="cb125-8"><a href="#cb125-8"></a></span>
<span id="cb125-9"><a href="#cb125-9"></a>acc, pre, re, f1 <span class="op">=</span> accuracy_score(y_test,y_pred), precision_score(y_test, y_pred), recall_score(y_test, y_pred), metrics.f1_score(y_test, y_pred)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="시각화-1.-평가지표" class="level3">
<h3 class="anchored" data-anchor-id="시각화-1.-평가지표">(4) 시각화 1. 평가지표</h3>
<p><code>-</code> 걍함수로 만들자…</p>
<div class="cell" data-execution_count="95">
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb126-1"><a href="#cb126-1"></a><span class="kw">def</span> score(<span class="bu">range</span> <span class="op">=</span> [<span class="fl">0.5</span>, <span class="fl">0.71</span>]) : </span>
<span id="cb126-2"><a href="#cb126-2"></a>            fig <span class="op">=</span> pd.DataFrame({<span class="st">"score"</span> : [acc,pre,recall,f1_score],</span>
<span id="cb126-3"><a href="#cb126-3"></a>                            <span class="st">"measure"</span> : [<span class="st">"acc"</span>,<span class="st">"precision"</span>,<span class="st">"recall"</span>,<span class="st">"f1_score"</span>]}).<span class="op">\</span></span>
<span id="cb126-4"><a href="#cb126-4"></a>                                    plot(x <span class="op">=</span> <span class="st">"measure"</span>, y <span class="op">=</span> <span class="st">"score"</span>,  color <span class="op">=</span> <span class="st">"measure"</span>,</span>
<span id="cb126-5"><a href="#cb126-5"></a>                                            backend <span class="op">=</span> <span class="st">"plotly"</span>, kind <span class="op">=</span>  <span class="st">"bar"</span>,height <span class="op">=</span> <span class="dv">500</span>, width <span class="op">=</span> <span class="dv">600</span>)</span>
<span id="cb126-6"><a href="#cb126-6"></a>            fig.update_yaxes(<span class="bu">range</span> <span class="op">=</span> <span class="bu">range</span>)</span>
<span id="cb126-7"><a href="#cb126-7"></a>            <span class="cf">return</span> fig</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="96">
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb127-1"><a href="#cb127-1"></a>score()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<div>                            <div id="9b04106d-45df-4647-b188-60459ec05954" class="plotly-graph-div" style="height:500px; width:600px;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("9b04106d-45df-4647-b188-60459ec05954")) {                    Plotly.newPlot(                        "9b04106d-45df-4647-b188-60459ec05954",                        [{"alignmentgroup":"True","hovertemplate":"measure=%{x}\u003cbr\u003escore=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"acc","marker":{"color":"#636efa","pattern":{"shape":""}},"name":"acc","offsetgroup":"acc","orientation":"v","showlegend":true,"textposition":"auto","x":["acc"],"xaxis":"x","y":[0.70995670995671],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","hovertemplate":"measure=%{x}\u003cbr\u003escore=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"precision","marker":{"color":"#EF553B","pattern":{"shape":""}},"name":"precision","offsetgroup":"precision","orientation":"v","showlegend":true,"textposition":"auto","x":["precision"],"xaxis":"x","y":[0.6125],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","hovertemplate":"measure=%{x}\u003cbr\u003escore=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"recall","marker":{"color":"#00cc96","pattern":{"shape":""}},"name":"recall","offsetgroup":"recall","orientation":"v","showlegend":true,"textposition":"auto","x":["recall"],"xaxis":"x","y":[0.6],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","hovertemplate":"measure=%{x}\u003cbr\u003escore=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"f1_score","marker":{"color":"#ab63fa","pattern":{"shape":""}},"name":"f1_score","offsetgroup":"f1_score","orientation":"v","showlegend":true,"textposition":"auto","x":["f1_score"],"xaxis":"x","y":[0.6900000000000001],"yaxis":"y","type":"bar"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"measure"},"categoryorder":"array","categoryarray":["acc","precision","recall","f1_score"]},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"score"},"range":[0.5,0.71]},"legend":{"title":{"text":"measure"},"tracegroupgap":0},"margin":{"t":60},"barmode":"relative","height":500,"width":600},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('9b04106d-45df-4647-b188-60459ec05954');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
</section>
<section id="시각화-2-tree-모델-2" class="level3">
<h3 class="anchored" data-anchor-id="시각화-2-tree-모델-2">(5) 시각화 2 : tree 모델</h3>
<div class="cell" data-execution_count="97">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb128-1"><a href="#cb128-1"></a><span class="co"># 시각화 모듈 불러오기</span></span>
<span id="cb128-2"><a href="#cb128-2"></a><span class="im">from</span> sklearn.tree <span class="im">import</span> export_graphviz</span>
<span id="cb128-3"><a href="#cb128-3"></a><span class="im">from</span> IPython.display <span class="im">import</span> Image</span>
<span id="cb128-4"><a href="#cb128-4"></a></span>
<span id="cb128-5"><a href="#cb128-5"></a><span class="co"># 이미지 파일 만들기</span></span>
<span id="cb128-6"><a href="#cb128-6"></a>export_graphviz(model,                                 <span class="co"># 모델 이름</span></span>
<span id="cb128-7"><a href="#cb128-7"></a>                out_file<span class="op">=</span><span class="st">'tree.dot'</span>,                   <span class="co"># 파일 이름</span></span>
<span id="cb128-8"><a href="#cb128-8"></a>                feature_names<span class="op">=</span>x.columns,               <span class="co"># Feature 이름</span></span>
<span id="cb128-9"><a href="#cb128-9"></a>                class_names<span class="op">=</span>[<span class="st">'0'</span>, <span class="st">'1'</span>],       <span class="co"># Target Class 이름</span></span>
<span id="cb128-10"><a href="#cb128-10"></a>                rounded<span class="op">=</span><span class="va">True</span>,                          <span class="co"># 둥근 테두리</span></span>
<span id="cb128-11"><a href="#cb128-11"></a>                precision<span class="op">=</span><span class="dv">2</span>,                           <span class="co"># 불순도 소숫점 자리수</span></span>
<span id="cb128-12"><a href="#cb128-12"></a>                filled<span class="op">=</span><span class="va">True</span>,                              <span class="co"># 박스 내부 채우기</span></span>
<span id="cb128-13"><a href="#cb128-13"></a>                max_depth<span class="op">=</span><span class="dv">3</span>)                         <span class="co"># 그래프에 표시할 트리의 깊이</span></span>
<span id="cb128-14"><a href="#cb128-14"></a></span>
<span id="cb128-15"><a href="#cb128-15"></a><span class="co"># 파일 변환</span></span>
<span id="cb128-16"><a href="#cb128-16"></a><span class="op">!</span>dot tree.dot <span class="op">-</span>Tpng <span class="op">-</span>otree.png <span class="op">-</span>Gdpi<span class="op">=</span><span class="dv">300</span></span>
<span id="cb128-17"><a href="#cb128-17"></a></span>
<span id="cb128-18"><a href="#cb128-18"></a><span class="co"># 이미지 파일 표시</span></span>
<span id="cb128-19"><a href="#cb128-19"></a>Image(filename<span class="op">=</span><span class="st">'tree.png'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="97">
<p><img src="2023-09-13-02. 머신러닝 (2)_files/figure-html/cell-98-output-1.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="시각화-3-변수-중요도-2" class="level3">
<h3 class="anchored" data-anchor-id="시각화-3-변수-중요도-2">(5) 시각화 3 : 변수 중요도</h3>
<div class="cell" data-execution_count="98">
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb129-1"><a href="#cb129-1"></a><span class="kw">def</span> importance(x,model) :</span>
<span id="cb129-2"><a href="#cb129-2"></a>        ipt <span class="op">=</span> model.feature_importances_</span>
<span id="cb129-3"><a href="#cb129-3"></a>        fig <span class="op">=</span> pd.DataFrame({<span class="st">"importance"</span> : ipt, <span class="st">"var"</span> : <span class="bu">list</span>(x)}).<span class="op">\</span></span>
<span id="cb129-4"><a href="#cb129-4"></a>                                sort_values(<span class="st">"importance"</span>, ascending <span class="op">=</span> <span class="va">False</span>).<span class="op">\</span></span>
<span id="cb129-5"><a href="#cb129-5"></a>                                plot( y <span class="op">=</span> <span class="st">"importance"</span>, x<span class="op">=</span> <span class="st">"var"</span>, </span>
<span id="cb129-6"><a href="#cb129-6"></a>                                        kind <span class="op">=</span> <span class="st">"bar"</span>, backend <span class="op">=</span> <span class="st">"plotly"</span>,</span>
<span id="cb129-7"><a href="#cb129-7"></a>                                         height <span class="op">=</span> <span class="dv">400</span>, width <span class="op">=</span> <span class="dv">600</span>,color <span class="op">=</span> <span class="st">"var"</span>, title<span class="op">=</span><span class="st">""</span>.join([i <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">str</span>(model) <span class="cf">if</span> i.isalpha()]))</span>
<span id="cb129-8"><a href="#cb129-8"></a>        fig.update_layout(showlegend <span class="op">=</span> <span class="va">False</span>)</span>
<span id="cb129-9"><a href="#cb129-9"></a>        fig.update_xaxes(showticklabels<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb129-10"><a href="#cb129-10"></a>        <span class="cf">return</span> fig</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="99">
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb130-1"><a href="#cb130-1"></a>importance(x,model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<div>                            <div id="7d892402-3411-4bf0-b525-77f94313858b" class="plotly-graph-div" style="height:400px; width:600px;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("7d892402-3411-4bf0-b525-77f94313858b")) {                    Plotly.newPlot(                        "7d892402-3411-4bf0-b525-77f94313858b",                        [{"alignmentgroup":"True","hovertemplate":"var=%{x}\u003cbr\u003eimportance=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"Glucose","marker":{"color":"#636efa","pattern":{"shape":""}},"name":"Glucose","offsetgroup":"Glucose","orientation":"v","showlegend":true,"textposition":"auto","x":["Glucose"],"xaxis":"x","y":[0.2998975872120889],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","hovertemplate":"var=%{x}\u003cbr\u003eimportance=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"BMI","marker":{"color":"#EF553B","pattern":{"shape":""}},"name":"BMI","offsetgroup":"BMI","orientation":"v","showlegend":true,"textposition":"auto","x":["BMI"],"xaxis":"x","y":[0.18079455867495467],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","hovertemplate":"var=%{x}\u003cbr\u003eimportance=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"BloodPressure","marker":{"color":"#00cc96","pattern":{"shape":""}},"name":"BloodPressure","offsetgroup":"BloodPressure","orientation":"v","showlegend":true,"textposition":"auto","x":["BloodPressure"],"xaxis":"x","y":[0.14120820273988818],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","hovertemplate":"var=%{x}\u003cbr\u003eimportance=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"Age","marker":{"color":"#ab63fa","pattern":{"shape":""}},"name":"Age","offsetgroup":"Age","orientation":"v","showlegend":true,"textposition":"auto","x":["Age"],"xaxis":"x","y":[0.12339901022703663],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","hovertemplate":"var=%{x}\u003cbr\u003eimportance=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"DiabetesPedigreeFunction","marker":{"color":"#FFA15A","pattern":{"shape":""}},"name":"DiabetesPedigreeFunction","offsetgroup":"DiabetesPedigreeFunction","orientation":"v","showlegend":true,"textposition":"auto","x":["DiabetesPedigreeFunction"],"xaxis":"x","y":[0.1180396269051336],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","hovertemplate":"var=%{x}\u003cbr\u003eimportance=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"SkinThickness","marker":{"color":"#19d3f3","pattern":{"shape":""}},"name":"SkinThickness","offsetgroup":"SkinThickness","orientation":"v","showlegend":true,"textposition":"auto","x":["SkinThickness"],"xaxis":"x","y":[0.07088497710176248],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","hovertemplate":"var=%{x}\u003cbr\u003eimportance=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"Pregnancies","marker":{"color":"#FF6692","pattern":{"shape":""}},"name":"Pregnancies","offsetgroup":"Pregnancies","orientation":"v","showlegend":true,"textposition":"auto","x":["Pregnancies"],"xaxis":"x","y":[0.03356677368889454],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","hovertemplate":"var=%{x}\u003cbr\u003eimportance=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"Insulin","marker":{"color":"#B6E880","pattern":{"shape":""}},"name":"Insulin","offsetgroup":"Insulin","orientation":"v","showlegend":true,"textposition":"auto","x":["Insulin"],"xaxis":"x","y":[0.03220926345024099],"yaxis":"y","type":"bar"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"var"},"categoryorder":"array","categoryarray":["Glucose","BMI","BloodPressure","Age","DiabetesPedigreeFunction","SkinThickness","Pregnancies","Insulin"],"showticklabels":true},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"importance"}},"legend":{"title":{"text":"var"},"tracegroupgap":0},"title":{"text":"DecisionTreeClassifier"},"barmode":"relative","height":400,"width":600,"showlegend":false},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('7d892402-3411-4bf0-b525-77f94313858b');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
</section>
</section>
</section>
<section id="logistic-regression" class="level1">
<h1>4. Logistic Regression</h1>
<p><code>-</code> <a href="https://gangcheol.github.io/ISLP2023/posts/2023-09-09-01.%20classification.html#classification">이론링크</a></p>
<section id="데이터-로드-및-탐색-6" class="level2">
<h2 class="anchored" data-anchor-id="데이터-로드-및-탐색-6">(1) 데이터 로드 및 탐색</h2>
<div class="cell" data-execution_count="100">
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb131-1"><a href="#cb131-1"></a><span class="co"># 데이터 읽어오기</span></span>
<span id="cb131-2"><a href="#cb131-2"></a>path <span class="op">=</span> <span class="st">'https://raw.githubusercontent.com/jangrae/csv/master/admission_simple.csv'</span></span>
<span id="cb131-3"><a href="#cb131-3"></a>data <span class="op">=</span> pd.read_csv(path)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="101">
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb132-1"><a href="#cb132-1"></a><span class="co"># 상위 몇 개 행 확인</span></span>
<span id="cb132-2"><a href="#cb132-2"></a>data.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="101">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">GRE</th>
<th data-quarto-table-cell-role="th">TOEFL</th>
<th data-quarto-table-cell-role="th">RANK</th>
<th data-quarto-table-cell-role="th">SOP</th>
<th data-quarto-table-cell-role="th">LOR</th>
<th data-quarto-table-cell-role="th">GPA</th>
<th data-quarto-table-cell-role="th">RESEARCH</th>
<th data-quarto-table-cell-role="th">ADMIT</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>337</td>
<td>118</td>
<td>4</td>
<td>4.5</td>
<td>4.5</td>
<td>9.65</td>
<td>1</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>324</td>
<td>107</td>
<td>4</td>
<td>4.0</td>
<td>4.5</td>
<td>8.87</td>
<td>1</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>316</td>
<td>104</td>
<td>3</td>
<td>3.0</td>
<td>3.5</td>
<td>8.00</td>
<td>1</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>322</td>
<td>110</td>
<td>3</td>
<td>3.5</td>
<td>2.5</td>
<td>8.67</td>
<td>1</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>314</td>
<td>103</td>
<td>2</td>
<td>2.0</td>
<td>3.0</td>
<td>8.21</td>
<td>0</td>
<td>0</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell" data-execution_count="102">
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb133-1"><a href="#cb133-1"></a><span class="co"># 기술통계 확인</span></span>
<span id="cb133-2"><a href="#cb133-2"></a>data.describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="102">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">GRE</th>
<th data-quarto-table-cell-role="th">TOEFL</th>
<th data-quarto-table-cell-role="th">RANK</th>
<th data-quarto-table-cell-role="th">SOP</th>
<th data-quarto-table-cell-role="th">LOR</th>
<th data-quarto-table-cell-role="th">GPA</th>
<th data-quarto-table-cell-role="th">RESEARCH</th>
<th data-quarto-table-cell-role="th">ADMIT</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">count</td>
<td>500.000000</td>
<td>500.000000</td>
<td>500.000000</td>
<td>500.000000</td>
<td>500.00000</td>
<td>500.000000</td>
<td>500.000000</td>
<td>500.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">mean</td>
<td>316.472000</td>
<td>107.192000</td>
<td>3.114000</td>
<td>3.374000</td>
<td>3.48400</td>
<td>8.576440</td>
<td>0.560000</td>
<td>0.436000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">std</td>
<td>11.295148</td>
<td>6.081868</td>
<td>1.143512</td>
<td>0.991004</td>
<td>0.92545</td>
<td>0.604813</td>
<td>0.496884</td>
<td>0.496384</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">min</td>
<td>290.000000</td>
<td>92.000000</td>
<td>1.000000</td>
<td>1.000000</td>
<td>1.00000</td>
<td>6.800000</td>
<td>0.000000</td>
<td>0.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">25%</td>
<td>308.000000</td>
<td>103.000000</td>
<td>2.000000</td>
<td>2.500000</td>
<td>3.00000</td>
<td>8.127500</td>
<td>0.000000</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">50%</td>
<td>317.000000</td>
<td>107.000000</td>
<td>3.000000</td>
<td>3.500000</td>
<td>3.50000</td>
<td>8.560000</td>
<td>1.000000</td>
<td>0.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">75%</td>
<td>325.000000</td>
<td>112.000000</td>
<td>4.000000</td>
<td>4.000000</td>
<td>4.00000</td>
<td>9.040000</td>
<td>1.000000</td>
<td>1.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">max</td>
<td>340.000000</td>
<td>120.000000</td>
<td>5.000000</td>
<td>5.000000</td>
<td>5.00000</td>
<td>9.920000</td>
<td>1.000000</td>
<td>1.000000</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell" data-execution_count="103">
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb134-1"><a href="#cb134-1"></a><span class="co"># 범주값 개수 확인</span></span>
<span id="cb134-2"><a href="#cb134-2"></a>data[<span class="st">'ADMIT'</span>].value_counts()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="103">
<pre><code>ADMIT
0    282
1    218
Name: count, dtype: int64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="104">
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb136-1"><a href="#cb136-1"></a><span class="co"># 상관관계 확인</span></span>
<span id="cb136-2"><a href="#cb136-2"></a>data.corr()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="104">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">GRE</th>
<th data-quarto-table-cell-role="th">TOEFL</th>
<th data-quarto-table-cell-role="th">RANK</th>
<th data-quarto-table-cell-role="th">SOP</th>
<th data-quarto-table-cell-role="th">LOR</th>
<th data-quarto-table-cell-role="th">GPA</th>
<th data-quarto-table-cell-role="th">RESEARCH</th>
<th data-quarto-table-cell-role="th">ADMIT</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">GRE</td>
<td>1.000000</td>
<td>0.827200</td>
<td>0.635376</td>
<td>0.613498</td>
<td>0.524679</td>
<td>0.825878</td>
<td>0.563398</td>
<td>0.701671</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">TOEFL</td>
<td>0.827200</td>
<td>1.000000</td>
<td>0.649799</td>
<td>0.644410</td>
<td>0.541563</td>
<td>0.810574</td>
<td>0.467012</td>
<td>0.680503</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">RANK</td>
<td>0.635376</td>
<td>0.649799</td>
<td>1.000000</td>
<td>0.728024</td>
<td>0.608651</td>
<td>0.705254</td>
<td>0.427047</td>
<td>0.618367</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">SOP</td>
<td>0.613498</td>
<td>0.644410</td>
<td>0.728024</td>
<td>1.000000</td>
<td>0.663707</td>
<td>0.712154</td>
<td>0.408116</td>
<td>0.606876</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">LOR</td>
<td>0.524679</td>
<td>0.541563</td>
<td>0.608651</td>
<td>0.663707</td>
<td>1.000000</td>
<td>0.637469</td>
<td>0.372526</td>
<td>0.536527</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">GPA</td>
<td>0.825878</td>
<td>0.810574</td>
<td>0.705254</td>
<td>0.712154</td>
<td>0.637469</td>
<td>1.000000</td>
<td>0.501311</td>
<td>0.752196</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">RESEARCH</td>
<td>0.563398</td>
<td>0.467012</td>
<td>0.427047</td>
<td>0.408116</td>
<td>0.372526</td>
<td>0.501311</td>
<td>1.000000</td>
<td>0.503104</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">ADMIT</td>
<td>0.701671</td>
<td>0.680503</td>
<td>0.618367</td>
<td>0.606876</td>
<td>0.536527</td>
<td>0.752196</td>
<td>0.503104</td>
<td>1.000000</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="데이터-준비-1" class="level2">
<h2 class="anchored" data-anchor-id="데이터-준비-1">(2) 데이터 준비</h2>
<div class="cell" data-execution_count="105">
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb137-1"><a href="#cb137-1"></a><span class="co"># target 확인</span></span>
<span id="cb137-2"><a href="#cb137-2"></a>target <span class="op">=</span> <span class="st">'ADMIT'</span></span>
<span id="cb137-3"><a href="#cb137-3"></a></span>
<span id="cb137-4"><a href="#cb137-4"></a><span class="co"># 데이터 분리</span></span>
<span id="cb137-5"><a href="#cb137-5"></a>x <span class="op">=</span> data.drop(target, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb137-6"><a href="#cb137-6"></a>y <span class="op">=</span> data.loc[:, target]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="106">
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb138-1"><a href="#cb138-1"></a><span class="co"># 모듈 불러오기</span></span>
<span id="cb138-2"><a href="#cb138-2"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb138-3"><a href="#cb138-3"></a></span>
<span id="cb138-4"><a href="#cb138-4"></a><span class="co"># 7:3으로 분리</span></span>
<span id="cb138-5"><a href="#cb138-5"></a>x_train, x_test, y_train, y_test <span class="op">=</span> train_test_split(x, y, test_size<span class="op">=</span><span class="fl">0.3</span>, random_state<span class="op">=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="모델링-9" class="level2">
<h2 class="anchored" data-anchor-id="모델링-9">(3) 모델링</h2>
<div class="cell" data-execution_count="107">
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb139-1"><a href="#cb139-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> LogisticRegression</span>
<span id="cb139-2"><a href="#cb139-2"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> accuracy_score, recall_score, precision_score, f1_score</span>
<span id="cb139-3"><a href="#cb139-3"></a></span>
<span id="cb139-4"><a href="#cb139-4"></a><span class="co"># step1. model 선언</span></span>
<span id="cb139-5"><a href="#cb139-5"></a>model  <span class="op">=</span> LogisticRegression()</span>
<span id="cb139-6"><a href="#cb139-6"></a></span>
<span id="cb139-7"><a href="#cb139-7"></a><span class="co"># step2. fit</span></span>
<span id="cb139-8"><a href="#cb139-8"></a>model.fit(x_train, y_train)</span>
<span id="cb139-9"><a href="#cb139-9"></a></span>
<span id="cb139-10"><a href="#cb139-10"></a><span class="co"># step3 . 얘측</span></span>
<span id="cb139-11"><a href="#cb139-11"></a>y_pred <span class="op">=</span> model.predict(x_test)</span>
<span id="cb139-12"><a href="#cb139-12"></a></span>
<span id="cb139-13"><a href="#cb139-13"></a><span class="co"># step 4. 성능 지표 산출</span></span>
<span id="cb139-14"><a href="#cb139-14"></a>acc, pre, recall, f1_score <span class="op">=</span> accuracy_score(y_test, y_pred), precision_score(y_test, y_pred), recall_score(y_test, y_pred), f1_score(y_test, y_pred)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="108">
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb140-1"><a href="#cb140-1"></a>score(<span class="bu">range</span> <span class="op">=</span> [<span class="fl">0.7</span>, <span class="fl">0.87</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<div>                            <div id="bac9c287-26f6-4b5b-8aaa-9596fd0be70e" class="plotly-graph-div" style="height:500px; width:600px;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("bac9c287-26f6-4b5b-8aaa-9596fd0be70e")) {                    Plotly.newPlot(                        "bac9c287-26f6-4b5b-8aaa-9596fd0be70e",                        [{"alignmentgroup":"True","hovertemplate":"measure=%{x}\u003cbr\u003escore=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"acc","marker":{"color":"#636efa","pattern":{"shape":""}},"name":"acc","offsetgroup":"acc","orientation":"v","showlegend":true,"textposition":"auto","x":["acc"],"xaxis":"x","y":[0.8466666666666667],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","hovertemplate":"measure=%{x}\u003cbr\u003escore=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"precision","marker":{"color":"#EF553B","pattern":{"shape":""}},"name":"precision","offsetgroup":"precision","orientation":"v","showlegend":true,"textposition":"auto","x":["precision"],"xaxis":"x","y":[0.8524590163934426],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","hovertemplate":"measure=%{x}\u003cbr\u003escore=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"recall","marker":{"color":"#00cc96","pattern":{"shape":""}},"name":"recall","offsetgroup":"recall","orientation":"v","showlegend":true,"textposition":"auto","x":["recall"],"xaxis":"x","y":[0.7878787878787878],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","hovertemplate":"measure=%{x}\u003cbr\u003escore=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"f1_score","marker":{"color":"#ab63fa","pattern":{"shape":""}},"name":"f1_score","offsetgroup":"f1_score","orientation":"v","showlegend":true,"textposition":"auto","x":["f1_score"],"xaxis":"x","y":[0.8188976377952757],"yaxis":"y","type":"bar"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"measure"},"categoryorder":"array","categoryarray":["acc","precision","recall","f1_score"]},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"score"},"range":[0.7,0.87]},"legend":{"title":{"text":"measure"},"tracegroupgap":0},"margin":{"t":60},"barmode":"relative","height":500,"width":600},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('bac9c287-26f6-4b5b-8aaa-9596fd0be70e');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
</section>
<section id="extra-확률값-구한-후-결과-계산" class="level2">
<h2 class="anchored" data-anchor-id="extra-확률값-구한-후-결과-계산">(4) extra : 확률값 구한 후 결과 계산</h2>
<div class="cell" data-execution_count="109">
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb141-1"><a href="#cb141-1"></a>p <span class="op">=</span> model.predict_proba(x_test)</span>
<span id="cb141-2"><a href="#cb141-2"></a></span>
<span id="cb141-3"><a href="#cb141-3"></a>my_pred <span class="op">=</span> [<span class="dv">1</span> <span class="cf">if</span> x <span class="op">&gt;</span> <span class="fl">0.5</span> <span class="cf">else</span> <span class="dv">0</span> <span class="cf">for</span> x <span class="kw">in</span> p[:,<span class="dv">1</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../../../posts/DX/04. 머신러닝/2023-09-12-01. 머신러닝 (1).html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">01. 머신러닝 (1)</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../../../posts/DX/04. 머신러닝/2023-09-14-03. 머신러닝 (3).html" class="pagination-link">
        <span class="nav-page-text">03. 머신러닝 (3)</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>