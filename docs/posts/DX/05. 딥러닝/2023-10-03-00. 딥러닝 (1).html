<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.433">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="GC">
<meta name="dcterms.date" content="2023-10-03">

<title>Gangcheol - 00. 딥러닝 (1)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../">
<link href="../../../posts/DX/05. 딥러닝/2023-10-04-01. 딥러닝 (2).html" rel="next">
<link href="../../../posts/DX/04. 머신러닝/2023-09-28-08. summary (1).html" rel="prev">
<script src="../../../site_libs/quarto-html/quarto.js"></script>
<script src="../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../../../styles.css">
</head>

<body class="nav-sidebar docked nav-fixed">


<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../../index.html">
    <span class="navbar-title">Gangcheol</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="https://gangcheol.github.io/mysite/" rel="" target="">
 <span class="menu-text">Lecture</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://gangcheol.github.io/TI2023/" rel="" target="">
 <span class="menu-text">Tableau</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://gangcheol.github.io/mysite2/" rel="" target="">
 <span class="menu-text">DX</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://gangcheol.github.io/IA2023/" rel="" target="">
 <span class="menu-text">IA2023</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://gangcheol.github.io/ISLP2023/" rel="" target="">
 <span class="menu-text">ISLP2023</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/gangcheol/" rel="" target=""><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">Posts</li><li class="breadcrumb-item"><a href="../../../posts/DX/2023-07-31-00.intro.html">DX</a></li><li class="breadcrumb-item"><a href="../../../posts/DX/05. 딥러닝/2023-10-03-00. 딥러닝 (1).html">05. 딥러닝</a></li><li class="breadcrumb-item"><a href="../../../posts/DX/05. 딥러닝/2023-10-03-00. 딥러닝 (1).html">00. 딥러닝 (1)</a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">00. 딥러닝 (1)</h1>
                                <div class="quarto-categories">
                <div class="quarto-category">딥러닝</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>GC </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">October 3, 2023</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation docked overflow-auto">
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../about.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><strong>About Me</strong></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Posts</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">DX</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth2 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/2023-07-31-00.intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">00. Intro &amp; setting</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/2023-08-19-01. Plotly test.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">01. Plotly test</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/2023-10-26-02. BERTopic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">02. BERTopic</span></a>
  </div>
</li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false">
 <span class="menu-text">00. 데이터 다루기</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth3 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/00. 데이터 다루기/2023-08-09-00. Python Basic (1).html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">00. Python Basic (1)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/00. 데이터 다루기/2023-08-10-01. Python Basic (2) .html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">01. Python Basic (2)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/00. 데이터 다루기/2023-08-11-02. Python Basic (3) .html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">02. Python Basic (3)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/00. 데이터 다루기/2023-08-14-03. Python Basic (4).html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">03. Python Basic (4)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/00. 데이터 다루기/2023-08-16-04. Python Basic (5).html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">04. Python Basic (5)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/00. 데이터 다루기/2023-08-17-05. Python Basic (6).html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">05. Python Basic (6)</span></a>
  </div>
</li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="false">
 <span class="menu-text">Extra</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth4 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/00. 데이터 다루기/extra/2023-08-08-Extra 00. 밈.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Extra 00. 밈</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/00. 데이터 다루기/extra/2023-08-09-Extra 01. 클래스.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Extra 01. 클래스</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/00. 데이터 다루기/extra/2023-08-10-Extra 02. 클래스 탐구 (1).html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Extra 02. 클래스 탐구 (1)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/00. 데이터 다루기/extra/2023-08-14-Extra 03. 클래스 탐구 (2).html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Extra 03. 클래스 탐구 (2)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/00. 데이터 다루기/extra/2023-08-15-Extra 04. 클래스 탐구 (3).html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Extra 04. 클래스 탐구 (3)</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="false">
 <span class="menu-text">01. 데이터 다듬기</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth3 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/01. 데이터 다듬기/2023-08-18-00. numpy &amp; pandas (1).html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">00. numpy &amp; pandas (1)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/01. 데이터 다듬기/2023-08-18-01. numpy &amp; pandas (2).html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">01. numpy &amp; pandas (2)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/01. 데이터 다듬기/2023-08-21-02. numpy &amp; pandas (3).html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">02. numpy &amp; pandas (3)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/01. 데이터 다듬기/2023-08-22-03. numpy &amp; pandas (4).html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">03. numpy &amp; pandas (4)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/01. 데이터 다듬기/2023-08-23-04. numpy &amp; pandas (5).html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">04. numpy &amp; pandas (5)</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="false">
 <span class="menu-text">02. 데이터 분석</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth3 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/02. 데이터 분석/2023-08-28-00. 데이터 분석 (1).html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">00. 데이터 분석 (1)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/02. 데이터 분석/2023-08-29-01. 데이터 분석 (2).html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">01. 데이터 분석 (2)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/02. 데이터 분석/2023-09-01-02. 데이터 분석 (2).html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">02. 데이터 분석 (3)</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="false">
 <span class="menu-text">03. 데이터 수집</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth3 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/03. 데이터 수집/2023-09-04-00. 데이터 수집 (1).html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">00. 데이터 수집 (1)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/03. 데이터 수집/2023-09-05-01. 데이터 수집 (2).html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">01. 데이터 수집 (2)</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="false">
 <span class="menu-text">04. 머신러닝</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth3 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/04. 머신러닝/2023-09-11-00. intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">00. Intro</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/04. 머신러닝/2023-09-12-01. 머신러닝 (1).html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">01. 머신러닝 (1)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/04. 머신러닝/2023-09-13-02. 머신러닝 (2).html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">02. 머신러닝 (2)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/04. 머신러닝/2023-09-14-03. 머신러닝 (3).html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">03. 머신러닝 (3)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/04. 머신러닝/2023-09-15-04. 머신러닝 (4).html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">04. 머신러닝 (4)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/04. 머신러닝/2023-09-15-05. 종합실습.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">05. 종합실습</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/04. 머신러닝/2023-09-18-06. 머신러닝 (5).html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">06. 머신러닝 (5)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/04. 머신러닝/2023-09-19-07. 머신러닝 (6).html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">07. 머신러닝 (6)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/04. 머신러닝/2023-09-28-08. summary (1).html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">08. summary (1)</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" aria-expanded="true">
 <span class="menu-text">05. 딥러닝</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth3 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/05. 딥러닝/2023-10-03-00. 딥러닝 (1).html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">00. 딥러닝 (1)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/05. 딥러닝/2023-10-04-01. 딥러닝 (2).html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">01. 딥러닝 (2)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/05. 딥러닝/2023-10-05-02. 딥러닝 (3).html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">02. 딥러닝 (3)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/05. 딥러닝/2023-10-06-03. 딥러닝 (4).html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">03. 딥러닝 (4)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/05. 딥러닝/2023-10-10-Extra 01. 언어지능 (1).html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Extra 01. 언어지능</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/05. 딥러닝/2023-10-11-Extra 02. 시각지능.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Extra 02. 시각지능</span></a>
  </div>
</li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" aria-expanded="false">
 <span class="menu-text">Summary</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-10" class="collapse list-unstyled sidebar-section depth4 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/05. 딥러닝/summary/2023-10-18-summary 01. RNN.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">summary 01. RNN</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/05. 딥러닝/summary/2023-10-18-summary 02. LSTM.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">summary 02. LSTM</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/05. 딥러닝/summary/2023-10-18-summary 03. transformer.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">summary 03. Transformer</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" aria-expanded="false">
 <span class="menu-text">06. 데이터분석표현</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-11" class="collapse list-unstyled sidebar-section depth3 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/06. 데이터분석표현/2023-10-23-00. streamlit.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">00. streamlit</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-12" aria-expanded="false">
 <span class="menu-text">07. IT 인프라</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-12" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-12" class="collapse list-unstyled sidebar-section depth3 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/07. IT 인프라/2023-11-06-00. IT 인프라 (1).html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">00. IT 인프라 (1)</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-13" aria-expanded="false">
 <span class="menu-text">09. 제안전략수립</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-13" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-13" class="collapse list-unstyled sidebar-section depth3 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/09. 제안전략수립/2023-11-23-00. 제안전략수립.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">00. 제안전략수립</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/09. 제안전략수립/2023-11-24-01. 환경분석 기법의 이해.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">01. 환경분석 기법의 이해</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/09. 제안전략수립/2023-11-27-02. 고객가치정의 및 아이디어 도출.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">02. 고객가치정의 및 아이디어 도출</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/09. 제안전략수립/2023-11-28-03. 실행계획 수립.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">03. 실행계획 수립</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-14" aria-expanded="false">
 <span class="menu-text">MP</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-14" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-14" class="collapse list-unstyled sidebar-section depth3 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/MP/2023-08-24-00. MP (1).html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">00. MP (1)</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-15" aria-expanded="false">
 <span class="menu-text">EX</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-15" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-15" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/EX/2023-10-30-00. Churn.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">00. Churn</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/EX/2023-10-31-01. VOC.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">01. VOC</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/EX/2023-11-01-02. iris.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">02. iris</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/EX/2023-11-01-03. Titanic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">03. Titanic</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#import" id="toc-import" class="nav-link active" data-scroll-target="#import">import</a></li>
  <li><a href="#데이터-준비-및-이해" id="toc-데이터-준비-및-이해" class="nav-link" data-scroll-target="#데이터-준비-및-이해">데이터 준비 및 이해</a></li>
  <li><a href="#ml-review-linear-regreesion" id="toc-ml-review-linear-regreesion" class="nav-link" data-scroll-target="#ml-review-linear-regreesion">ML review : linear regreesion</a></li>
  <li><a href="#딥러닝-모델링" id="toc-딥러닝-모델링" class="nav-link" data-scroll-target="#딥러닝-모델링">딥러닝 모델링</a>
  <ul class="collapse">
  <li><a href="#전처리" id="toc-전처리" class="nav-link" data-scroll-target="#전처리">(1) 전처리</a></li>
  <li><a href="#import-1" id="toc-import-1" class="nav-link" data-scroll-target="#import-1">(2) import</a></li>
  <li><a href="#모델-선언" id="toc-모델-선언" class="nav-link" data-scroll-target="#모델-선언">(3) 모델 선언</a></li>
  <li><a href="#exercise-1.-carseat-회귀" id="toc-exercise-1.-carseat-회귀" class="nav-link" data-scroll-target="#exercise-1.-carseat-회귀">exercise 1. Carseat (회귀)</a>
  <ul class="collapse">
  <li><a href="#데이터-준비-및-이해-1" id="toc-데이터-준비-및-이해-1" class="nav-link" data-scroll-target="#데이터-준비-및-이해-1">(1) 데이터 준비 및 이해</a></li>
  <li><a href="#모델링" id="toc-모델링" class="nav-link" data-scroll-target="#모델링">(2) 모델링</a></li>
  </ul></li>
  <li><a href="#excercise-2.-mobile-분류" id="toc-excercise-2.-mobile-분류" class="nav-link" data-scroll-target="#excercise-2.-mobile-분류">excercise 2. mobile (분류)</a>
  <ul class="collapse">
  <li><a href="#데이터-이해-및-준비" id="toc-데이터-이해-및-준비" class="nav-link" data-scroll-target="#데이터-이해-및-준비">(1) 데이터 이해 및 준비</a></li>
  <li><a href="#모델링-1" id="toc-모델링-1" class="nav-link" data-scroll-target="#모델링-1">(2) 모델링</a></li>
  <li><a href="#summary" id="toc-summary" class="nav-link" data-scroll-target="#summary">summary</a></li>
  </ul></li>
  <li><a href="#excercise-3.-boston-회귀" id="toc-excercise-3.-boston-회귀" class="nav-link" data-scroll-target="#excercise-3.-boston-회귀">excercise 3. Boston (회귀)</a>
  <ul class="collapse">
  <li><a href="#데이터-이해-및-준비-1" id="toc-데이터-이해-및-준비-1" class="nav-link" data-scroll-target="#데이터-이해-및-준비-1">(1) 데이터 이해 및 준비</a></li>
  <li><a href="#모델링-2" id="toc-모델링-2" class="nav-link" data-scroll-target="#모델링-2">(2) 모델링</a></li>
  <li><a href="#summary-1" id="toc-summary-1" class="nav-link" data-scroll-target="#summary-1">(3) summary</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<section id="import" class="level1">
<h1>import</h1>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:2,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1696306138587,&quot;user&quot;:{&quot;displayName&quot;:&quot;ccc flkwerkdai&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-execution_count="65">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb1-5"><a href="#cb1-5"></a></span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb1-7"><a href="#cb1-7"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> <span class="op">*</span></span>
<span id="cb1-8"><a href="#cb1-8"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> StandardScaler, MinMaxScaler</span>
<span id="cb1-9"><a href="#cb1-9"></a></span>
<span id="cb1-10"><a href="#cb1-10"></a><span class="im">from</span> keras.models <span class="im">import</span> Sequential</span>
<span id="cb1-11"><a href="#cb1-11"></a><span class="im">from</span> keras.layers <span class="im">import</span> Dense</span>
<span id="cb1-12"><a href="#cb1-12"></a><span class="im">from</span> keras.backend <span class="im">import</span> clear_session</span>
<span id="cb1-13"><a href="#cb1-13"></a></span>
<span id="cb1-14"><a href="#cb1-14"></a><span class="im">import</span> plotly.express <span class="im">as</span> px</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="데이터-준비-및-이해" class="level1">
<h1>데이터 준비 및 이해</h1>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:487,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1696304595835,&quot;user&quot;:{&quot;displayName&quot;:&quot;ccc flkwerkdai&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-execution_count="6">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1"></a>path <span class="op">=</span> <span class="st">'https://raw.githubusercontent.com/DA4BAM/dataset/master/advertising.csv'</span></span>
<span id="cb2-2"><a href="#cb2-2"></a>adv <span class="op">=</span> pd.read_csv(path)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:5,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1696304666236,&quot;user&quot;:{&quot;displayName&quot;:&quot;ccc flkwerkdai&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-outputid="a85fd9fe-f582-4ff5-e0a2-c9c417b6dd9e" data-execution_count="9">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1"></a>adv.info()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 200 entries, 0 to 199
Data columns (total 4 columns):
 #   Column     Non-Null Count  Dtype  
---  ------     --------------  -----  
 0   TV         200 non-null    float64
 1   Radio      200 non-null    float64
 2   Newspaper  200 non-null    float64
 3   Sales      200 non-null    float64
dtypes: float64(4)
memory usage: 6.4 KB</code></pre>
</div>
</div>
<p><code>-</code> 모든 feature들이 연속형 변수로 가변수화는 필요없다.</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:3,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1696304671841,&quot;user&quot;:{&quot;displayName&quot;:&quot;ccc flkwerkdai&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-outputid="130bd30e-e5f4-43f4-95a8-6ce0b3c74143" data-execution_count="10">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1"></a>adv.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="10">

  <div id="df-c377e7e8-4c48-4f99-82a2-30b164145018" class="colab-df-container">
    <div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">TV</th>
<th data-quarto-table-cell-role="th">Radio</th>
<th data-quarto-table-cell-role="th">Newspaper</th>
<th data-quarto-table-cell-role="th">Sales</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>230.1</td>
<td>37.8</td>
<td>69.2</td>
<td>22.1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>44.5</td>
<td>39.3</td>
<td>45.1</td>
<td>10.4</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>17.2</td>
<td>45.9</td>
<td>69.3</td>
<td>9.3</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>151.5</td>
<td>41.3</td>
<td>58.5</td>
<td>18.5</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>180.8</td>
<td>10.8</td>
<td>58.4</td>
<td>12.9</td>
</tr>
</tbody>
</table>


</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-c377e7e8-4c48-4f99-82a2-30b164145018')" title="Convert this dataframe to an interactive table." style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"></path>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-c377e7e8-4c48-4f99-82a2-30b164145018 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-c377e7e8-4c48-4f99-82a2-30b164145018');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-48dbeecc-ce77-40dd-9a1c-52a4ffa458f6">
  <button class="colab-df-quickchart" onclick="quickchart('df-48dbeecc-ce77-40dd-9a1c-52a4ffa458f6')" title="Suggest charts." style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"></path>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-48dbeecc-ce77-40dd-9a1c-52a4ffa458f6 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div>
</div>
<p><code>-</code> x,y 분리</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:1,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1696304645834,&quot;user&quot;:{&quot;displayName&quot;:&quot;ccc flkwerkdai&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-execution_count="7">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1"></a>target <span class="op">=</span> <span class="st">"Sales"</span></span>
<span id="cb6-2"><a href="#cb6-2"></a></span>
<span id="cb6-3"><a href="#cb6-3"></a>x <span class="op">=</span> adv.drop(target, axis <span class="op">=</span> <span class="dv">1</span>)</span>
<span id="cb6-4"><a href="#cb6-4"></a>y <span class="op">=</span> adv[target]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="ml-review-linear-regreesion" class="level1">
<h1>ML review : linear regreesion</h1>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:1,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1696304734047,&quot;user&quot;:{&quot;displayName&quot;:&quot;ccc flkwerkdai&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-execution_count="11">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> LinearRegression</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><code>-</code> 전과정은 이제 한번에 쓰자.</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:3,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1696304919413,&quot;user&quot;:{&quot;displayName&quot;:&quot;ccc flkwerkdai&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-execution_count="14">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1"></a><span class="co"># step 0. 데이터 셋 분할</span></span>
<span id="cb8-2"><a href="#cb8-2"></a>x_train, x_test, y_train, y_test <span class="op">=</span> train_test_split(x, y, test_size <span class="op">=</span> <span class="fl">0.3</span>, random_state <span class="op">=</span> <span class="dv">2023</span>)</span>
<span id="cb8-3"><a href="#cb8-3"></a></span>
<span id="cb8-4"><a href="#cb8-4"></a><span class="co"># step 1. 모델 선언</span></span>
<span id="cb8-5"><a href="#cb8-5"></a>lm <span class="op">=</span> LinearRegression()</span>
<span id="cb8-6"><a href="#cb8-6"></a></span>
<span id="cb8-7"><a href="#cb8-7"></a><span class="co"># step 2. 모델 fit</span></span>
<span id="cb8-8"><a href="#cb8-8"></a>lm.fit(x_train, y_train)</span>
<span id="cb8-9"><a href="#cb8-9"></a></span>
<span id="cb8-10"><a href="#cb8-10"></a><span class="co"># step 3. 모델 predict</span></span>
<span id="cb8-11"><a href="#cb8-11"></a>lm.pred <span class="op">=</span> lm.predict(x_test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><code>-</code> 결과 요약</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:4,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1696304994554,&quot;user&quot;:{&quot;displayName&quot;:&quot;ccc flkwerkdai&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-outputid="6fa77536-271a-431e-ca90-5608a8466364" data-execution_count="19">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1"></a>np.mean(y_test), np.mean(lm.pred)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="19">
<pre><code>(13.871666666666668, 14.059021420299166)</code></pre>
</div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:2,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1696304997603,&quot;user&quot;:{&quot;displayName&quot;:&quot;ccc flkwerkdai&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-outputid="ac48beb5-8b97-4072-9850-bac1022f8219" data-execution_count="20">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1"></a>np.mean((y_test<span class="op">-</span>lm.pred)<span class="op">**</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="20">
<pre><code>2.417343095034177</code></pre>
</div>
</div>
<p><code>-</code> 결과 시각화</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:6,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1696305439723,&quot;user&quot;:{&quot;displayName&quot;:&quot;ccc flkwerkdai&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-outputid="9d19cea5-6665-4882-81ee-34acd61a33e3" data-execution_count="44">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1"></a>x_test <span class="op">=</span> x_test.reset_index(drop<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb13-2"><a href="#cb13-2"></a>y_test <span class="op">=</span> y_test.reset_index(drop<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb13-3"><a href="#cb13-3"></a></span>
<span id="cb13-4"><a href="#cb13-4"></a>lm.pred_data <span class="op">=</span> pd.concat([x_test,y_test], axis<span class="op">=</span> <span class="dv">1</span>)</span>
<span id="cb13-5"><a href="#cb13-5"></a></span>
<span id="cb13-6"><a href="#cb13-6"></a>lm.pred_data[<span class="st">"Sales_pred"</span>] <span class="op">=</span> lm.pred</span>
<span id="cb13-7"><a href="#cb13-7"></a>lm.pred_data.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="44">

  <div id="df-77281207-47f0-4dce-b001-e2218901a454" class="colab-df-container">
    <div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">TV</th>
<th data-quarto-table-cell-role="th">Radio</th>
<th data-quarto-table-cell-role="th">Newspaper</th>
<th data-quarto-table-cell-role="th">Sales</th>
<th data-quarto-table-cell-role="th">Sales_pred</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>97.5</td>
<td>7.6</td>
<td>7.2</td>
<td>9.7</td>
<td>8.882060</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>286.0</td>
<td>13.9</td>
<td>3.7</td>
<td>15.9</td>
<td>19.000003</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>197.6</td>
<td>3.5</td>
<td>5.9</td>
<td>11.7</td>
<td>12.871302</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>224.0</td>
<td>2.4</td>
<td>15.6</td>
<td>11.6</td>
<td>13.893769</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>193.2</td>
<td>18.4</td>
<td>65.7</td>
<td>15.2</td>
<td>15.273020</td>
</tr>
</tbody>
</table>


</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-77281207-47f0-4dce-b001-e2218901a454')" title="Convert this dataframe to an interactive table." style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"></path>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-77281207-47f0-4dce-b001-e2218901a454 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-77281207-47f0-4dce-b001-e2218901a454');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-323efdd9-5f19-478f-ab30-98dac6124cc0">
  <button class="colab-df-quickchart" onclick="quickchart('df-323efdd9-5f19-478f-ab30-98dac6124cc0')" title="Suggest charts." style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"></path>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-323efdd9-5f19-478f-ab30-98dac6124cc0 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:790,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1696306131777,&quot;user&quot;:{&quot;displayName&quot;:&quot;ccc flkwerkdai&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-outputid="0b6c0b3a-01da-4b99-f426-a2cfffc910d6" data-execution_count="64">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1"></a>fig, axes <span class="op">=</span> plt.subplots(<span class="dv">1</span>,<span class="dv">3</span>, figsize <span class="op">=</span>(<span class="dv">12</span>,<span class="dv">4</span>))</span>
<span id="cb14-2"><a href="#cb14-2"></a></span>
<span id="cb14-3"><a href="#cb14-3"></a>x_col <span class="op">=</span> lm.pred_data.columns[<span class="dv">0</span>:<span class="dv">3</span>].tolist()</span>
<span id="cb14-4"><a href="#cb14-4"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">3</span>) :</span>
<span id="cb14-5"><a href="#cb14-5"></a>    axes[i].plot(lm.pred_data[x_col[i]], y_test, <span class="st">".r"</span>, label <span class="op">=</span> <span class="vs">r"$(x,y)$"</span>,alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb14-6"><a href="#cb14-6"></a>    axes[i].plot(lm.pred_data[x_col[i]], lm.pred, <span class="st">".b"</span>, label <span class="op">=</span> <span class="vs">r"$(x,\hat y)$"</span>)</span>
<span id="cb14-7"><a href="#cb14-7"></a>    axes[i].set_title(x_col[i] <span class="op">+</span> <span class="st">", Sales"</span>)</span>
<span id="cb14-8"><a href="#cb14-8"></a>    axes[i].legend()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="2023-10-03-00. 딥러닝 (1)_files/figure-html/cell-12-output-1.png" class="img-fluid"></p>
</div>
</div>
<p><code>-</code> 결과 요약</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:5,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1696306195219,&quot;user&quot;:{&quot;displayName&quot;:&quot;ccc flkwerkdai&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-outputid="39e0f2ac-e959-4e05-8730-b45c03fea681" data-execution_count="66">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1"></a><span class="bu">print</span>(<span class="ss">f'RMSE  : </span><span class="sc">{</span>mean_squared_error(y_test, lm.pred, squared<span class="op">=</span><span class="va">False</span>)<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb15-2"><a href="#cb15-2"></a><span class="bu">print</span>(<span class="ss">f'MAE   : </span><span class="sc">{</span>mean_absolute_error(y_test, lm.pred)<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb15-3"><a href="#cb15-3"></a><span class="bu">print</span>(<span class="ss">f'MAPE  : </span><span class="sc">{</span>mean_absolute_percentage_error(y_test, lm.pred)<span class="sc">}</span><span class="ss">'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>RMSE  : 1.5547807224924604
MAE   : 1.2573619368638342
MAPE  : 0.11717490489730135</code></pre>
</div>
</div>
<hr>
</section>
<section id="딥러닝-모델링" class="level1">
<h1>딥러닝 모델링</h1>
<section id="전처리" class="level2">
<h2 class="anchored" data-anchor-id="전처리">(1) 전처리</h2>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:2,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1696306274989,&quot;user&quot;:{&quot;displayName&quot;:&quot;ccc flkwerkdai&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-execution_count="68">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1"></a>scaler <span class="op">=</span> MinMaxScaler()</span>
<span id="cb17-2"><a href="#cb17-2"></a>x_train <span class="op">=</span> scaler.fit_transform(x_train)</span>
<span id="cb17-3"><a href="#cb17-3"></a>x_test <span class="op">=</span> scaler.fit_transform(x_test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="import-1" class="level2">
<h2 class="anchored" data-anchor-id="import-1">(2) import</h2>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:2,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1696306291356,&quot;user&quot;:{&quot;displayName&quot;:&quot;ccc flkwerkdai&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-execution_count="69">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1"></a><span class="im">from</span> keras.models <span class="im">import</span> Sequential</span>
<span id="cb18-2"><a href="#cb18-2"></a><span class="im">from</span> keras.layers <span class="im">import</span> Dense</span>
<span id="cb18-3"><a href="#cb18-3"></a><span class="im">from</span> keras.backend <span class="im">import</span> clear_session</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="모델-선언" class="level2">
<h2 class="anchored" data-anchor-id="모델-선언">(3) 모델 선언</h2>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:2,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1696306319694,&quot;user&quot;:{&quot;displayName&quot;:&quot;ccc flkwerkdai&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-execution_count="70">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1"></a>n_features <span class="op">=</span> x_train.shape[<span class="dv">1</span>] <span class="co">## 컬럼 개수</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:3501,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1696306377925,&quot;user&quot;:{&quot;displayName&quot;:&quot;ccc flkwerkdai&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-outputid="ab5b631a-2e37-4170-b161-3c5a2ebd24c8" data-execution_count="71">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1"></a><span class="co"># 메모리 정리</span></span>
<span id="cb20-2"><a href="#cb20-2"></a>clear_session()</span>
<span id="cb20-3"><a href="#cb20-3"></a></span>
<span id="cb20-4"><a href="#cb20-4"></a><span class="co"># Sequential 타입 모델 선언</span></span>
<span id="cb20-5"><a href="#cb20-5"></a>model <span class="op">=</span> Sequential(Dense(<span class="dv">1</span>, input_shape <span class="op">=</span> (n_features,)))</span>
<span id="cb20-6"><a href="#cb20-6"></a></span>
<span id="cb20-7"><a href="#cb20-7"></a>model.summary()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Model: "sequential"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 dense (Dense)               (None, 1)                 4         
                                                                 
=================================================================
Total params: 4 (16.00 Byte)
Trainable params: 4 (16.00 Byte)
Non-trainable params: 0 (0.00 Byte)
_________________________________________________________________</code></pre>
</div>
</div>
<p><code>-</code> 초기 셋팅된 파라미터 값을 살펴보자.</p>
<ul>
<li>일단 아래와 같은 값으로 기본 셋팅이 되어있다…</li>
</ul>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:3,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1696307425988,&quot;user&quot;:{&quot;displayName&quot;:&quot;ccc flkwerkdai&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-outputid="22390dd2-f419-446c-dcc8-1df6ea83c099" data-execution_count="134">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1"></a>model.weights</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="134">
<pre><code>[&lt;tf.Variable 'dense/kernel:0' shape=(3, 1) dtype=float32, numpy=
 array([[ 0.21143973],
        [-0.36714107],
        [ 1.0211834 ]], dtype=float32)&gt;,
 &lt;tf.Variable 'dense/bias:0' shape=(1,) dtype=float32, numpy=array([0.], dtype=float32)&gt;]</code></pre>
</div>
</div>
<p><code>-</code> 일단 초기셋팅한값으로 test data를 적합시 얼만큼 잘 예측하는지 시각화 해보자..</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:2,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1696307156330,&quot;user&quot;:{&quot;displayName&quot;:&quot;ccc flkwerkdai&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-execution_count="109">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1"></a><span class="im">import</span> tensorflow.experimental.numpy <span class="im">as</span> tnp</span>
<span id="cb24-2"><a href="#cb24-2"></a>tnp.experimental_enable_numpy_behavior() <span class="co">## tnf 를 numpy 처럼 사용할 수 있도록 해줌</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><code>-</code> 일단 <span class="math inline">\(X\)</span>를 우리가 잘 알고 있는 회귀 분석 형태로 바꿔주고 <span class="math inline">\(y_{init}\)</span>를 예측</p>
<p><span class="math display">\[\bf \hat {y}_{init} = X \bf{\hat {\beta}_{init}}\]</span></p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:2,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1696307485720,&quot;user&quot;:{&quot;displayName&quot;:&quot;ccc flkwerkdai&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-execution_count="138">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1"></a>w_init <span class="op">=</span> np.concatenate([tnp.array(model.weights[<span class="dv">1</span>]).reshape(<span class="dv">1</span>,<span class="dv">1</span>),</span>
<span id="cb25-2"><a href="#cb25-2"></a>                         tnp.array(model.weights[<span class="dv">0</span>])],axis <span class="op">=</span> <span class="dv">0</span>)</span>
<span id="cb25-3"><a href="#cb25-3"></a></span>
<span id="cb25-4"><a href="#cb25-4"></a>x_test_matrix <span class="op">=</span> np.concatenate([np.ones(x_test.shape[<span class="dv">0</span>]).reshape(<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>),</span>
<span id="cb25-5"><a href="#cb25-5"></a>                                 x_test],axis <span class="op">=</span> <span class="dv">1</span>)</span>
<span id="cb25-6"><a href="#cb25-6"></a></span>
<span id="cb25-7"><a href="#cb25-7"></a>y_pred_init <span class="op">=</span> x_test_matrix <span class="op">@</span> w_init</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:3,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1696307490367,&quot;user&quot;:{&quot;displayName&quot;:&quot;ccc flkwerkdai&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-execution_count="139">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1"></a>y_pred_init <span class="op">=</span> x_test_matrix <span class="op">@</span> w_init</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><code>-</code> 초기값이라 그런지 잘 예측하는 것 같지는 않음</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:730,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1696307688137,&quot;user&quot;:{&quot;displayName&quot;:&quot;ccc flkwerkdai&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-outputid="241f8e1e-ccbb-426c-bfb7-b8d63bd5c266" data-execution_count="147">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1"></a>plt.figure(figsize <span class="op">=</span> (<span class="dv">4</span>,<span class="dv">4</span>))</span>
<span id="cb27-2"><a href="#cb27-2"></a>plt.plot(y_test,label <span class="op">=</span> <span class="vs">r"$(y_</span><span class="sc">{test}</span><span class="vs">)$"</span>,alpha <span class="op">=</span> <span class="fl">0.5</span>)</span>
<span id="cb27-3"><a href="#cb27-3"></a>plt.plot(y_pred_init,label <span class="op">=</span> <span class="vs">r"$(\hat </span><span class="sc">{y}</span><span class="vs">_</span><span class="sc">{init}</span><span class="vs">)$"</span>,alpha <span class="op">=</span> <span class="fl">0.6</span>)</span>
<span id="cb27-4"><a href="#cb27-4"></a>plt.title(<span class="vs">r"($y_</span><span class="sc">{test}</span><span class="vs">, \hat </span><span class="sc">{y}</span><span class="vs">_</span><span class="sc">{init}</span><span class="vs">$)"</span>)</span>
<span id="cb27-5"><a href="#cb27-5"></a>plt.legend()</span>
<span id="cb27-6"><a href="#cb27-6"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="2023-10-03-00. 딥러닝 (1)_files/figure-html/cell-22-output-1.png" class="img-fluid"></p>
</div>
</div>
<p><code>-</code> 이제 keras에서 제공하는 compile과 fit을 이용하여 모델 적합후 비교해보자</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:7300,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1696307916884,&quot;user&quot;:{&quot;displayName&quot;:&quot;ccc flkwerkdai&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-outputid="274259e4-7a7d-4f4c-c124-9987988cd4fa" data-execution_count="148">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1"></a><span class="co">## compile</span></span>
<span id="cb28-2"><a href="#cb28-2"></a>model.<span class="bu">compile</span>(optimizer <span class="op">=</span> <span class="st">"adam"</span>, loss <span class="op">=</span> <span class="st">"mse"</span>)</span>
<span id="cb28-3"><a href="#cb28-3"></a></span>
<span id="cb28-4"><a href="#cb28-4"></a><span class="co">## fit</span></span>
<span id="cb28-5"><a href="#cb28-5"></a>model.fit(x_train, y_train)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>5/5 [==============================] - 6s 5ms/step - loss: 219.7330</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="148">
<pre><code>&lt;keras.src.callbacks.History at 0x7ddedaf4cac0&gt;</code></pre>
</div>
</div>
<p><code>-</code> 예측값 저장 (기본 epoch = 5 이므로 y_pred_5라고 저장)</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:4,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1696307979822,&quot;user&quot;:{&quot;displayName&quot;:&quot;ccc flkwerkdai&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-outputid="344858c4-fe8c-4035-b85e-e5dfc3a6c771" data-execution_count="149">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1"></a>y_pred_5 <span class="op">=</span> model.predict(x_test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>2/2 [==============================] - 0s 9ms/step</code></pre>
</div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:2,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1696308104492,&quot;user&quot;:{&quot;displayName&quot;:&quot;ccc flkwerkdai&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-execution_count="152">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1"></a><span class="co">#model.predict?</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><code>-</code> 여전히 성능이 쓰레기임</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:5,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1696308136423,&quot;user&quot;:{&quot;displayName&quot;:&quot;ccc flkwerkdai&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-outputid="801f8401-74a2-45ef-f72d-a1509b434c83" data-execution_count="153">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1"></a>plt.figure(figsize <span class="op">=</span> (<span class="dv">4</span>,<span class="dv">4</span>))</span>
<span id="cb34-2"><a href="#cb34-2"></a>plt.plot(y_test,label <span class="op">=</span> <span class="vs">r"$(y_</span><span class="sc">{test}</span><span class="vs">)$"</span>,alpha <span class="op">=</span> <span class="fl">0.5</span>)</span>
<span id="cb34-3"><a href="#cb34-3"></a>plt.plot(y_pred_init,label <span class="op">=</span> <span class="vs">r"$(\hat </span><span class="sc">{y}</span><span class="vs">_</span><span class="sc">{init}</span><span class="vs">)$"</span>,alpha <span class="op">=</span> <span class="fl">0.6</span>)</span>
<span id="cb34-4"><a href="#cb34-4"></a>plt.plot(y_pred_5,label <span class="op">=</span> <span class="vs">r"$(\hat </span><span class="sc">{y}</span><span class="vs">_</span><span class="sc">{5}</span><span class="vs">)$"</span>,alpha <span class="op">=</span> <span class="fl">0.6</span>)</span>
<span id="cb34-5"><a href="#cb34-5"></a>plt.title(<span class="vs">r"($y_</span><span class="sc">{test}</span><span class="vs">, \hat </span><span class="sc">{y}</span><span class="vs">_</span><span class="sc">{init}</span><span class="vs">, \hat </span><span class="sc">{y}</span><span class="vs">_</span><span class="sc">{5}</span><span class="vs">$)"</span>)</span>
<span id="cb34-6"><a href="#cb34-6"></a>plt.legend()</span>
<span id="cb34-7"><a href="#cb34-7"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="2023-10-03-00. 딥러닝 (1)_files/figure-html/cell-26-output-1.png" class="img-fluid"></p>
</div>
</div>
<p><code>-</code> epochs를 늘려서 다시 예측해보자</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:3,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1696308339309,&quot;user&quot;:{&quot;displayName&quot;:&quot;ccc flkwerkdai&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-execution_count="160">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1"></a>model.fit?</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:3,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1696308383128,&quot;user&quot;:{&quot;displayName&quot;:&quot;ccc flkwerkdai&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-execution_count="161">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1"></a>model.<span class="bu">compile</span>?</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:41703,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1696308493344,&quot;user&quot;:{&quot;displayName&quot;:&quot;ccc flkwerkdai&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-outputid="b043d670-a7e1-456c-cd7d-5c32a46e9108" data-execution_count="162">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1"></a><span class="co">## compile</span></span>
<span id="cb37-2"><a href="#cb37-2"></a>model.<span class="bu">compile</span>(optimizer <span class="op">=</span> <span class="st">"adam"</span>, loss <span class="op">=</span> <span class="st">"mse"</span>)</span>
<span id="cb37-3"><a href="#cb37-3"></a></span>
<span id="cb37-4"><a href="#cb37-4"></a><span class="co">## fit</span></span>
<span id="cb37-5"><a href="#cb37-5"></a>model.fit(x_train, y_train, epochs <span class="op">=</span> <span class="dv">1000</span>)</span>
<span id="cb37-6"><a href="#cb37-6"></a></span>
<span id="cb37-7"><a href="#cb37-7"></a>y_pred_final <span class="op">=</span> model.predict(x_test,verbose <span class="op">=</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch 1/1000
5/5 [==============================] - 1s 6ms/step - loss: 109.4172
Epoch 2/1000
5/5 [==============================] - 0s 5ms/step - loss: 109.1868
Epoch 3/1000
5/5 [==============================] - 0s 5ms/step - loss: 108.9626
Epoch 4/1000
5/5 [==============================] - 0s 5ms/step - loss: 108.7299
Epoch 5/1000
5/5 [==============================] - 0s 5ms/step - loss: 108.4981
Epoch 6/1000
5/5 [==============================] - 0s 5ms/step - loss: 108.2746
Epoch 7/1000
5/5 [==============================] - 0s 5ms/step - loss: 108.0486
Epoch 8/1000
5/5 [==============================] - 0s 7ms/step - loss: 107.8185
Epoch 9/1000
5/5 [==============================] - 0s 7ms/step - loss: 107.6013
Epoch 10/1000
5/5 [==============================] - 0s 6ms/step - loss: 107.3712
Epoch 11/1000
5/5 [==============================] - 0s 5ms/step - loss: 107.1475
Epoch 12/1000
5/5 [==============================] - 0s 5ms/step - loss: 106.9191
Epoch 13/1000
5/5 [==============================] - 0s 5ms/step - loss: 106.6953
Epoch 14/1000
5/5 [==============================] - 0s 4ms/step - loss: 106.4616
Epoch 15/1000
5/5 [==============================] - 0s 5ms/step - loss: 106.2446
Epoch 16/1000
5/5 [==============================] - 0s 7ms/step - loss: 106.0105
Epoch 17/1000
5/5 [==============================] - 0s 6ms/step - loss: 105.7884
Epoch 18/1000
5/5 [==============================] - 0s 5ms/step - loss: 105.5647
Epoch 19/1000
5/5 [==============================] - 0s 5ms/step - loss: 105.3465
Epoch 20/1000
5/5 [==============================] - 0s 5ms/step - loss: 105.1217
Epoch 21/1000
5/5 [==============================] - 0s 5ms/step - loss: 104.8943
Epoch 22/1000
5/5 [==============================] - 0s 6ms/step - loss: 104.6774
Epoch 23/1000
5/5 [==============================] - 0s 7ms/step - loss: 104.4532
Epoch 24/1000
5/5 [==============================] - 0s 5ms/step - loss: 104.2285
Epoch 25/1000
5/5 [==============================] - 0s 6ms/step - loss: 104.0009
Epoch 26/1000
5/5 [==============================] - 0s 8ms/step - loss: 103.7801
Epoch 27/1000
5/5 [==============================] - 0s 5ms/step - loss: 103.5532
Epoch 28/1000
5/5 [==============================] - 0s 5ms/step - loss: 103.3343
Epoch 29/1000
5/5 [==============================] - 0s 5ms/step - loss: 103.1174
Epoch 30/1000
5/5 [==============================] - 0s 5ms/step - loss: 102.8944
Epoch 31/1000
5/5 [==============================] - 0s 4ms/step - loss: 102.6777
Epoch 32/1000
5/5 [==============================] - 0s 4ms/step - loss: 102.4613
Epoch 33/1000
5/5 [==============================] - 0s 6ms/step - loss: 102.2449
Epoch 34/1000
5/5 [==============================] - 0s 7ms/step - loss: 102.0379
Epoch 35/1000
5/5 [==============================] - 0s 6ms/step - loss: 101.8212
Epoch 36/1000
5/5 [==============================] - 0s 8ms/step - loss: 101.6037
Epoch 37/1000
5/5 [==============================] - 0s 6ms/step - loss: 101.4005
Epoch 38/1000
5/5 [==============================] - 0s 6ms/step - loss: 101.1897
Epoch 39/1000
5/5 [==============================] - 0s 5ms/step - loss: 100.9803
Epoch 40/1000
5/5 [==============================] - 0s 7ms/step - loss: 100.7659
Epoch 41/1000
5/5 [==============================] - 0s 7ms/step - loss: 100.5528
Epoch 42/1000
5/5 [==============================] - 0s 7ms/step - loss: 100.3409
Epoch 43/1000
5/5 [==============================] - 0s 6ms/step - loss: 100.1284
Epoch 44/1000
5/5 [==============================] - 0s 7ms/step - loss: 99.9098
Epoch 45/1000
5/5 [==============================] - 0s 7ms/step - loss: 99.7002
Epoch 46/1000
5/5 [==============================] - 0s 7ms/step - loss: 99.4929
Epoch 47/1000
5/5 [==============================] - 0s 6ms/step - loss: 99.2754
Epoch 48/1000
5/5 [==============================] - 0s 6ms/step - loss: 99.0601
Epoch 49/1000
5/5 [==============================] - 0s 7ms/step - loss: 98.8559
Epoch 50/1000
5/5 [==============================] - 0s 7ms/step - loss: 98.6416
Epoch 51/1000
5/5 [==============================] - 0s 8ms/step - loss: 98.4370
Epoch 52/1000
5/5 [==============================] - 0s 6ms/step - loss: 98.2309
Epoch 53/1000
5/5 [==============================] - 0s 6ms/step - loss: 98.0138
Epoch 54/1000
5/5 [==============================] - 0s 6ms/step - loss: 97.8093
Epoch 55/1000
5/5 [==============================] - 0s 6ms/step - loss: 97.6044
Epoch 56/1000
5/5 [==============================] - 0s 6ms/step - loss: 97.3957
Epoch 57/1000
5/5 [==============================] - 0s 6ms/step - loss: 97.1901
Epoch 58/1000
5/5 [==============================] - 0s 4ms/step - loss: 96.9841
Epoch 59/1000
5/5 [==============================] - 0s 5ms/step - loss: 96.7849
Epoch 60/1000
5/5 [==============================] - 0s 6ms/step - loss: 96.5910
Epoch 61/1000
5/5 [==============================] - 0s 7ms/step - loss: 96.3754
Epoch 62/1000
5/5 [==============================] - 0s 5ms/step - loss: 96.1752
Epoch 63/1000
5/5 [==============================] - 0s 7ms/step - loss: 95.9621
Epoch 64/1000
5/5 [==============================] - 0s 6ms/step - loss: 95.7588
Epoch 65/1000
5/5 [==============================] - 0s 6ms/step - loss: 95.5547
Epoch 66/1000
5/5 [==============================] - 0s 7ms/step - loss: 95.3460
Epoch 67/1000
5/5 [==============================] - 0s 6ms/step - loss: 95.1421
Epoch 68/1000
5/5 [==============================] - 0s 6ms/step - loss: 94.9393
Epoch 69/1000
5/5 [==============================] - 0s 8ms/step - loss: 94.7284
Epoch 70/1000
5/5 [==============================] - 0s 6ms/step - loss: 94.5297
Epoch 71/1000
5/5 [==============================] - 0s 7ms/step - loss: 94.3307
Epoch 72/1000
5/5 [==============================] - 0s 8ms/step - loss: 94.1278
Epoch 73/1000
5/5 [==============================] - 0s 7ms/step - loss: 93.9289
Epoch 74/1000
5/5 [==============================] - 0s 6ms/step - loss: 93.7272
Epoch 75/1000
5/5 [==============================] - 0s 7ms/step - loss: 93.5285
Epoch 76/1000
5/5 [==============================] - 0s 6ms/step - loss: 93.3294
Epoch 77/1000
5/5 [==============================] - 0s 7ms/step - loss: 93.1322
Epoch 78/1000
5/5 [==============================] - 0s 7ms/step - loss: 92.9389
Epoch 79/1000
5/5 [==============================] - 0s 6ms/step - loss: 92.7353
Epoch 80/1000
5/5 [==============================] - 0s 8ms/step - loss: 92.5323
Epoch 81/1000
5/5 [==============================] - 0s 11ms/step - loss: 92.3321
Epoch 82/1000
5/5 [==============================] - 0s 7ms/step - loss: 92.1339
Epoch 83/1000
5/5 [==============================] - 0s 8ms/step - loss: 91.9349
Epoch 84/1000
5/5 [==============================] - 0s 6ms/step - loss: 91.7386
Epoch 85/1000
5/5 [==============================] - 0s 9ms/step - loss: 91.5411
Epoch 86/1000
5/5 [==============================] - 0s 6ms/step - loss: 91.3418
Epoch 87/1000
5/5 [==============================] - 0s 5ms/step - loss: 91.1438
Epoch 88/1000
5/5 [==============================] - 0s 5ms/step - loss: 90.9459
Epoch 89/1000
5/5 [==============================] - 0s 7ms/step - loss: 90.7521
Epoch 90/1000
5/5 [==============================] - 0s 9ms/step - loss: 90.5549
Epoch 91/1000
5/5 [==============================] - 0s 8ms/step - loss: 90.3532
Epoch 92/1000
5/5 [==============================] - 0s 6ms/step - loss: 90.1659
Epoch 93/1000
5/5 [==============================] - 0s 5ms/step - loss: 89.9669
Epoch 94/1000
5/5 [==============================] - 0s 4ms/step - loss: 89.7709
Epoch 95/1000
5/5 [==============================] - 0s 4ms/step - loss: 89.5775
Epoch 96/1000
5/5 [==============================] - 0s 4ms/step - loss: 89.3882
Epoch 97/1000
5/5 [==============================] - 0s 9ms/step - loss: 89.1998
Epoch 98/1000
5/5 [==============================] - 0s 4ms/step - loss: 89.0053
Epoch 99/1000
5/5 [==============================] - 0s 5ms/step - loss: 88.8156
Epoch 100/1000
5/5 [==============================] - 0s 6ms/step - loss: 88.6220
Epoch 101/1000
5/5 [==============================] - 0s 5ms/step - loss: 88.4300
Epoch 102/1000
5/5 [==============================] - 0s 7ms/step - loss: 88.2422
Epoch 103/1000
5/5 [==============================] - 0s 13ms/step - loss: 88.0466
Epoch 104/1000
5/5 [==============================] - 0s 5ms/step - loss: 87.8566
Epoch 105/1000
5/5 [==============================] - 0s 5ms/step - loss: 87.6699
Epoch 106/1000
5/5 [==============================] - 0s 5ms/step - loss: 87.4792
Epoch 107/1000
5/5 [==============================] - 0s 6ms/step - loss: 87.2927
Epoch 108/1000
5/5 [==============================] - 0s 4ms/step - loss: 87.1079
Epoch 109/1000
5/5 [==============================] - 0s 9ms/step - loss: 86.9185
Epoch 110/1000
5/5 [==============================] - 0s 5ms/step - loss: 86.7362
Epoch 111/1000
5/5 [==============================] - 0s 5ms/step - loss: 86.5498
Epoch 112/1000
5/5 [==============================] - 0s 5ms/step - loss: 86.3623
Epoch 113/1000
5/5 [==============================] - 0s 5ms/step - loss: 86.1762
Epoch 114/1000
5/5 [==============================] - 0s 8ms/step - loss: 85.9827
Epoch 115/1000
5/5 [==============================] - 0s 9ms/step - loss: 85.8061
Epoch 116/1000
5/5 [==============================] - 0s 6ms/step - loss: 85.6136
Epoch 117/1000
5/5 [==============================] - 0s 4ms/step - loss: 85.4308
Epoch 118/1000
5/5 [==============================] - 0s 5ms/step - loss: 85.2473
Epoch 119/1000
5/5 [==============================] - 0s 4ms/step - loss: 85.0604
Epoch 120/1000
5/5 [==============================] - 0s 5ms/step - loss: 84.8720
Epoch 121/1000
5/5 [==============================] - 0s 4ms/step - loss: 84.6853
Epoch 122/1000
5/5 [==============================] - 0s 5ms/step - loss: 84.4953
Epoch 123/1000
5/5 [==============================] - 0s 4ms/step - loss: 84.3089
Epoch 124/1000
5/5 [==============================] - 0s 5ms/step - loss: 84.1167
Epoch 125/1000
5/5 [==============================] - 0s 4ms/step - loss: 83.9305
Epoch 126/1000
5/5 [==============================] - 0s 5ms/step - loss: 83.7400
Epoch 127/1000
5/5 [==============================] - 0s 6ms/step - loss: 83.5551
Epoch 128/1000
5/5 [==============================] - 0s 4ms/step - loss: 83.3687
Epoch 129/1000
5/5 [==============================] - 0s 4ms/step - loss: 83.1797
Epoch 130/1000
5/5 [==============================] - 0s 5ms/step - loss: 82.9989
Epoch 131/1000
5/5 [==============================] - 0s 4ms/step - loss: 82.8167
Epoch 132/1000
5/5 [==============================] - 0s 4ms/step - loss: 82.6315
Epoch 133/1000
5/5 [==============================] - 0s 6ms/step - loss: 82.4512
Epoch 134/1000
5/5 [==============================] - 0s 4ms/step - loss: 82.2664
Epoch 135/1000
5/5 [==============================] - 0s 4ms/step - loss: 82.0849
Epoch 136/1000
5/5 [==============================] - 0s 5ms/step - loss: 81.9010
Epoch 137/1000
5/5 [==============================] - 0s 5ms/step - loss: 81.7232
Epoch 138/1000
5/5 [==============================] - 0s 5ms/step - loss: 81.5365
Epoch 139/1000
5/5 [==============================] - 0s 4ms/step - loss: 81.3612
Epoch 140/1000
5/5 [==============================] - 0s 5ms/step - loss: 81.1757
Epoch 141/1000
5/5 [==============================] - 0s 4ms/step - loss: 80.9972
Epoch 142/1000
5/5 [==============================] - 0s 4ms/step - loss: 80.8143
Epoch 143/1000
5/5 [==============================] - 0s 4ms/step - loss: 80.6310
Epoch 144/1000
5/5 [==============================] - 0s 5ms/step - loss: 80.4510
Epoch 145/1000
5/5 [==============================] - 0s 5ms/step - loss: 80.2664
Epoch 146/1000
5/5 [==============================] - 0s 4ms/step - loss: 80.0901
Epoch 147/1000
5/5 [==============================] - 0s 5ms/step - loss: 79.9080
Epoch 148/1000
5/5 [==============================] - 0s 4ms/step - loss: 79.7365
Epoch 149/1000
5/5 [==============================] - 0s 5ms/step - loss: 79.5604
Epoch 150/1000
5/5 [==============================] - 0s 7ms/step - loss: 79.3853
Epoch 151/1000
5/5 [==============================] - 0s 5ms/step - loss: 79.2035
Epoch 152/1000
5/5 [==============================] - 0s 5ms/step - loss: 79.0299
Epoch 153/1000
5/5 [==============================] - 0s 5ms/step - loss: 78.8572
Epoch 154/1000
5/5 [==============================] - 0s 8ms/step - loss: 78.6763
Epoch 155/1000
5/5 [==============================] - 0s 6ms/step - loss: 78.5045
Epoch 156/1000
5/5 [==============================] - 0s 5ms/step - loss: 78.3235
Epoch 157/1000
5/5 [==============================] - 0s 5ms/step - loss: 78.1519
Epoch 158/1000
5/5 [==============================] - 0s 5ms/step - loss: 77.9853
Epoch 159/1000
5/5 [==============================] - 0s 6ms/step - loss: 77.8087
Epoch 160/1000
5/5 [==============================] - 0s 5ms/step - loss: 77.6422
Epoch 161/1000
5/5 [==============================] - 0s 8ms/step - loss: 77.4701
Epoch 162/1000
5/5 [==============================] - 0s 6ms/step - loss: 77.3006
Epoch 163/1000
5/5 [==============================] - 0s 5ms/step - loss: 77.1299
Epoch 164/1000
5/5 [==============================] - 0s 5ms/step - loss: 76.9655
Epoch 165/1000
5/5 [==============================] - 0s 5ms/step - loss: 76.7956
Epoch 166/1000
5/5 [==============================] - 0s 4ms/step - loss: 76.6254
Epoch 167/1000
5/5 [==============================] - 0s 4ms/step - loss: 76.4598
Epoch 168/1000
5/5 [==============================] - 0s 6ms/step - loss: 76.2882
Epoch 169/1000
5/5 [==============================] - 0s 6ms/step - loss: 76.1207
Epoch 170/1000
5/5 [==============================] - 0s 6ms/step - loss: 75.9494
Epoch 171/1000
5/5 [==============================] - 0s 6ms/step - loss: 75.7812
Epoch 172/1000
5/5 [==============================] - 0s 6ms/step - loss: 75.6123
Epoch 173/1000
5/5 [==============================] - 0s 6ms/step - loss: 75.4423
Epoch 174/1000
5/5 [==============================] - 0s 5ms/step - loss: 75.2715
Epoch 175/1000
5/5 [==============================] - 0s 5ms/step - loss: 75.1068
Epoch 176/1000
5/5 [==============================] - 0s 8ms/step - loss: 74.9383
Epoch 177/1000
5/5 [==============================] - 0s 6ms/step - loss: 74.7736
Epoch 178/1000
5/5 [==============================] - 0s 5ms/step - loss: 74.6112
Epoch 179/1000
5/5 [==============================] - 0s 5ms/step - loss: 74.4437
Epoch 180/1000
5/5 [==============================] - 0s 5ms/step - loss: 74.2781
Epoch 181/1000
5/5 [==============================] - 0s 5ms/step - loss: 74.1164
Epoch 182/1000
5/5 [==============================] - 0s 5ms/step - loss: 73.9501
Epoch 183/1000
5/5 [==============================] - 0s 4ms/step - loss: 73.7829
Epoch 184/1000
5/5 [==============================] - 0s 6ms/step - loss: 73.6218
Epoch 185/1000
5/5 [==============================] - 0s 5ms/step - loss: 73.4603
Epoch 186/1000
5/5 [==============================] - 0s 5ms/step - loss: 73.2937
Epoch 187/1000
5/5 [==============================] - 0s 5ms/step - loss: 73.1317
Epoch 188/1000
5/5 [==============================] - 0s 5ms/step - loss: 72.9703
Epoch 189/1000
5/5 [==============================] - 0s 9ms/step - loss: 72.8072
Epoch 190/1000
5/5 [==============================] - 0s 7ms/step - loss: 72.6443
Epoch 191/1000
5/5 [==============================] - 0s 5ms/step - loss: 72.4829
Epoch 192/1000
5/5 [==============================] - 0s 5ms/step - loss: 72.3209
Epoch 193/1000
5/5 [==============================] - 0s 7ms/step - loss: 72.1542
Epoch 194/1000
5/5 [==============================] - 0s 6ms/step - loss: 71.9928
Epoch 195/1000
5/5 [==============================] - 0s 5ms/step - loss: 71.8223
Epoch 196/1000
5/5 [==============================] - 0s 5ms/step - loss: 71.6613
Epoch 197/1000
5/5 [==============================] - 0s 5ms/step - loss: 71.4974
Epoch 198/1000
5/5 [==============================] - 0s 4ms/step - loss: 71.3324
Epoch 199/1000
5/5 [==============================] - 0s 5ms/step - loss: 71.1688
Epoch 200/1000
5/5 [==============================] - 0s 5ms/step - loss: 71.0114
Epoch 201/1000
5/5 [==============================] - 0s 5ms/step - loss: 70.8453
Epoch 202/1000
5/5 [==============================] - 0s 5ms/step - loss: 70.6870
Epoch 203/1000
5/5 [==============================] - 0s 5ms/step - loss: 70.5309
Epoch 204/1000
5/5 [==============================] - 0s 5ms/step - loss: 70.3735
Epoch 205/1000
5/5 [==============================] - 0s 4ms/step - loss: 70.2070
Epoch 206/1000
5/5 [==============================] - 0s 3ms/step - loss: 70.0521
Epoch 207/1000
5/5 [==============================] - 0s 4ms/step - loss: 69.8928
Epoch 208/1000
5/5 [==============================] - 0s 3ms/step - loss: 69.7288
Epoch 209/1000
5/5 [==============================] - 0s 4ms/step - loss: 69.5711
Epoch 210/1000
5/5 [==============================] - 0s 4ms/step - loss: 69.4174
Epoch 211/1000
5/5 [==============================] - 0s 6ms/step - loss: 69.2545
Epoch 212/1000
5/5 [==============================] - 0s 3ms/step - loss: 69.0938
Epoch 213/1000
5/5 [==============================] - 0s 3ms/step - loss: 68.9379
Epoch 214/1000
5/5 [==============================] - 0s 4ms/step - loss: 68.7842
Epoch 215/1000
5/5 [==============================] - 0s 4ms/step - loss: 68.6311
Epoch 216/1000
5/5 [==============================] - 0s 4ms/step - loss: 68.4770
Epoch 217/1000
5/5 [==============================] - 0s 3ms/step - loss: 68.3204
Epoch 218/1000
5/5 [==============================] - 0s 4ms/step - loss: 68.1703
Epoch 219/1000
5/5 [==============================] - 0s 4ms/step - loss: 68.0143
Epoch 220/1000
5/5 [==============================] - 0s 3ms/step - loss: 67.8609
Epoch 221/1000
5/5 [==============================] - 0s 4ms/step - loss: 67.7008
Epoch 222/1000
5/5 [==============================] - 0s 4ms/step - loss: 67.5489
Epoch 223/1000
5/5 [==============================] - 0s 4ms/step - loss: 67.3931
Epoch 224/1000
5/5 [==============================] - 0s 4ms/step - loss: 67.2387
Epoch 225/1000
5/5 [==============================] - 0s 6ms/step - loss: 67.0818
Epoch 226/1000
5/5 [==============================] - 0s 4ms/step - loss: 66.9349
Epoch 227/1000
5/5 [==============================] - 0s 3ms/step - loss: 66.7776
Epoch 228/1000
5/5 [==============================] - 0s 4ms/step - loss: 66.6269
Epoch 229/1000
5/5 [==============================] - 0s 4ms/step - loss: 66.4755
Epoch 230/1000
5/5 [==============================] - 0s 4ms/step - loss: 66.3197
Epoch 231/1000
5/5 [==============================] - 0s 4ms/step - loss: 66.1673
Epoch 232/1000
5/5 [==============================] - 0s 4ms/step - loss: 66.0209
Epoch 233/1000
5/5 [==============================] - 0s 4ms/step - loss: 65.8644
Epoch 234/1000
5/5 [==============================] - 0s 4ms/step - loss: 65.7159
Epoch 235/1000
5/5 [==============================] - 0s 5ms/step - loss: 65.5645
Epoch 236/1000
5/5 [==============================] - 0s 4ms/step - loss: 65.4146
Epoch 237/1000
5/5 [==============================] - 0s 4ms/step - loss: 65.2609
Epoch 238/1000
5/5 [==============================] - 0s 4ms/step - loss: 65.1096
Epoch 239/1000
5/5 [==============================] - 0s 4ms/step - loss: 64.9635
Epoch 240/1000
5/5 [==============================] - 0s 4ms/step - loss: 64.8139
Epoch 241/1000
5/5 [==============================] - 0s 4ms/step - loss: 64.6613
Epoch 242/1000
5/5 [==============================] - 0s 5ms/step - loss: 64.5168
Epoch 243/1000
5/5 [==============================] - 0s 4ms/step - loss: 64.3741
Epoch 244/1000
5/5 [==============================] - 0s 4ms/step - loss: 64.2218
Epoch 245/1000
5/5 [==============================] - 0s 4ms/step - loss: 64.0745
Epoch 246/1000
5/5 [==============================] - 0s 4ms/step - loss: 63.9305
Epoch 247/1000
5/5 [==============================] - 0s 4ms/step - loss: 63.7846
Epoch 248/1000
5/5 [==============================] - 0s 4ms/step - loss: 63.6388
Epoch 249/1000
5/5 [==============================] - 0s 4ms/step - loss: 63.4942
Epoch 250/1000
5/5 [==============================] - 0s 5ms/step - loss: 63.3476
Epoch 251/1000
5/5 [==============================] - 0s 4ms/step - loss: 63.1938
Epoch 252/1000
5/5 [==============================] - 0s 4ms/step - loss: 63.0518
Epoch 253/1000
5/5 [==============================] - 0s 4ms/step - loss: 62.9031
Epoch 254/1000
5/5 [==============================] - 0s 4ms/step - loss: 62.7571
Epoch 255/1000
5/5 [==============================] - 0s 4ms/step - loss: 62.6089
Epoch 256/1000
5/5 [==============================] - 0s 4ms/step - loss: 62.4629
Epoch 257/1000
5/5 [==============================] - 0s 4ms/step - loss: 62.3235
Epoch 258/1000
5/5 [==============================] - 0s 6ms/step - loss: 62.1681
Epoch 259/1000
5/5 [==============================] - 0s 4ms/step - loss: 62.0225
Epoch 260/1000
5/5 [==============================] - 0s 4ms/step - loss: 61.8753
Epoch 261/1000
5/5 [==============================] - 0s 4ms/step - loss: 61.7347
Epoch 262/1000
5/5 [==============================] - 0s 4ms/step - loss: 61.5874
Epoch 263/1000
5/5 [==============================] - 0s 7ms/step - loss: 61.4472
Epoch 264/1000
5/5 [==============================] - 0s 6ms/step - loss: 61.3046
Epoch 265/1000
5/5 [==============================] - 0s 4ms/step - loss: 61.1633
Epoch 266/1000
5/5 [==============================] - 0s 4ms/step - loss: 61.0200
Epoch 267/1000
5/5 [==============================] - 0s 5ms/step - loss: 60.8783
Epoch 268/1000
5/5 [==============================] - 0s 4ms/step - loss: 60.7334
Epoch 269/1000
5/5 [==============================] - 0s 4ms/step - loss: 60.5928
Epoch 270/1000
5/5 [==============================] - 0s 4ms/step - loss: 60.4547
Epoch 271/1000
5/5 [==============================] - 0s 4ms/step - loss: 60.3142
Epoch 272/1000
5/5 [==============================] - 0s 4ms/step - loss: 60.1754
Epoch 273/1000
5/5 [==============================] - 0s 4ms/step - loss: 60.0314
Epoch 274/1000
5/5 [==============================] - 0s 4ms/step - loss: 59.8938
Epoch 275/1000
5/5 [==============================] - 0s 4ms/step - loss: 59.7521
Epoch 276/1000
5/5 [==============================] - 0s 4ms/step - loss: 59.6135
Epoch 277/1000
5/5 [==============================] - 0s 4ms/step - loss: 59.4678
Epoch 278/1000
5/5 [==============================] - 0s 4ms/step - loss: 59.3272
Epoch 279/1000
5/5 [==============================] - 0s 4ms/step - loss: 59.1913
Epoch 280/1000
5/5 [==============================] - 0s 4ms/step - loss: 59.0542
Epoch 281/1000
5/5 [==============================] - 0s 4ms/step - loss: 58.9133
Epoch 282/1000
5/5 [==============================] - 0s 4ms/step - loss: 58.7831
Epoch 283/1000
5/5 [==============================] - 0s 4ms/step - loss: 58.6413
Epoch 284/1000
5/5 [==============================] - 0s 4ms/step - loss: 58.5093
Epoch 285/1000
5/5 [==============================] - 0s 4ms/step - loss: 58.3760
Epoch 286/1000
5/5 [==============================] - 0s 4ms/step - loss: 58.2422
Epoch 287/1000
5/5 [==============================] - 0s 4ms/step - loss: 58.1078
Epoch 288/1000
5/5 [==============================] - 0s 4ms/step - loss: 57.9742
Epoch 289/1000
5/5 [==============================] - 0s 4ms/step - loss: 57.8433
Epoch 290/1000
5/5 [==============================] - 0s 4ms/step - loss: 57.7075
Epoch 291/1000
5/5 [==============================] - 0s 4ms/step - loss: 57.5726
Epoch 292/1000
5/5 [==============================] - 0s 4ms/step - loss: 57.4412
Epoch 293/1000
5/5 [==============================] - 0s 4ms/step - loss: 57.3087
Epoch 294/1000
5/5 [==============================] - 0s 3ms/step - loss: 57.1790
Epoch 295/1000
5/5 [==============================] - 0s 4ms/step - loss: 57.0443
Epoch 296/1000
5/5 [==============================] - 0s 4ms/step - loss: 56.9131
Epoch 297/1000
5/5 [==============================] - 0s 4ms/step - loss: 56.7780
Epoch 298/1000
5/5 [==============================] - 0s 4ms/step - loss: 56.6474
Epoch 299/1000
5/5 [==============================] - 0s 4ms/step - loss: 56.5108
Epoch 300/1000
5/5 [==============================] - 0s 5ms/step - loss: 56.3796
Epoch 301/1000
5/5 [==============================] - 0s 4ms/step - loss: 56.2542
Epoch 302/1000
5/5 [==============================] - 0s 4ms/step - loss: 56.1182
Epoch 303/1000
5/5 [==============================] - 0s 3ms/step - loss: 55.9865
Epoch 304/1000
5/5 [==============================] - 0s 4ms/step - loss: 55.8526
Epoch 305/1000
5/5 [==============================] - 0s 4ms/step - loss: 55.7226
Epoch 306/1000
5/5 [==============================] - 0s 5ms/step - loss: 55.5918
Epoch 307/1000
5/5 [==============================] - 0s 4ms/step - loss: 55.4582
Epoch 308/1000
5/5 [==============================] - 0s 4ms/step - loss: 55.3261
Epoch 309/1000
5/5 [==============================] - 0s 4ms/step - loss: 55.1961
Epoch 310/1000
5/5 [==============================] - 0s 4ms/step - loss: 55.0635
Epoch 311/1000
5/5 [==============================] - 0s 4ms/step - loss: 54.9340
Epoch 312/1000
5/5 [==============================] - 0s 4ms/step - loss: 54.8050
Epoch 313/1000
5/5 [==============================] - 0s 4ms/step - loss: 54.6801
Epoch 314/1000
5/5 [==============================] - 0s 5ms/step - loss: 54.5537
Epoch 315/1000
5/5 [==============================] - 0s 4ms/step - loss: 54.4235
Epoch 316/1000
5/5 [==============================] - 0s 4ms/step - loss: 54.2932
Epoch 317/1000
5/5 [==============================] - 0s 4ms/step - loss: 54.1632
Epoch 318/1000
5/5 [==============================] - 0s 4ms/step - loss: 54.0377
Epoch 319/1000
5/5 [==============================] - 0s 4ms/step - loss: 53.9120
Epoch 320/1000
5/5 [==============================] - 0s 4ms/step - loss: 53.7802
Epoch 321/1000
5/5 [==============================] - 0s 4ms/step - loss: 53.6514
Epoch 322/1000
5/5 [==============================] - 0s 4ms/step - loss: 53.5197
Epoch 323/1000
5/5 [==============================] - 0s 4ms/step - loss: 53.3958
Epoch 324/1000
5/5 [==============================] - 0s 4ms/step - loss: 53.2674
Epoch 325/1000
5/5 [==============================] - 0s 5ms/step - loss: 53.1462
Epoch 326/1000
5/5 [==============================] - 0s 4ms/step - loss: 53.0176
Epoch 327/1000
5/5 [==============================] - 0s 4ms/step - loss: 52.8951
Epoch 328/1000
5/5 [==============================] - 0s 5ms/step - loss: 52.7723
Epoch 329/1000
5/5 [==============================] - 0s 4ms/step - loss: 52.6477
Epoch 330/1000
5/5 [==============================] - 0s 4ms/step - loss: 52.5222
Epoch 331/1000
5/5 [==============================] - 0s 4ms/step - loss: 52.3993
Epoch 332/1000
5/5 [==============================] - 0s 4ms/step - loss: 52.2694
Epoch 333/1000
5/5 [==============================] - 0s 5ms/step - loss: 52.1483
Epoch 334/1000
5/5 [==============================] - 0s 4ms/step - loss: 52.0245
Epoch 335/1000
5/5 [==============================] - 0s 4ms/step - loss: 51.9006
Epoch 336/1000
5/5 [==============================] - 0s 4ms/step - loss: 51.7825
Epoch 337/1000
5/5 [==============================] - 0s 6ms/step - loss: 51.6610
Epoch 338/1000
5/5 [==============================] - 0s 4ms/step - loss: 51.5370
Epoch 339/1000
5/5 [==============================] - 0s 4ms/step - loss: 51.4139
Epoch 340/1000
5/5 [==============================] - 0s 5ms/step - loss: 51.2943
Epoch 341/1000
5/5 [==============================] - 0s 4ms/step - loss: 51.1699
Epoch 342/1000
5/5 [==============================] - 0s 4ms/step - loss: 51.0519
Epoch 343/1000
5/5 [==============================] - 0s 4ms/step - loss: 50.9301
Epoch 344/1000
5/5 [==============================] - 0s 3ms/step - loss: 50.8085
Epoch 345/1000
5/5 [==============================] - 0s 4ms/step - loss: 50.6923
Epoch 346/1000
5/5 [==============================] - 0s 4ms/step - loss: 50.5699
Epoch 347/1000
5/5 [==============================] - 0s 4ms/step - loss: 50.4486
Epoch 348/1000
5/5 [==============================] - 0s 4ms/step - loss: 50.3319
Epoch 349/1000
5/5 [==============================] - 0s 4ms/step - loss: 50.2106
Epoch 350/1000
5/5 [==============================] - 0s 4ms/step - loss: 50.0934
Epoch 351/1000
5/5 [==============================] - 0s 5ms/step - loss: 49.9753
Epoch 352/1000
5/5 [==============================] - 0s 6ms/step - loss: 49.8542
Epoch 353/1000
5/5 [==============================] - 0s 4ms/step - loss: 49.7329
Epoch 354/1000
5/5 [==============================] - 0s 5ms/step - loss: 49.6102
Epoch 355/1000
5/5 [==============================] - 0s 5ms/step - loss: 49.4957
Epoch 356/1000
5/5 [==============================] - 0s 4ms/step - loss: 49.3757
Epoch 357/1000
5/5 [==============================] - 0s 4ms/step - loss: 49.2565
Epoch 358/1000
5/5 [==============================] - 0s 4ms/step - loss: 49.1384
Epoch 359/1000
5/5 [==============================] - 0s 4ms/step - loss: 49.0170
Epoch 360/1000
5/5 [==============================] - 0s 4ms/step - loss: 48.8998
Epoch 361/1000
5/5 [==============================] - 0s 5ms/step - loss: 48.7802
Epoch 362/1000
5/5 [==============================] - 0s 4ms/step - loss: 48.6622
Epoch 363/1000
5/5 [==============================] - 0s 4ms/step - loss: 48.5403
Epoch 364/1000
5/5 [==============================] - 0s 4ms/step - loss: 48.4258
Epoch 365/1000
5/5 [==============================] - 0s 4ms/step - loss: 48.3085
Epoch 366/1000
5/5 [==============================] - 0s 4ms/step - loss: 48.1905
Epoch 367/1000
5/5 [==============================] - 0s 4ms/step - loss: 48.0724
Epoch 368/1000
5/5 [==============================] - 0s 4ms/step - loss: 47.9572
Epoch 369/1000
5/5 [==============================] - 0s 5ms/step - loss: 47.8384
Epoch 370/1000
5/5 [==============================] - 0s 4ms/step - loss: 47.7237
Epoch 371/1000
5/5 [==============================] - 0s 4ms/step - loss: 47.6069
Epoch 372/1000
5/5 [==============================] - 0s 4ms/step - loss: 47.4938
Epoch 373/1000
5/5 [==============================] - 0s 5ms/step - loss: 47.3777
Epoch 374/1000
5/5 [==============================] - 0s 4ms/step - loss: 47.2671
Epoch 375/1000
5/5 [==============================] - 0s 4ms/step - loss: 47.1494
Epoch 376/1000
5/5 [==============================] - 0s 4ms/step - loss: 47.0368
Epoch 377/1000
5/5 [==============================] - 0s 4ms/step - loss: 46.9225
Epoch 378/1000
5/5 [==============================] - 0s 4ms/step - loss: 46.8118
Epoch 379/1000
5/5 [==============================] - 0s 6ms/step - loss: 46.6949
Epoch 380/1000
5/5 [==============================] - 0s 4ms/step - loss: 46.5846
Epoch 381/1000
5/5 [==============================] - 0s 4ms/step - loss: 46.4744
Epoch 382/1000
5/5 [==============================] - 0s 4ms/step - loss: 46.3639
Epoch 383/1000
5/5 [==============================] - 0s 4ms/step - loss: 46.2491
Epoch 384/1000
5/5 [==============================] - 0s 4ms/step - loss: 46.1356
Epoch 385/1000
5/5 [==============================] - 0s 4ms/step - loss: 46.0280
Epoch 386/1000
5/5 [==============================] - 0s 4ms/step - loss: 45.9145
Epoch 387/1000
5/5 [==============================] - 0s 4ms/step - loss: 45.8056
Epoch 388/1000
5/5 [==============================] - 0s 4ms/step - loss: 45.6956
Epoch 389/1000
5/5 [==============================] - 0s 4ms/step - loss: 45.5848
Epoch 390/1000
5/5 [==============================] - 0s 4ms/step - loss: 45.4730
Epoch 391/1000
5/5 [==============================] - 0s 4ms/step - loss: 45.3627
Epoch 392/1000
5/5 [==============================] - 0s 4ms/step - loss: 45.2467
Epoch 393/1000
5/5 [==============================] - 0s 4ms/step - loss: 45.1336
Epoch 394/1000
5/5 [==============================] - 0s 4ms/step - loss: 45.0182
Epoch 395/1000
5/5 [==============================] - 0s 3ms/step - loss: 44.9069
Epoch 396/1000
5/5 [==============================] - 0s 4ms/step - loss: 44.7960
Epoch 397/1000
5/5 [==============================] - 0s 4ms/step - loss: 44.6828
Epoch 398/1000
5/5 [==============================] - 0s 4ms/step - loss: 44.5724
Epoch 399/1000
5/5 [==============================] - 0s 4ms/step - loss: 44.4627
Epoch 400/1000
5/5 [==============================] - 0s 4ms/step - loss: 44.3568
Epoch 401/1000
5/5 [==============================] - 0s 4ms/step - loss: 44.2480
Epoch 402/1000
5/5 [==============================] - 0s 5ms/step - loss: 44.1431
Epoch 403/1000
5/5 [==============================] - 0s 4ms/step - loss: 44.0344
Epoch 404/1000
5/5 [==============================] - 0s 4ms/step - loss: 43.9286
Epoch 405/1000
5/5 [==============================] - 0s 4ms/step - loss: 43.8260
Epoch 406/1000
5/5 [==============================] - 0s 4ms/step - loss: 43.7172
Epoch 407/1000
5/5 [==============================] - 0s 5ms/step - loss: 43.6140
Epoch 408/1000
5/5 [==============================] - 0s 4ms/step - loss: 43.5114
Epoch 409/1000
5/5 [==============================] - 0s 4ms/step - loss: 43.4022
Epoch 410/1000
5/5 [==============================] - 0s 4ms/step - loss: 43.2967
Epoch 411/1000
5/5 [==============================] - 0s 5ms/step - loss: 43.1923
Epoch 412/1000
5/5 [==============================] - 0s 4ms/step - loss: 43.0855
Epoch 413/1000
5/5 [==============================] - 0s 4ms/step - loss: 42.9789
Epoch 414/1000
5/5 [==============================] - 0s 4ms/step - loss: 42.8722
Epoch 415/1000
5/5 [==============================] - 0s 3ms/step - loss: 42.7677
Epoch 416/1000
5/5 [==============================] - 0s 4ms/step - loss: 42.6625
Epoch 417/1000
5/5 [==============================] - 0s 3ms/step - loss: 42.5556
Epoch 418/1000
5/5 [==============================] - 0s 3ms/step - loss: 42.4544
Epoch 419/1000
5/5 [==============================] - 0s 4ms/step - loss: 42.3536
Epoch 420/1000
5/5 [==============================] - 0s 4ms/step - loss: 42.2517
Epoch 421/1000
5/5 [==============================] - 0s 4ms/step - loss: 42.1512
Epoch 422/1000
5/5 [==============================] - 0s 4ms/step - loss: 42.0489
Epoch 423/1000
5/5 [==============================] - 0s 4ms/step - loss: 41.9487
Epoch 424/1000
5/5 [==============================] - 0s 4ms/step - loss: 41.8482
Epoch 425/1000
5/5 [==============================] - 0s 5ms/step - loss: 41.7451
Epoch 426/1000
5/5 [==============================] - 0s 4ms/step - loss: 41.6453
Epoch 427/1000
5/5 [==============================] - 0s 4ms/step - loss: 41.5382
Epoch 428/1000
5/5 [==============================] - 0s 4ms/step - loss: 41.4426
Epoch 429/1000
5/5 [==============================] - 0s 4ms/step - loss: 41.3368
Epoch 430/1000
5/5 [==============================] - 0s 4ms/step - loss: 41.2396
Epoch 431/1000
5/5 [==============================] - 0s 4ms/step - loss: 41.1349
Epoch 432/1000
5/5 [==============================] - 0s 4ms/step - loss: 41.0359
Epoch 433/1000
5/5 [==============================] - 0s 3ms/step - loss: 40.9330
Epoch 434/1000
5/5 [==============================] - 0s 4ms/step - loss: 40.8305
Epoch 435/1000
5/5 [==============================] - 0s 4ms/step - loss: 40.7265
Epoch 436/1000
5/5 [==============================] - 0s 6ms/step - loss: 40.6280
Epoch 437/1000
5/5 [==============================] - 0s 4ms/step - loss: 40.5216
Epoch 438/1000
5/5 [==============================] - 0s 4ms/step - loss: 40.4232
Epoch 439/1000
5/5 [==============================] - 0s 4ms/step - loss: 40.3209
Epoch 440/1000
5/5 [==============================] - 0s 5ms/step - loss: 40.2173
Epoch 441/1000
5/5 [==============================] - 0s 5ms/step - loss: 40.1160
Epoch 442/1000
5/5 [==============================] - 0s 5ms/step - loss: 40.0195
Epoch 443/1000
5/5 [==============================] - 0s 5ms/step - loss: 39.9192
Epoch 444/1000
5/5 [==============================] - 0s 5ms/step - loss: 39.8198
Epoch 445/1000
5/5 [==============================] - 0s 4ms/step - loss: 39.7249
Epoch 446/1000
5/5 [==============================] - 0s 4ms/step - loss: 39.6241
Epoch 447/1000
5/5 [==============================] - 0s 4ms/step - loss: 39.5308
Epoch 448/1000
5/5 [==============================] - 0s 4ms/step - loss: 39.4315
Epoch 449/1000
5/5 [==============================] - 0s 4ms/step - loss: 39.3370
Epoch 450/1000
5/5 [==============================] - 0s 4ms/step - loss: 39.2424
Epoch 451/1000
5/5 [==============================] - 0s 5ms/step - loss: 39.1430
Epoch 452/1000
5/5 [==============================] - 0s 5ms/step - loss: 39.0463
Epoch 453/1000
5/5 [==============================] - 0s 5ms/step - loss: 38.9474
Epoch 454/1000
5/5 [==============================] - 0s 5ms/step - loss: 38.8517
Epoch 455/1000
5/5 [==============================] - 0s 6ms/step - loss: 38.7598
Epoch 456/1000
5/5 [==============================] - 0s 5ms/step - loss: 38.6580
Epoch 457/1000
5/5 [==============================] - 0s 5ms/step - loss: 38.5671
Epoch 458/1000
5/5 [==============================] - 0s 6ms/step - loss: 38.4681
Epoch 459/1000
5/5 [==============================] - 0s 6ms/step - loss: 38.3767
Epoch 460/1000
5/5 [==============================] - 0s 5ms/step - loss: 38.2845
Epoch 461/1000
5/5 [==============================] - 0s 5ms/step - loss: 38.1909
Epoch 462/1000
5/5 [==============================] - 0s 5ms/step - loss: 38.0949
Epoch 463/1000
5/5 [==============================] - 0s 4ms/step - loss: 38.0021
Epoch 464/1000
5/5 [==============================] - 0s 4ms/step - loss: 37.9094
Epoch 465/1000
5/5 [==============================] - 0s 6ms/step - loss: 37.8159
Epoch 466/1000
5/5 [==============================] - 0s 6ms/step - loss: 37.7213
Epoch 467/1000
5/5 [==============================] - 0s 5ms/step - loss: 37.6292
Epoch 468/1000
5/5 [==============================] - 0s 5ms/step - loss: 37.5367
Epoch 469/1000
5/5 [==============================] - 0s 5ms/step - loss: 37.4457
Epoch 470/1000
5/5 [==============================] - 0s 4ms/step - loss: 37.3529
Epoch 471/1000
5/5 [==============================] - 0s 6ms/step - loss: 37.2637
Epoch 472/1000
5/5 [==============================] - 0s 6ms/step - loss: 37.1712
Epoch 473/1000
5/5 [==============================] - 0s 4ms/step - loss: 37.0785
Epoch 474/1000
5/5 [==============================] - 0s 4ms/step - loss: 36.9892
Epoch 475/1000
5/5 [==============================] - 0s 5ms/step - loss: 36.8996
Epoch 476/1000
5/5 [==============================] - 0s 6ms/step - loss: 36.8071
Epoch 477/1000
5/5 [==============================] - 0s 5ms/step - loss: 36.7154
Epoch 478/1000
5/5 [==============================] - 0s 5ms/step - loss: 36.6271
Epoch 479/1000
5/5 [==============================] - 0s 6ms/step - loss: 36.5370
Epoch 480/1000
5/5 [==============================] - 0s 5ms/step - loss: 36.4459
Epoch 481/1000
5/5 [==============================] - 0s 5ms/step - loss: 36.3619
Epoch 482/1000
5/5 [==============================] - 0s 5ms/step - loss: 36.2655
Epoch 483/1000
5/5 [==============================] - 0s 5ms/step - loss: 36.1804
Epoch 484/1000
5/5 [==============================] - 0s 5ms/step - loss: 36.0937
Epoch 485/1000
5/5 [==============================] - 0s 5ms/step - loss: 36.0053
Epoch 486/1000
5/5 [==============================] - 0s 5ms/step - loss: 35.9187
Epoch 487/1000
5/5 [==============================] - 0s 5ms/step - loss: 35.8312
Epoch 488/1000
5/5 [==============================] - 0s 7ms/step - loss: 35.7396
Epoch 489/1000
5/5 [==============================] - 0s 6ms/step - loss: 35.6515
Epoch 490/1000
5/5 [==============================] - 0s 6ms/step - loss: 35.5634
Epoch 491/1000
5/5 [==============================] - 0s 5ms/step - loss: 35.4748
Epoch 492/1000
5/5 [==============================] - 0s 5ms/step - loss: 35.3852
Epoch 493/1000
5/5 [==============================] - 0s 5ms/step - loss: 35.2970
Epoch 494/1000
5/5 [==============================] - 0s 4ms/step - loss: 35.2093
Epoch 495/1000
5/5 [==============================] - 0s 4ms/step - loss: 35.1211
Epoch 496/1000
5/5 [==============================] - 0s 4ms/step - loss: 35.0373
Epoch 497/1000
5/5 [==============================] - 0s 4ms/step - loss: 34.9543
Epoch 498/1000
5/5 [==============================] - 0s 4ms/step - loss: 34.8651
Epoch 499/1000
5/5 [==============================] - 0s 5ms/step - loss: 34.7807
Epoch 500/1000
5/5 [==============================] - 0s 4ms/step - loss: 34.6964
Epoch 501/1000
5/5 [==============================] - 0s 4ms/step - loss: 34.6105
Epoch 502/1000
5/5 [==============================] - 0s 4ms/step - loss: 34.5256
Epoch 503/1000
5/5 [==============================] - 0s 4ms/step - loss: 34.4368
Epoch 504/1000
5/5 [==============================] - 0s 4ms/step - loss: 34.3538
Epoch 505/1000
5/5 [==============================] - 0s 5ms/step - loss: 34.2686
Epoch 506/1000
5/5 [==============================] - 0s 4ms/step - loss: 34.1831
Epoch 507/1000
5/5 [==============================] - 0s 4ms/step - loss: 34.1008
Epoch 508/1000
5/5 [==============================] - 0s 4ms/step - loss: 34.0150
Epoch 509/1000
5/5 [==============================] - 0s 4ms/step - loss: 33.9333
Epoch 510/1000
5/5 [==============================] - 0s 4ms/step - loss: 33.8483
Epoch 511/1000
5/5 [==============================] - 0s 5ms/step - loss: 33.7659
Epoch 512/1000
5/5 [==============================] - 0s 4ms/step - loss: 33.6827
Epoch 513/1000
5/5 [==============================] - 0s 4ms/step - loss: 33.5989
Epoch 514/1000
5/5 [==============================] - 0s 4ms/step - loss: 33.5174
Epoch 515/1000
5/5 [==============================] - 0s 4ms/step - loss: 33.4336
Epoch 516/1000
5/5 [==============================] - 0s 7ms/step - loss: 33.3516
Epoch 517/1000
5/5 [==============================] - 0s 5ms/step - loss: 33.2701
Epoch 518/1000
5/5 [==============================] - 0s 6ms/step - loss: 33.1877
Epoch 519/1000
5/5 [==============================] - 0s 6ms/step - loss: 33.1066
Epoch 520/1000
5/5 [==============================] - 0s 5ms/step - loss: 33.0231
Epoch 521/1000
5/5 [==============================] - 0s 6ms/step - loss: 32.9393
Epoch 522/1000
5/5 [==============================] - 0s 6ms/step - loss: 32.8592
Epoch 523/1000
5/5 [==============================] - 0s 5ms/step - loss: 32.7752
Epoch 524/1000
5/5 [==============================] - 0s 5ms/step - loss: 32.6948
Epoch 525/1000
5/5 [==============================] - 0s 5ms/step - loss: 32.6120
Epoch 526/1000
5/5 [==============================] - 0s 5ms/step - loss: 32.5309
Epoch 527/1000
5/5 [==============================] - 0s 5ms/step - loss: 32.4440
Epoch 528/1000
5/5 [==============================] - 0s 5ms/step - loss: 32.3647
Epoch 529/1000
5/5 [==============================] - 0s 3ms/step - loss: 32.2823
Epoch 530/1000
5/5 [==============================] - 0s 5ms/step - loss: 32.2004
Epoch 531/1000
5/5 [==============================] - 0s 5ms/step - loss: 32.1229
Epoch 532/1000
5/5 [==============================] - 0s 5ms/step - loss: 32.0423
Epoch 533/1000
5/5 [==============================] - 0s 5ms/step - loss: 31.9624
Epoch 534/1000
5/5 [==============================] - 0s 6ms/step - loss: 31.8825
Epoch 535/1000
5/5 [==============================] - 0s 4ms/step - loss: 31.8034
Epoch 536/1000
5/5 [==============================] - 0s 5ms/step - loss: 31.7254
Epoch 537/1000
5/5 [==============================] - 0s 5ms/step - loss: 31.6465
Epoch 538/1000
5/5 [==============================] - 0s 5ms/step - loss: 31.5661
Epoch 539/1000
5/5 [==============================] - 0s 5ms/step - loss: 31.4873
Epoch 540/1000
5/5 [==============================] - 0s 4ms/step - loss: 31.4104
Epoch 541/1000
5/5 [==============================] - 0s 5ms/step - loss: 31.3303
Epoch 542/1000
5/5 [==============================] - 0s 5ms/step - loss: 31.2503
Epoch 543/1000
5/5 [==============================] - 0s 5ms/step - loss: 31.1750
Epoch 544/1000
5/5 [==============================] - 0s 5ms/step - loss: 31.0955
Epoch 545/1000
5/5 [==============================] - 0s 5ms/step - loss: 31.0163
Epoch 546/1000
5/5 [==============================] - 0s 5ms/step - loss: 30.9374
Epoch 547/1000
5/5 [==============================] - 0s 5ms/step - loss: 30.8584
Epoch 548/1000
5/5 [==============================] - 0s 7ms/step - loss: 30.7822
Epoch 549/1000
5/5 [==============================] - 0s 5ms/step - loss: 30.7001
Epoch 550/1000
5/5 [==============================] - 0s 5ms/step - loss: 30.6283
Epoch 551/1000
5/5 [==============================] - 0s 5ms/step - loss: 30.5488
Epoch 552/1000
5/5 [==============================] - 0s 5ms/step - loss: 30.4735
Epoch 553/1000
5/5 [==============================] - 0s 6ms/step - loss: 30.3945
Epoch 554/1000
5/5 [==============================] - 0s 4ms/step - loss: 30.3201
Epoch 555/1000
5/5 [==============================] - 0s 6ms/step - loss: 30.2444
Epoch 556/1000
5/5 [==============================] - 0s 4ms/step - loss: 30.1680
Epoch 557/1000
5/5 [==============================] - 0s 5ms/step - loss: 30.0925
Epoch 558/1000
5/5 [==============================] - 0s 5ms/step - loss: 30.0174
Epoch 559/1000
5/5 [==============================] - 0s 5ms/step - loss: 29.9458
Epoch 560/1000
5/5 [==============================] - 0s 6ms/step - loss: 29.8712
Epoch 561/1000
5/5 [==============================] - 0s 5ms/step - loss: 29.7962
Epoch 562/1000
5/5 [==============================] - 0s 4ms/step - loss: 29.7245
Epoch 563/1000
5/5 [==============================] - 0s 5ms/step - loss: 29.6522
Epoch 564/1000
5/5 [==============================] - 0s 4ms/step - loss: 29.5799
Epoch 565/1000
5/5 [==============================] - 0s 4ms/step - loss: 29.5083
Epoch 566/1000
5/5 [==============================] - 0s 5ms/step - loss: 29.4381
Epoch 567/1000
5/5 [==============================] - 0s 5ms/step - loss: 29.3650
Epoch 568/1000
5/5 [==============================] - 0s 5ms/step - loss: 29.2906
Epoch 569/1000
5/5 [==============================] - 0s 4ms/step - loss: 29.2215
Epoch 570/1000
5/5 [==============================] - 0s 4ms/step - loss: 29.1483
Epoch 571/1000
5/5 [==============================] - 0s 6ms/step - loss: 29.0739
Epoch 572/1000
5/5 [==============================] - 0s 5ms/step - loss: 29.0021
Epoch 573/1000
5/5 [==============================] - 0s 4ms/step - loss: 28.9290
Epoch 574/1000
5/5 [==============================] - 0s 4ms/step - loss: 28.8564
Epoch 575/1000
5/5 [==============================] - 0s 4ms/step - loss: 28.7855
Epoch 576/1000
5/5 [==============================] - 0s 5ms/step - loss: 28.7110
Epoch 577/1000
5/5 [==============================] - 0s 4ms/step - loss: 28.6394
Epoch 578/1000
5/5 [==============================] - 0s 5ms/step - loss: 28.5659
Epoch 579/1000
5/5 [==============================] - 0s 5ms/step - loss: 28.4939
Epoch 580/1000
5/5 [==============================] - 0s 5ms/step - loss: 28.4196
Epoch 581/1000
5/5 [==============================] - 0s 5ms/step - loss: 28.3451
Epoch 582/1000
5/5 [==============================] - 0s 6ms/step - loss: 28.2769
Epoch 583/1000
5/5 [==============================] - 0s 5ms/step - loss: 28.2060
Epoch 584/1000
5/5 [==============================] - 0s 5ms/step - loss: 28.1330
Epoch 585/1000
5/5 [==============================] - 0s 5ms/step - loss: 28.0656
Epoch 586/1000
5/5 [==============================] - 0s 5ms/step - loss: 27.9918
Epoch 587/1000
5/5 [==============================] - 0s 8ms/step - loss: 27.9268
Epoch 588/1000
5/5 [==============================] - 0s 6ms/step - loss: 27.8551
Epoch 589/1000
5/5 [==============================] - 0s 5ms/step - loss: 27.7834
Epoch 590/1000
5/5 [==============================] - 0s 5ms/step - loss: 27.7162
Epoch 591/1000
5/5 [==============================] - 0s 5ms/step - loss: 27.6466
Epoch 592/1000
5/5 [==============================] - 0s 5ms/step - loss: 27.5792
Epoch 593/1000
5/5 [==============================] - 0s 4ms/step - loss: 27.5096
Epoch 594/1000
5/5 [==============================] - 0s 4ms/step - loss: 27.4396
Epoch 595/1000
5/5 [==============================] - 0s 4ms/step - loss: 27.3770
Epoch 596/1000
5/5 [==============================] - 0s 5ms/step - loss: 27.3092
Epoch 597/1000
5/5 [==============================] - 0s 5ms/step - loss: 27.2382
Epoch 598/1000
5/5 [==============================] - 0s 4ms/step - loss: 27.1730
Epoch 599/1000
5/5 [==============================] - 0s 5ms/step - loss: 27.1056
Epoch 600/1000
5/5 [==============================] - 0s 4ms/step - loss: 27.0381
Epoch 601/1000
5/5 [==============================] - 0s 4ms/step - loss: 26.9691
Epoch 602/1000
5/5 [==============================] - 0s 5ms/step - loss: 26.9043
Epoch 603/1000
5/5 [==============================] - 0s 5ms/step - loss: 26.8376
Epoch 604/1000
5/5 [==============================] - 0s 4ms/step - loss: 26.7712
Epoch 605/1000
5/5 [==============================] - 0s 4ms/step - loss: 26.7014
Epoch 606/1000
5/5 [==============================] - 0s 5ms/step - loss: 26.6381
Epoch 607/1000
5/5 [==============================] - 0s 5ms/step - loss: 26.5720
Epoch 608/1000
5/5 [==============================] - 0s 6ms/step - loss: 26.5011
Epoch 609/1000
5/5 [==============================] - 0s 4ms/step - loss: 26.4388
Epoch 610/1000
5/5 [==============================] - 0s 4ms/step - loss: 26.3725
Epoch 611/1000
5/5 [==============================] - 0s 4ms/step - loss: 26.3077
Epoch 612/1000
5/5 [==============================] - 0s 4ms/step - loss: 26.2456
Epoch 613/1000
5/5 [==============================] - 0s 5ms/step - loss: 26.1798
Epoch 614/1000
5/5 [==============================] - 0s 4ms/step - loss: 26.1112
Epoch 615/1000
5/5 [==============================] - 0s 4ms/step - loss: 26.0461
Epoch 616/1000
5/5 [==============================] - 0s 5ms/step - loss: 25.9779
Epoch 617/1000
5/5 [==============================] - 0s 4ms/step - loss: 25.9133
Epoch 618/1000
5/5 [==============================] - 0s 4ms/step - loss: 25.8432
Epoch 619/1000
5/5 [==============================] - 0s 4ms/step - loss: 25.7800
Epoch 620/1000
5/5 [==============================] - 0s 4ms/step - loss: 25.7182
Epoch 621/1000
5/5 [==============================] - 0s 4ms/step - loss: 25.6539
Epoch 622/1000
5/5 [==============================] - 0s 4ms/step - loss: 25.5888
Epoch 623/1000
5/5 [==============================] - 0s 4ms/step - loss: 25.5322
Epoch 624/1000
5/5 [==============================] - 0s 5ms/step - loss: 25.4698
Epoch 625/1000
5/5 [==============================] - 0s 4ms/step - loss: 25.4075
Epoch 626/1000
5/5 [==============================] - 0s 4ms/step - loss: 25.3453
Epoch 627/1000
5/5 [==============================] - 0s 4ms/step - loss: 25.2828
Epoch 628/1000
5/5 [==============================] - 0s 4ms/step - loss: 25.2210
Epoch 629/1000
5/5 [==============================] - 0s 4ms/step - loss: 25.1583
Epoch 630/1000
5/5 [==============================] - 0s 6ms/step - loss: 25.0965
Epoch 631/1000
5/5 [==============================] - 0s 5ms/step - loss: 25.0364
Epoch 632/1000
5/5 [==============================] - 0s 4ms/step - loss: 24.9744
Epoch 633/1000
5/5 [==============================] - 0s 4ms/step - loss: 24.9118
Epoch 634/1000
5/5 [==============================] - 0s 4ms/step - loss: 24.8497
Epoch 635/1000
5/5 [==============================] - 0s 5ms/step - loss: 24.7894
Epoch 636/1000
5/5 [==============================] - 0s 4ms/step - loss: 24.7274
Epoch 637/1000
5/5 [==============================] - 0s 4ms/step - loss: 24.6661
Epoch 638/1000
5/5 [==============================] - 0s 4ms/step - loss: 24.6014
Epoch 639/1000
5/5 [==============================] - 0s 5ms/step - loss: 24.5450
Epoch 640/1000
5/5 [==============================] - 0s 4ms/step - loss: 24.4826
Epoch 641/1000
5/5 [==============================] - 0s 4ms/step - loss: 24.4204
Epoch 642/1000
5/5 [==============================] - 0s 4ms/step - loss: 24.3599
Epoch 643/1000
5/5 [==============================] - 0s 4ms/step - loss: 24.2974
Epoch 644/1000
5/5 [==============================] - 0s 4ms/step - loss: 24.2401
Epoch 645/1000
5/5 [==============================] - 0s 5ms/step - loss: 24.1785
Epoch 646/1000
5/5 [==============================] - 0s 4ms/step - loss: 24.1187
Epoch 647/1000
5/5 [==============================] - 0s 5ms/step - loss: 24.0647
Epoch 648/1000
5/5 [==============================] - 0s 4ms/step - loss: 23.9968
Epoch 649/1000
5/5 [==============================] - 0s 4ms/step - loss: 23.9405
Epoch 650/1000
5/5 [==============================] - 0s 4ms/step - loss: 23.8835
Epoch 651/1000
5/5 [==============================] - 0s 4ms/step - loss: 23.8229
Epoch 652/1000
5/5 [==============================] - 0s 4ms/step - loss: 23.7650
Epoch 653/1000
5/5 [==============================] - 0s 4ms/step - loss: 23.7102
Epoch 654/1000
5/5 [==============================] - 0s 4ms/step - loss: 23.6512
Epoch 655/1000
5/5 [==============================] - 0s 4ms/step - loss: 23.5948
Epoch 656/1000
5/5 [==============================] - 0s 4ms/step - loss: 23.5357
Epoch 657/1000
5/5 [==============================] - 0s 4ms/step - loss: 23.4748
Epoch 658/1000
5/5 [==============================] - 0s 4ms/step - loss: 23.4178
Epoch 659/1000
5/5 [==============================] - 0s 4ms/step - loss: 23.3566
Epoch 660/1000
5/5 [==============================] - 0s 4ms/step - loss: 23.2999
Epoch 661/1000
5/5 [==============================] - 0s 4ms/step - loss: 23.2418
Epoch 662/1000
5/5 [==============================] - 0s 4ms/step - loss: 23.1838
Epoch 663/1000
5/5 [==============================] - 0s 4ms/step - loss: 23.1242
Epoch 664/1000
5/5 [==============================] - 0s 4ms/step - loss: 23.0704
Epoch 665/1000
5/5 [==============================] - 0s 4ms/step - loss: 23.0129
Epoch 666/1000
5/5 [==============================] - 0s 4ms/step - loss: 22.9543
Epoch 667/1000
5/5 [==============================] - 0s 4ms/step - loss: 22.9018
Epoch 668/1000
5/5 [==============================] - 0s 4ms/step - loss: 22.8433
Epoch 669/1000
5/5 [==============================] - 0s 4ms/step - loss: 22.7890
Epoch 670/1000
5/5 [==============================] - 0s 4ms/step - loss: 22.7336
Epoch 671/1000
5/5 [==============================] - 0s 3ms/step - loss: 22.6772
Epoch 672/1000
5/5 [==============================] - 0s 5ms/step - loss: 22.6222
Epoch 673/1000
5/5 [==============================] - 0s 4ms/step - loss: 22.5660
Epoch 674/1000
5/5 [==============================] - 0s 5ms/step - loss: 22.5096
Epoch 675/1000
5/5 [==============================] - 0s 4ms/step - loss: 22.4520
Epoch 676/1000
5/5 [==============================] - 0s 4ms/step - loss: 22.3993
Epoch 677/1000
5/5 [==============================] - 0s 5ms/step - loss: 22.3445
Epoch 678/1000
5/5 [==============================] - 0s 4ms/step - loss: 22.2849
Epoch 679/1000
5/5 [==============================] - 0s 5ms/step - loss: 22.2329
Epoch 680/1000
5/5 [==============================] - 0s 4ms/step - loss: 22.1730
Epoch 681/1000
5/5 [==============================] - 0s 4ms/step - loss: 22.1222
Epoch 682/1000
5/5 [==============================] - 0s 4ms/step - loss: 22.0637
Epoch 683/1000
5/5 [==============================] - 0s 4ms/step - loss: 22.0129
Epoch 684/1000
5/5 [==============================] - 0s 4ms/step - loss: 21.9549
Epoch 685/1000
5/5 [==============================] - 0s 4ms/step - loss: 21.9017
Epoch 686/1000
5/5 [==============================] - 0s 4ms/step - loss: 21.8466
Epoch 687/1000
5/5 [==============================] - 0s 4ms/step - loss: 21.7943
Epoch 688/1000
5/5 [==============================] - 0s 4ms/step - loss: 21.7382
Epoch 689/1000
5/5 [==============================] - 0s 4ms/step - loss: 21.6870
Epoch 690/1000
5/5 [==============================] - 0s 4ms/step - loss: 21.6327
Epoch 691/1000
5/5 [==============================] - 0s 4ms/step - loss: 21.5814
Epoch 692/1000
5/5 [==============================] - 0s 4ms/step - loss: 21.5298
Epoch 693/1000
5/5 [==============================] - 0s 4ms/step - loss: 21.4793
Epoch 694/1000
5/5 [==============================] - 0s 4ms/step - loss: 21.4253
Epoch 695/1000
5/5 [==============================] - 0s 4ms/step - loss: 21.3740
Epoch 696/1000
5/5 [==============================] - 0s 4ms/step - loss: 21.3258
Epoch 697/1000
5/5 [==============================] - 0s 3ms/step - loss: 21.2724
Epoch 698/1000
5/5 [==============================] - 0s 4ms/step - loss: 21.2199
Epoch 699/1000
5/5 [==============================] - 0s 4ms/step - loss: 21.1677
Epoch 700/1000
5/5 [==============================] - 0s 4ms/step - loss: 21.1189
Epoch 701/1000
5/5 [==============================] - 0s 4ms/step - loss: 21.0677
Epoch 702/1000
5/5 [==============================] - 0s 4ms/step - loss: 21.0157
Epoch 703/1000
5/5 [==============================] - 0s 4ms/step - loss: 20.9669
Epoch 704/1000
5/5 [==============================] - 0s 4ms/step - loss: 20.9148
Epoch 705/1000
5/5 [==============================] - 0s 4ms/step - loss: 20.8642
Epoch 706/1000
5/5 [==============================] - 0s 4ms/step - loss: 20.8117
Epoch 707/1000
5/5 [==============================] - 0s 4ms/step - loss: 20.7637
Epoch 708/1000
5/5 [==============================] - 0s 4ms/step - loss: 20.7118
Epoch 709/1000
5/5 [==============================] - 0s 4ms/step - loss: 20.6631
Epoch 710/1000
5/5 [==============================] - 0s 4ms/step - loss: 20.6139
Epoch 711/1000
5/5 [==============================] - 0s 4ms/step - loss: 20.5660
Epoch 712/1000
5/5 [==============================] - 0s 4ms/step - loss: 20.5182
Epoch 713/1000
5/5 [==============================] - 0s 4ms/step - loss: 20.4726
Epoch 714/1000
5/5 [==============================] - 0s 4ms/step - loss: 20.4229
Epoch 715/1000
5/5 [==============================] - 0s 5ms/step - loss: 20.3765
Epoch 716/1000
5/5 [==============================] - 0s 4ms/step - loss: 20.3263
Epoch 717/1000
5/5 [==============================] - 0s 4ms/step - loss: 20.2788
Epoch 718/1000
5/5 [==============================] - 0s 4ms/step - loss: 20.2285
Epoch 719/1000
5/5 [==============================] - 0s 5ms/step - loss: 20.1772
Epoch 720/1000
5/5 [==============================] - 0s 4ms/step - loss: 20.1296
Epoch 721/1000
5/5 [==============================] - 0s 4ms/step - loss: 20.0787
Epoch 722/1000
5/5 [==============================] - 0s 5ms/step - loss: 20.0297
Epoch 723/1000
5/5 [==============================] - 0s 4ms/step - loss: 19.9842
Epoch 724/1000
5/5 [==============================] - 0s 4ms/step - loss: 19.9311
Epoch 725/1000
5/5 [==============================] - 0s 4ms/step - loss: 19.8837
Epoch 726/1000
5/5 [==============================] - 0s 5ms/step - loss: 19.8337
Epoch 727/1000
5/5 [==============================] - 0s 5ms/step - loss: 19.7892
Epoch 728/1000
5/5 [==============================] - 0s 4ms/step - loss: 19.7411
Epoch 729/1000
5/5 [==============================] - 0s 4ms/step - loss: 19.6975
Epoch 730/1000
5/5 [==============================] - 0s 4ms/step - loss: 19.6529
Epoch 731/1000
5/5 [==============================] - 0s 4ms/step - loss: 19.6085
Epoch 732/1000
5/5 [==============================] - 0s 4ms/step - loss: 19.5596
Epoch 733/1000
5/5 [==============================] - 0s 4ms/step - loss: 19.5153
Epoch 734/1000
5/5 [==============================] - 0s 4ms/step - loss: 19.4715
Epoch 735/1000
5/5 [==============================] - 0s 4ms/step - loss: 19.4245
Epoch 736/1000
5/5 [==============================] - 0s 4ms/step - loss: 19.3801
Epoch 737/1000
5/5 [==============================] - 0s 4ms/step - loss: 19.3360
Epoch 738/1000
5/5 [==============================] - 0s 4ms/step - loss: 19.2912
Epoch 739/1000
5/5 [==============================] - 0s 4ms/step - loss: 19.2477
Epoch 740/1000
5/5 [==============================] - 0s 4ms/step - loss: 19.2046
Epoch 741/1000
5/5 [==============================] - 0s 4ms/step - loss: 19.1574
Epoch 742/1000
5/5 [==============================] - 0s 5ms/step - loss: 19.1171
Epoch 743/1000
5/5 [==============================] - 0s 4ms/step - loss: 19.0719
Epoch 744/1000
5/5 [==============================] - 0s 4ms/step - loss: 19.0285
Epoch 745/1000
5/5 [==============================] - 0s 5ms/step - loss: 18.9849
Epoch 746/1000
5/5 [==============================] - 0s 4ms/step - loss: 18.9404
Epoch 747/1000
5/5 [==============================] - 0s 5ms/step - loss: 18.8968
Epoch 748/1000
5/5 [==============================] - 0s 4ms/step - loss: 18.8528
Epoch 749/1000
5/5 [==============================] - 0s 4ms/step - loss: 18.8114
Epoch 750/1000
5/5 [==============================] - 0s 4ms/step - loss: 18.7648
Epoch 751/1000
5/5 [==============================] - 0s 4ms/step - loss: 18.7215
Epoch 752/1000
5/5 [==============================] - 0s 4ms/step - loss: 18.6781
Epoch 753/1000
5/5 [==============================] - 0s 4ms/step - loss: 18.6329
Epoch 754/1000
5/5 [==============================] - 0s 4ms/step - loss: 18.5904
Epoch 755/1000
5/5 [==============================] - 0s 4ms/step - loss: 18.5466
Epoch 756/1000
5/5 [==============================] - 0s 4ms/step - loss: 18.5034
Epoch 757/1000
5/5 [==============================] - 0s 4ms/step - loss: 18.4576
Epoch 758/1000
5/5 [==============================] - 0s 4ms/step - loss: 18.4149
Epoch 759/1000
5/5 [==============================] - 0s 4ms/step - loss: 18.3709
Epoch 760/1000
5/5 [==============================] - 0s 5ms/step - loss: 18.3308
Epoch 761/1000
5/5 [==============================] - 0s 6ms/step - loss: 18.2876
Epoch 762/1000
5/5 [==============================] - 0s 5ms/step - loss: 18.2470
Epoch 763/1000
5/5 [==============================] - 0s 4ms/step - loss: 18.2037
Epoch 764/1000
5/5 [==============================] - 0s 4ms/step - loss: 18.1628
Epoch 765/1000
5/5 [==============================] - 0s 4ms/step - loss: 18.1210
Epoch 766/1000
5/5 [==============================] - 0s 4ms/step - loss: 18.0808
Epoch 767/1000
5/5 [==============================] - 0s 6ms/step - loss: 18.0376
Epoch 768/1000
5/5 [==============================] - 0s 4ms/step - loss: 17.9990
Epoch 769/1000
5/5 [==============================] - 0s 5ms/step - loss: 17.9573
Epoch 770/1000
5/5 [==============================] - 0s 4ms/step - loss: 17.9145
Epoch 771/1000
5/5 [==============================] - 0s 4ms/step - loss: 17.8727
Epoch 772/1000
5/5 [==============================] - 0s 4ms/step - loss: 17.8322
Epoch 773/1000
5/5 [==============================] - 0s 4ms/step - loss: 17.7922
Epoch 774/1000
5/5 [==============================] - 0s 4ms/step - loss: 17.7527
Epoch 775/1000
5/5 [==============================] - 0s 5ms/step - loss: 17.7128
Epoch 776/1000
5/5 [==============================] - 0s 4ms/step - loss: 17.6747
Epoch 777/1000
5/5 [==============================] - 0s 4ms/step - loss: 17.6327
Epoch 778/1000
5/5 [==============================] - 0s 4ms/step - loss: 17.5915
Epoch 779/1000
5/5 [==============================] - 0s 4ms/step - loss: 17.5535
Epoch 780/1000
5/5 [==============================] - 0s 5ms/step - loss: 17.5148
Epoch 781/1000
5/5 [==============================] - 0s 4ms/step - loss: 17.4732
Epoch 782/1000
5/5 [==============================] - 0s 4ms/step - loss: 17.4351
Epoch 783/1000
5/5 [==============================] - 0s 4ms/step - loss: 17.3966
Epoch 784/1000
5/5 [==============================] - 0s 4ms/step - loss: 17.3589
Epoch 785/1000
5/5 [==============================] - 0s 4ms/step - loss: 17.3195
Epoch 786/1000
5/5 [==============================] - 0s 4ms/step - loss: 17.2806
Epoch 787/1000
5/5 [==============================] - 0s 4ms/step - loss: 17.2435
Epoch 788/1000
5/5 [==============================] - 0s 4ms/step - loss: 17.2042
Epoch 789/1000
5/5 [==============================] - 0s 4ms/step - loss: 17.1644
Epoch 790/1000
5/5 [==============================] - 0s 7ms/step - loss: 17.1272
Epoch 791/1000
5/5 [==============================] - 0s 4ms/step - loss: 17.0902
Epoch 792/1000
5/5 [==============================] - 0s 4ms/step - loss: 17.0499
Epoch 793/1000
5/5 [==============================] - 0s 5ms/step - loss: 17.0135
Epoch 794/1000
5/5 [==============================] - 0s 5ms/step - loss: 16.9723
Epoch 795/1000
5/5 [==============================] - 0s 5ms/step - loss: 16.9364
Epoch 796/1000
5/5 [==============================] - 0s 4ms/step - loss: 16.8968
Epoch 797/1000
5/5 [==============================] - 0s 4ms/step - loss: 16.8590
Epoch 798/1000
5/5 [==============================] - 0s 5ms/step - loss: 16.8213
Epoch 799/1000
5/5 [==============================] - 0s 5ms/step - loss: 16.7827
Epoch 800/1000
5/5 [==============================] - 0s 6ms/step - loss: 16.7473
Epoch 801/1000
5/5 [==============================] - 0s 4ms/step - loss: 16.7087
Epoch 802/1000
5/5 [==============================] - 0s 5ms/step - loss: 16.6713
Epoch 803/1000
5/5 [==============================] - 0s 5ms/step - loss: 16.6355
Epoch 804/1000
5/5 [==============================] - 0s 5ms/step - loss: 16.5973
Epoch 805/1000
5/5 [==============================] - 0s 4ms/step - loss: 16.5621
Epoch 806/1000
5/5 [==============================] - 0s 4ms/step - loss: 16.5261
Epoch 807/1000
5/5 [==============================] - 0s 4ms/step - loss: 16.4891
Epoch 808/1000
5/5 [==============================] - 0s 4ms/step - loss: 16.4557
Epoch 809/1000
5/5 [==============================] - 0s 4ms/step - loss: 16.4184
Epoch 810/1000
5/5 [==============================] - 0s 4ms/step - loss: 16.3851
Epoch 811/1000
5/5 [==============================] - 0s 4ms/step - loss: 16.3494
Epoch 812/1000
5/5 [==============================] - 0s 4ms/step - loss: 16.3170
Epoch 813/1000
5/5 [==============================] - 0s 4ms/step - loss: 16.2836
Epoch 814/1000
5/5 [==============================] - 0s 4ms/step - loss: 16.2497
Epoch 815/1000
5/5 [==============================] - 0s 4ms/step - loss: 16.2143
Epoch 816/1000
5/5 [==============================] - 0s 4ms/step - loss: 16.1805
Epoch 817/1000
5/5 [==============================] - 0s 4ms/step - loss: 16.1487
Epoch 818/1000
5/5 [==============================] - 0s 5ms/step - loss: 16.1131
Epoch 819/1000
5/5 [==============================] - 0s 5ms/step - loss: 16.0810
Epoch 820/1000
5/5 [==============================] - 0s 5ms/step - loss: 16.0450
Epoch 821/1000
5/5 [==============================] - 0s 5ms/step - loss: 16.0117
Epoch 822/1000
5/5 [==============================] - 0s 4ms/step - loss: 15.9790
Epoch 823/1000
5/5 [==============================] - 0s 4ms/step - loss: 15.9432
Epoch 824/1000
5/5 [==============================] - 0s 5ms/step - loss: 15.9103
Epoch 825/1000
5/5 [==============================] - 0s 4ms/step - loss: 15.8774
Epoch 826/1000
5/5 [==============================] - 0s 5ms/step - loss: 15.8420
Epoch 827/1000
5/5 [==============================] - 0s 5ms/step - loss: 15.8084
Epoch 828/1000
5/5 [==============================] - 0s 5ms/step - loss: 15.7753
Epoch 829/1000
5/5 [==============================] - 0s 4ms/step - loss: 15.7433
Epoch 830/1000
5/5 [==============================] - 0s 4ms/step - loss: 15.7075
Epoch 831/1000
5/5 [==============================] - 0s 4ms/step - loss: 15.6762
Epoch 832/1000
5/5 [==============================] - 0s 4ms/step - loss: 15.6431
Epoch 833/1000
5/5 [==============================] - 0s 5ms/step - loss: 15.6102
Epoch 834/1000
5/5 [==============================] - 0s 4ms/step - loss: 15.5775
Epoch 835/1000
5/5 [==============================] - 0s 4ms/step - loss: 15.5461
Epoch 836/1000
5/5 [==============================] - 0s 4ms/step - loss: 15.5122
Epoch 837/1000
5/5 [==============================] - 0s 5ms/step - loss: 15.4812
Epoch 838/1000
5/5 [==============================] - 0s 4ms/step - loss: 15.4486
Epoch 839/1000
5/5 [==============================] - 0s 5ms/step - loss: 15.4148
Epoch 840/1000
5/5 [==============================] - 0s 5ms/step - loss: 15.3823
Epoch 841/1000
5/5 [==============================] - 0s 4ms/step - loss: 15.3497
Epoch 842/1000
5/5 [==============================] - 0s 4ms/step - loss: 15.3188
Epoch 843/1000
5/5 [==============================] - 0s 4ms/step - loss: 15.2887
Epoch 844/1000
5/5 [==============================] - 0s 5ms/step - loss: 15.2593
Epoch 845/1000
5/5 [==============================] - 0s 5ms/step - loss: 15.2279
Epoch 846/1000
5/5 [==============================] - 0s 4ms/step - loss: 15.1976
Epoch 847/1000
5/5 [==============================] - 0s 5ms/step - loss: 15.1683
Epoch 848/1000
5/5 [==============================] - 0s 4ms/step - loss: 15.1384
Epoch 849/1000
5/5 [==============================] - 0s 4ms/step - loss: 15.1088
Epoch 850/1000
5/5 [==============================] - 0s 4ms/step - loss: 15.0790
Epoch 851/1000
5/5 [==============================] - 0s 4ms/step - loss: 15.0501
Epoch 852/1000
5/5 [==============================] - 0s 4ms/step - loss: 15.0181
Epoch 853/1000
5/5 [==============================] - 0s 5ms/step - loss: 14.9893
Epoch 854/1000
5/5 [==============================] - 0s 5ms/step - loss: 14.9603
Epoch 855/1000
5/5 [==============================] - 0s 4ms/step - loss: 14.9315
Epoch 856/1000
5/5 [==============================] - 0s 5ms/step - loss: 14.9007
Epoch 857/1000
5/5 [==============================] - 0s 4ms/step - loss: 14.8717
Epoch 858/1000
5/5 [==============================] - 0s 5ms/step - loss: 14.8432
Epoch 859/1000
5/5 [==============================] - 0s 4ms/step - loss: 14.8141
Epoch 860/1000
5/5 [==============================] - 0s 5ms/step - loss: 14.7878
Epoch 861/1000
5/5 [==============================] - 0s 4ms/step - loss: 14.7549
Epoch 862/1000
5/5 [==============================] - 0s 4ms/step - loss: 14.7251
Epoch 863/1000
5/5 [==============================] - 0s 4ms/step - loss: 14.6958
Epoch 864/1000
5/5 [==============================] - 0s 4ms/step - loss: 14.6679
Epoch 865/1000
5/5 [==============================] - 0s 4ms/step - loss: 14.6372
Epoch 866/1000
5/5 [==============================] - 0s 4ms/step - loss: 14.6066
Epoch 867/1000
5/5 [==============================] - 0s 4ms/step - loss: 14.5777
Epoch 868/1000
5/5 [==============================] - 0s 5ms/step - loss: 14.5464
Epoch 869/1000
5/5 [==============================] - 0s 5ms/step - loss: 14.5178
Epoch 870/1000
5/5 [==============================] - 0s 5ms/step - loss: 14.4886
Epoch 871/1000
5/5 [==============================] - 0s 5ms/step - loss: 14.4583
Epoch 872/1000
5/5 [==============================] - 0s 4ms/step - loss: 14.4269
Epoch 873/1000
5/5 [==============================] - 0s 5ms/step - loss: 14.4006
Epoch 874/1000
5/5 [==============================] - 0s 5ms/step - loss: 14.3709
Epoch 875/1000
5/5 [==============================] - 0s 4ms/step - loss: 14.3406
Epoch 876/1000
5/5 [==============================] - 0s 5ms/step - loss: 14.3137
Epoch 877/1000
5/5 [==============================] - 0s 4ms/step - loss: 14.2828
Epoch 878/1000
5/5 [==============================] - 0s 5ms/step - loss: 14.2540
Epoch 879/1000
5/5 [==============================] - 0s 5ms/step - loss: 14.2294
Epoch 880/1000
5/5 [==============================] - 0s 5ms/step - loss: 14.2012
Epoch 881/1000
5/5 [==============================] - 0s 5ms/step - loss: 14.1744
Epoch 882/1000
5/5 [==============================] - 0s 4ms/step - loss: 14.1492
Epoch 883/1000
5/5 [==============================] - 0s 4ms/step - loss: 14.1223
Epoch 884/1000
5/5 [==============================] - 0s 4ms/step - loss: 14.0976
Epoch 885/1000
5/5 [==============================] - 0s 4ms/step - loss: 14.0702
Epoch 886/1000
5/5 [==============================] - 0s 4ms/step - loss: 14.0455
Epoch 887/1000
5/5 [==============================] - 0s 4ms/step - loss: 14.0173
Epoch 888/1000
5/5 [==============================] - 0s 5ms/step - loss: 13.9909
Epoch 889/1000
5/5 [==============================] - 0s 4ms/step - loss: 13.9662
Epoch 890/1000
5/5 [==============================] - 0s 5ms/step - loss: 13.9401
Epoch 891/1000
5/5 [==============================] - 0s 4ms/step - loss: 13.9123
Epoch 892/1000
5/5 [==============================] - 0s 4ms/step - loss: 13.8879
Epoch 893/1000
5/5 [==============================] - 0s 5ms/step - loss: 13.8615
Epoch 894/1000
5/5 [==============================] - 0s 4ms/step - loss: 13.8345
Epoch 895/1000
5/5 [==============================] - 0s 5ms/step - loss: 13.8085
Epoch 896/1000
5/5 [==============================] - 0s 4ms/step - loss: 13.7844
Epoch 897/1000
5/5 [==============================] - 0s 5ms/step - loss: 13.7580
Epoch 898/1000
5/5 [==============================] - 0s 4ms/step - loss: 13.7312
Epoch 899/1000
5/5 [==============================] - 0s 4ms/step - loss: 13.7062
Epoch 900/1000
5/5 [==============================] - 0s 4ms/step - loss: 13.6777
Epoch 901/1000
5/5 [==============================] - 0s 4ms/step - loss: 13.6538
Epoch 902/1000
5/5 [==============================] - 0s 4ms/step - loss: 13.6265
Epoch 903/1000
5/5 [==============================] - 0s 5ms/step - loss: 13.6034
Epoch 904/1000
5/5 [==============================] - 0s 4ms/step - loss: 13.5778
Epoch 905/1000
5/5 [==============================] - 0s 5ms/step - loss: 13.5521
Epoch 906/1000
5/5 [==============================] - 0s 4ms/step - loss: 13.5253
Epoch 907/1000
5/5 [==============================] - 0s 4ms/step - loss: 13.5041
Epoch 908/1000
5/5 [==============================] - 0s 5ms/step - loss: 13.4790
Epoch 909/1000
5/5 [==============================] - 0s 4ms/step - loss: 13.4532
Epoch 910/1000
5/5 [==============================] - 0s 4ms/step - loss: 13.4305
Epoch 911/1000
5/5 [==============================] - 0s 4ms/step - loss: 13.4080
Epoch 912/1000
5/5 [==============================] - 0s 4ms/step - loss: 13.3839
Epoch 913/1000
5/5 [==============================] - 0s 4ms/step - loss: 13.3604
Epoch 914/1000
5/5 [==============================] - 0s 4ms/step - loss: 13.3384
Epoch 915/1000
5/5 [==============================] - 0s 4ms/step - loss: 13.3132
Epoch 916/1000
5/5 [==============================] - 0s 5ms/step - loss: 13.2904
Epoch 917/1000
5/5 [==============================] - 0s 5ms/step - loss: 13.2656
Epoch 918/1000
5/5 [==============================] - 0s 5ms/step - loss: 13.2435
Epoch 919/1000
5/5 [==============================] - 0s 5ms/step - loss: 13.2204
Epoch 920/1000
5/5 [==============================] - 0s 5ms/step - loss: 13.1998
Epoch 921/1000
5/5 [==============================] - 0s 4ms/step - loss: 13.1765
Epoch 922/1000
5/5 [==============================] - 0s 5ms/step - loss: 13.1545
Epoch 923/1000
5/5 [==============================] - 0s 5ms/step - loss: 13.1336
Epoch 924/1000
5/5 [==============================] - 0s 6ms/step - loss: 13.1085
Epoch 925/1000
5/5 [==============================] - 0s 5ms/step - loss: 13.0871
Epoch 926/1000
5/5 [==============================] - 0s 5ms/step - loss: 13.0648
Epoch 927/1000
5/5 [==============================] - 0s 4ms/step - loss: 13.0433
Epoch 928/1000
5/5 [==============================] - 0s 4ms/step - loss: 13.0205
Epoch 929/1000
5/5 [==============================] - 0s 4ms/step - loss: 13.0012
Epoch 930/1000
5/5 [==============================] - 0s 4ms/step - loss: 12.9775
Epoch 931/1000
5/5 [==============================] - 0s 4ms/step - loss: 12.9545
Epoch 932/1000
5/5 [==============================] - 0s 4ms/step - loss: 12.9339
Epoch 933/1000
5/5 [==============================] - 0s 4ms/step - loss: 12.9135
Epoch 934/1000
5/5 [==============================] - 0s 4ms/step - loss: 12.8928
Epoch 935/1000
5/5 [==============================] - 0s 5ms/step - loss: 12.8698
Epoch 936/1000
5/5 [==============================] - 0s 5ms/step - loss: 12.8485
Epoch 937/1000
5/5 [==============================] - 0s 5ms/step - loss: 12.8285
Epoch 938/1000
5/5 [==============================] - 0s 5ms/step - loss: 12.8063
Epoch 939/1000
5/5 [==============================] - 0s 4ms/step - loss: 12.7837
Epoch 940/1000
5/5 [==============================] - 0s 4ms/step - loss: 12.7615
Epoch 941/1000
5/5 [==============================] - 0s 4ms/step - loss: 12.7387
Epoch 942/1000
5/5 [==============================] - 0s 5ms/step - loss: 12.7165
Epoch 943/1000
5/5 [==============================] - 0s 4ms/step - loss: 12.6954
Epoch 944/1000
5/5 [==============================] - 0s 4ms/step - loss: 12.6738
Epoch 945/1000
5/5 [==============================] - 0s 5ms/step - loss: 12.6491
Epoch 946/1000
5/5 [==============================] - 0s 5ms/step - loss: 12.6287
Epoch 947/1000
5/5 [==============================] - 0s 5ms/step - loss: 12.6080
Epoch 948/1000
5/5 [==============================] - 0s 4ms/step - loss: 12.5878
Epoch 949/1000
5/5 [==============================] - 0s 4ms/step - loss: 12.5661
Epoch 950/1000
5/5 [==============================] - 0s 4ms/step - loss: 12.5463
Epoch 951/1000
5/5 [==============================] - 0s 5ms/step - loss: 12.5268
Epoch 952/1000
5/5 [==============================] - 0s 4ms/step - loss: 12.5058
Epoch 953/1000
5/5 [==============================] - 0s 4ms/step - loss: 12.4866
Epoch 954/1000
5/5 [==============================] - 0s 6ms/step - loss: 12.4691
Epoch 955/1000
5/5 [==============================] - 0s 6ms/step - loss: 12.4456
Epoch 956/1000
5/5 [==============================] - 0s 4ms/step - loss: 12.4269
Epoch 957/1000
5/5 [==============================] - 0s 5ms/step - loss: 12.4066
Epoch 958/1000
5/5 [==============================] - 0s 5ms/step - loss: 12.3865
Epoch 959/1000
5/5 [==============================] - 0s 5ms/step - loss: 12.3668
Epoch 960/1000
5/5 [==============================] - 0s 5ms/step - loss: 12.3471
Epoch 961/1000
5/5 [==============================] - 0s 4ms/step - loss: 12.3278
Epoch 962/1000
5/5 [==============================] - 0s 5ms/step - loss: 12.3070
Epoch 963/1000
5/5 [==============================] - 0s 4ms/step - loss: 12.2914
Epoch 964/1000
5/5 [==============================] - 0s 4ms/step - loss: 12.2710
Epoch 965/1000
5/5 [==============================] - 0s 4ms/step - loss: 12.2539
Epoch 966/1000
5/5 [==============================] - 0s 4ms/step - loss: 12.2342
Epoch 967/1000
5/5 [==============================] - 0s 4ms/step - loss: 12.2169
Epoch 968/1000
5/5 [==============================] - 0s 4ms/step - loss: 12.1991
Epoch 969/1000
5/5 [==============================] - 0s 4ms/step - loss: 12.1802
Epoch 970/1000
5/5 [==============================] - 0s 4ms/step - loss: 12.1609
Epoch 971/1000
5/5 [==============================] - 0s 4ms/step - loss: 12.1426
Epoch 972/1000
5/5 [==============================] - 0s 4ms/step - loss: 12.1249
Epoch 973/1000
5/5 [==============================] - 0s 5ms/step - loss: 12.1083
Epoch 974/1000
5/5 [==============================] - 0s 4ms/step - loss: 12.0897
Epoch 975/1000
5/5 [==============================] - 0s 5ms/step - loss: 12.0725
Epoch 976/1000
5/5 [==============================] - 0s 5ms/step - loss: 12.0546
Epoch 977/1000
5/5 [==============================] - 0s 5ms/step - loss: 12.0373
Epoch 978/1000
5/5 [==============================] - 0s 5ms/step - loss: 12.0178
Epoch 979/1000
5/5 [==============================] - 0s 6ms/step - loss: 12.0016
Epoch 980/1000
5/5 [==============================] - 0s 6ms/step - loss: 11.9824
Epoch 981/1000
5/5 [==============================] - 0s 6ms/step - loss: 11.9669
Epoch 982/1000
5/5 [==============================] - 0s 5ms/step - loss: 11.9476
Epoch 983/1000
5/5 [==============================] - 0s 5ms/step - loss: 11.9313
Epoch 984/1000
5/5 [==============================] - 0s 4ms/step - loss: 11.9138
Epoch 985/1000
5/5 [==============================] - 0s 4ms/step - loss: 11.8972
Epoch 986/1000
5/5 [==============================] - 0s 6ms/step - loss: 11.8816
Epoch 987/1000
5/5 [==============================] - 0s 5ms/step - loss: 11.8637
Epoch 988/1000
5/5 [==============================] - 0s 6ms/step - loss: 11.8482
Epoch 989/1000
5/5 [==============================] - 0s 5ms/step - loss: 11.8293
Epoch 990/1000
5/5 [==============================] - 0s 5ms/step - loss: 11.8132
Epoch 991/1000
5/5 [==============================] - 0s 5ms/step - loss: 11.7973
Epoch 992/1000
5/5 [==============================] - 0s 6ms/step - loss: 11.7813
Epoch 993/1000
5/5 [==============================] - 0s 5ms/step - loss: 11.7659
Epoch 994/1000
5/5 [==============================] - 0s 6ms/step - loss: 11.7494
Epoch 995/1000
5/5 [==============================] - 0s 5ms/step - loss: 11.7349
Epoch 996/1000
5/5 [==============================] - 0s 5ms/step - loss: 11.7208
Epoch 997/1000
5/5 [==============================] - 0s 4ms/step - loss: 11.7033
Epoch 998/1000
5/5 [==============================] - 0s 5ms/step - loss: 11.6881
Epoch 999/1000
5/5 [==============================] - 0s 5ms/step - loss: 11.6716
Epoch 1000/1000
5/5 [==============================] - 0s 5ms/step - loss: 11.6556</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>WARNING:tensorflow:6 out of the last 11 calls to &lt;function Model.make_predict_function.&lt;locals&gt;.predict_function at 0x7dde4c3111b0&gt; triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has reduce_retracing=True option that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.</code></pre>
</div>
</div>
<p><code>-</code> epoch을 1000번쯤 셋팅하니 잘 예측한다..</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:1183,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1696308539742,&quot;user&quot;:{&quot;displayName&quot;:&quot;ccc flkwerkdai&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-outputid="5aff9e07-d308-4d07-bb3f-966fec97c203" data-execution_count="165">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1"></a>plt.figure(figsize <span class="op">=</span> (<span class="dv">12</span>,<span class="dv">4</span>))</span>
<span id="cb40-2"><a href="#cb40-2"></a>plt.plot(y_test,label <span class="op">=</span> <span class="vs">r"$y_</span><span class="sc">{test}</span><span class="vs">$"</span>,alpha <span class="op">=</span> <span class="fl">0.5</span>)</span>
<span id="cb40-3"><a href="#cb40-3"></a>plt.plot(y_pred_init,label <span class="op">=</span> <span class="vs">r"$\hat </span><span class="sc">{y}</span><span class="vs">_</span><span class="sc">{init}</span><span class="vs">$"</span>,alpha <span class="op">=</span> <span class="fl">0.6</span>)</span>
<span id="cb40-4"><a href="#cb40-4"></a>plt.plot(y_pred_5,label <span class="op">=</span> <span class="vs">r"$\hat </span><span class="sc">{y}</span><span class="vs">_</span><span class="sc">{5}</span><span class="vs">$"</span>,alpha <span class="op">=</span> <span class="fl">0.6</span>)</span>
<span id="cb40-5"><a href="#cb40-5"></a>plt.plot(y_pred_final,label <span class="op">=</span> <span class="vs">r"$\hat </span><span class="sc">{y}</span><span class="vs">_</span><span class="sc">{final}</span><span class="vs">$"</span>,alpha <span class="op">=</span> <span class="fl">0.6</span>)</span>
<span id="cb40-6"><a href="#cb40-6"></a>plt.title(<span class="vs">r"($y_</span><span class="sc">{test}</span><span class="vs">, \hat </span><span class="sc">{y}</span><span class="vs">_</span><span class="sc">{init}</span><span class="vs">, \hat </span><span class="sc">{y}</span><span class="vs">_</span><span class="sc">{5}</span><span class="vs">,\hat </span><span class="sc">{y}</span><span class="vs">_</span><span class="sc">{final}</span><span class="vs">$)"</span>)</span>
<span id="cb40-7"><a href="#cb40-7"></a>plt.legend()</span>
<span id="cb40-8"><a href="#cb40-8"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="2023-10-03-00. 딥러닝 (1)_files/figure-html/cell-30-output-1.png" class="img-fluid"></p>
</div>
</div>
<p><code>-</code> 검증해보자</p>
<ul>
<li><p>검증결과 이런 간단한 회귀 문제는 시간을 들여서 딥러닝 모델을 사용할 필요가 없어보인다.</p></li>
<li><p>비교해보니, 걸리는 시간은 딥러닝 모델이 훨씬 길고, 예측 성능도 떨어진다.</p></li>
</ul>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:3,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1696308705913,&quot;user&quot;:{&quot;displayName&quot;:&quot;ccc flkwerkdai&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-outputid="0eae2d2b-6536-4421-920e-709d596f7f0c" data-execution_count="168">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1"></a><span class="bu">print</span>(<span class="st">"ML model"</span>)</span>
<span id="cb41-2"><a href="#cb41-2"></a><span class="bu">print</span>(<span class="ss">f'RMSE  : </span><span class="sc">{</span>mean_squared_error(y_test, lm.pred, squared<span class="op">=</span><span class="va">False</span>)<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb41-3"><a href="#cb41-3"></a><span class="bu">print</span>(<span class="ss">f'MAE   : </span><span class="sc">{</span>mean_absolute_error(y_test, lm.pred)<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb41-4"><a href="#cb41-4"></a><span class="bu">print</span>(<span class="ss">f'MAPE  : </span><span class="sc">{</span>mean_absolute_percentage_error(y_test, lm.pred)<span class="sc">}</span><span class="ss">'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>ML model
RMSE  : 1.5547807224924604
MAE   : 1.2573619368638342
MAPE  : 0.11717490489730135</code></pre>
</div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:487,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1696308714915,&quot;user&quot;:{&quot;displayName&quot;:&quot;ccc flkwerkdai&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-outputid="c80cf561-8c11-4108-e917-af02c489b7fe" data-execution_count="169">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1"></a><span class="bu">print</span>(<span class="st">"DL model"</span>)</span>
<span id="cb43-2"><a href="#cb43-2"></a><span class="bu">print</span>(<span class="ss">f'RMSE  : </span><span class="sc">{</span>mean_squared_error(y_test, y_pred_final, squared<span class="op">=</span><span class="va">False</span>)<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb43-3"><a href="#cb43-3"></a><span class="bu">print</span>(<span class="ss">f'MAE   : </span><span class="sc">{</span>mean_absolute_error(y_test, y_pred_final)<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb43-4"><a href="#cb43-4"></a><span class="bu">print</span>(<span class="ss">f'MAPE  : </span><span class="sc">{</span>mean_absolute_percentage_error(y_test, y_pred_final)<span class="sc">}</span><span class="ss">'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>DL model
RMSE  : 2.895100478652866
MAE   : 2.1337850681940713
MAPE  : 0.15886854745380438</code></pre>
</div>
</div>
<hr>
</section>
<section id="exercise-1.-carseat-회귀" class="level2">
<h2 class="anchored" data-anchor-id="exercise-1.-carseat-회귀">exercise 1. Carseat (회귀)</h2>
<section id="데이터-준비-및-이해-1" class="level3">
<h3 class="anchored" data-anchor-id="데이터-준비-및-이해-1">(1) 데이터 준비 및 이해</h3>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:6,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1696308822810,&quot;user&quot;:{&quot;displayName&quot;:&quot;ccc flkwerkdai&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-outputid="f75e8944-ed03-4aae-8133-bb205d0197d8" data-execution_count="170">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1"></a>path <span class="op">=</span> <span class="st">'https://raw.githubusercontent.com/DA4BAM/dataset/master/Carseats.csv'</span></span>
<span id="cb45-2"><a href="#cb45-2"></a>carseat <span class="op">=</span> pd.read_csv(path)</span>
<span id="cb45-3"><a href="#cb45-3"></a>carseat.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="170">

  <div id="df-a3468791-4719-430c-a53b-4034cfea3d4b" class="colab-df-container">
    <div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Sales</th>
<th data-quarto-table-cell-role="th">CompPrice</th>
<th data-quarto-table-cell-role="th">Income</th>
<th data-quarto-table-cell-role="th">Advertising</th>
<th data-quarto-table-cell-role="th">Population</th>
<th data-quarto-table-cell-role="th">Price</th>
<th data-quarto-table-cell-role="th">ShelveLoc</th>
<th data-quarto-table-cell-role="th">Age</th>
<th data-quarto-table-cell-role="th">Education</th>
<th data-quarto-table-cell-role="th">Urban</th>
<th data-quarto-table-cell-role="th">US</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>9.50</td>
<td>138</td>
<td>73</td>
<td>11</td>
<td>276</td>
<td>120</td>
<td>Bad</td>
<td>42</td>
<td>17</td>
<td>Yes</td>
<td>Yes</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>11.22</td>
<td>111</td>
<td>48</td>
<td>16</td>
<td>260</td>
<td>83</td>
<td>Good</td>
<td>65</td>
<td>10</td>
<td>Yes</td>
<td>Yes</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>10.06</td>
<td>113</td>
<td>35</td>
<td>10</td>
<td>269</td>
<td>80</td>
<td>Medium</td>
<td>59</td>
<td>12</td>
<td>Yes</td>
<td>Yes</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>7.40</td>
<td>117</td>
<td>100</td>
<td>4</td>
<td>466</td>
<td>97</td>
<td>Medium</td>
<td>55</td>
<td>14</td>
<td>Yes</td>
<td>Yes</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>4.15</td>
<td>141</td>
<td>64</td>
<td>3</td>
<td>340</td>
<td>128</td>
<td>Bad</td>
<td>38</td>
<td>13</td>
<td>Yes</td>
<td>No</td>
</tr>
</tbody>
</table>


</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-a3468791-4719-430c-a53b-4034cfea3d4b')" title="Convert this dataframe to an interactive table." style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"></path>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-a3468791-4719-430c-a53b-4034cfea3d4b button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-a3468791-4719-430c-a53b-4034cfea3d4b');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-c8a7fe96-d501-41c4-a2e9-111dbc70ab98">
  <button class="colab-df-quickchart" onclick="quickchart('df-c8a7fe96-d501-41c4-a2e9-111dbc70ab98')" title="Suggest charts." style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"></path>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-c8a7fe96-d501-41c4-a2e9-111dbc70ab98 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div>
</div>
<p><code>-</code> x, y 분리</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:2,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1696308868024,&quot;user&quot;:{&quot;displayName&quot;:&quot;ccc flkwerkdai&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-execution_count="171">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1"></a>target <span class="op">=</span> <span class="st">"Sales"</span></span>
<span id="cb46-2"><a href="#cb46-2"></a></span>
<span id="cb46-3"><a href="#cb46-3"></a>x <span class="op">=</span> carseat.drop(target, axis <span class="op">=</span> <span class="dv">1</span>)</span>
<span id="cb46-4"><a href="#cb46-4"></a>y <span class="op">=</span> carseat[target]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><code>-</code> 가변수화</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:1,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1696308904800,&quot;user&quot;:{&quot;displayName&quot;:&quot;ccc flkwerkdai&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-execution_count="172">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1"></a>cat_cols <span class="op">=</span> [<span class="st">'ShelveLoc'</span>, <span class="st">'Education'</span>, <span class="st">'US'</span>, <span class="st">'Urban'</span>]</span>
<span id="cb47-2"><a href="#cb47-2"></a>x <span class="op">=</span> pd.get_dummies(x, columns <span class="op">=</span> cat_cols, drop_first <span class="op">=</span> <span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><code>-</code> 데이터셋 분할</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:2,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1696308917380,&quot;user&quot;:{&quot;displayName&quot;:&quot;ccc flkwerkdai&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-execution_count="173">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1"></a>x_train, x_val, y_train, y_val <span class="op">=</span> train_test_split(x, y, test_size<span class="op">=</span><span class="fl">.2</span>, random_state <span class="op">=</span> <span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><code>-</code> scaling</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:3,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1696308930848,&quot;user&quot;:{&quot;displayName&quot;:&quot;ccc flkwerkdai&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-execution_count="174">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1"></a>scaler <span class="op">=</span> MinMaxScaler()</span>
<span id="cb49-2"><a href="#cb49-2"></a>x_train <span class="op">=</span> scaler.fit_transform(x_train)</span>
<span id="cb49-3"><a href="#cb49-3"></a>x_val <span class="op">=</span> scaler.transform(x_val)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="모델링" class="level3">
<h3 class="anchored" data-anchor-id="모델링">(2) 모델링</h3>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:2,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1696308961064,&quot;user&quot;:{&quot;displayName&quot;:&quot;ccc flkwerkdai&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-execution_count="175">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1"></a><span class="im">from</span> keras.models <span class="im">import</span> Sequential</span>
<span id="cb50-2"><a href="#cb50-2"></a><span class="im">from</span> keras.layers <span class="im">import</span> Dense</span>
<span id="cb50-3"><a href="#cb50-3"></a><span class="im">from</span> keras.backend <span class="im">import</span> clear_session</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:2,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1696308980835,&quot;user&quot;:{&quot;displayName&quot;:&quot;ccc flkwerkdai&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-execution_count="177">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1"></a>n_f <span class="op">=</span> x_train.shape[<span class="dv">1</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><code>-</code> 일단 비교를 위해 <code>epochs = 5, 1000</code> 으로 셋팅</p>
<ul>
<li>gpu name을 확인하고 돌리기</li>
</ul>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:6,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1696309154847,&quot;user&quot;:{&quot;displayName&quot;:&quot;ccc flkwerkdai&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-outputid="3b2a7a09-c6f5-4e04-f14c-121688475649" data-execution_count="180">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1"></a><span class="im">import</span> tensorflow <span class="im">as</span> tf</span>
<span id="cb52-2"><a href="#cb52-2"></a>device_name <span class="op">=</span> tf.test.gpu_device_name()</span>
<span id="cb52-3"><a href="#cb52-3"></a>device_name</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="180">
<pre><code>'/device:GPU:0'</code></pre>
</div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:20602,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1696309488204,&quot;user&quot;:{&quot;displayName&quot;:&quot;ccc flkwerkdai&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-execution_count="188">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1"></a><span class="cf">with</span> tf.device(<span class="st">'/device:GPU:0'</span>):</span>
<span id="cb54-2"><a href="#cb54-2"></a>  model1 <span class="op">=</span> Sequential( Dense(<span class="dv">1</span>, input_shape <span class="op">=</span> (n_f,)) )</span>
<span id="cb54-3"><a href="#cb54-3"></a></span>
<span id="cb54-4"><a href="#cb54-4"></a>  model1.<span class="bu">compile</span>(optimizer <span class="op">=</span> <span class="st">"adam"</span>, loss <span class="op">=</span> <span class="st">"mse"</span>)</span>
<span id="cb54-5"><a href="#cb54-5"></a>  model1.fit(x_train, y_train, epochs <span class="op">=</span> <span class="dv">5</span>, verbose<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb54-6"><a href="#cb54-6"></a></span>
<span id="cb54-7"><a href="#cb54-7"></a><span class="cf">with</span> tf.device(<span class="st">'/device:GPU:0'</span>):</span>
<span id="cb54-8"><a href="#cb54-8"></a>  model2 <span class="op">=</span> Sequential( Dense(<span class="dv">1</span>, input_shape <span class="op">=</span> (n_f,)) )</span>
<span id="cb54-9"><a href="#cb54-9"></a></span>
<span id="cb54-10"><a href="#cb54-10"></a>  model2.<span class="bu">compile</span>(optimizer <span class="op">=</span> <span class="st">"adam"</span>, loss <span class="op">=</span> <span class="st">"mse"</span>)</span>
<span id="cb54-11"><a href="#cb54-11"></a>  model2.fit(x_train, y_train, epochs <span class="op">=</span> <span class="dv">1000</span>,verbose<span class="op">=</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><code>-</code> 결과 시각화</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:2162,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1696309515429,&quot;user&quot;:{&quot;displayName&quot;:&quot;ccc flkwerkdai&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-outputid="9a64feb6-4385-48cc-87e6-fd3737db98cd" data-execution_count="191">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1"></a>y_pred_5 <span class="op">=</span> model1.predict(x_val)</span>
<span id="cb55-2"><a href="#cb55-2"></a>y_pred_1000 <span class="op">=</span> model2.predict(x_val)</span>
<span id="cb55-3"><a href="#cb55-3"></a></span>
<span id="cb55-4"><a href="#cb55-4"></a>fig, axes <span class="op">=</span> plt.subplots(<span class="dv">1</span>,<span class="dv">2</span>,figsize <span class="op">=</span> (<span class="dv">12</span>, <span class="dv">4</span>))</span>
<span id="cb55-5"><a href="#cb55-5"></a></span>
<span id="cb55-6"><a href="#cb55-6"></a>ax1, ax2 <span class="op">=</span> axes</span>
<span id="cb55-7"><a href="#cb55-7"></a></span>
<span id="cb55-8"><a href="#cb55-8"></a>ax1.plot(y_test, label <span class="op">=</span> <span class="vs">r"$y$"</span>)</span>
<span id="cb55-9"><a href="#cb55-9"></a>ax1.plot(y_pred_5, label <span class="op">=</span> <span class="vs">r"$\hat y_</span><span class="sc">{5}</span><span class="vs">$"</span>)</span>
<span id="cb55-10"><a href="#cb55-10"></a>ax1.legend()</span>
<span id="cb55-11"><a href="#cb55-11"></a></span>
<span id="cb55-12"><a href="#cb55-12"></a>ax2.plot(y_test, label <span class="op">=</span> <span class="vs">r"$y$"</span>)</span>
<span id="cb55-13"><a href="#cb55-13"></a>ax2.plot(y_pred_1000, label <span class="op">=</span> <span class="vs">r"$\hat y_</span><span class="sc">{1000}</span><span class="vs">$"</span>)</span>
<span id="cb55-14"><a href="#cb55-14"></a>ax2.legend()</span>
<span id="cb55-15"><a href="#cb55-15"></a></span>
<span id="cb55-16"><a href="#cb55-16"></a>fig.tight_layout()</span>
<span id="cb55-17"><a href="#cb55-17"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>3/3 [==============================] - 0s 13ms/step
3/3 [==============================] - 0s 6ms/step</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="2023-10-03-00. 딥러닝 (1)_files/figure-html/cell-42-output-2.png" class="img-fluid"></p>
</div>
</div>
<p><code>-</code> 뭐 epoch를 1000번으로 해도 딱히 성능이 좋아보이지 않음</p>
<ul>
<li>일단 두 model의 성능을 비교해보자</li>
</ul>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:3,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1696309606530,&quot;user&quot;:{&quot;displayName&quot;:&quot;ccc flkwerkdai&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-outputid="c86b6bf9-3284-41b4-88e7-a77e4929c064" data-execution_count="194">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1"></a><span class="bu">print</span>(<span class="st">"model1 : epochs = 5"</span>)</span>
<span id="cb57-2"><a href="#cb57-2"></a><span class="bu">print</span>(<span class="ss">f'RMSE  : </span><span class="sc">{</span>mean_squared_error(y_val, y_pred_5, squared<span class="op">=</span><span class="va">False</span>)<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb57-3"><a href="#cb57-3"></a><span class="bu">print</span>(<span class="ss">f'MAE   : </span><span class="sc">{</span>mean_absolute_error(y_val, y_pred_5)<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb57-4"><a href="#cb57-4"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">-------------------------</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb57-5"><a href="#cb57-5"></a><span class="bu">print</span>(<span class="st">"model1 : epochs = 1000"</span>)</span>
<span id="cb57-6"><a href="#cb57-6"></a><span class="bu">print</span>(<span class="ss">f'RMSE  : </span><span class="sc">{</span>mean_squared_error(y_val, y_pred_1000, squared<span class="op">=</span><span class="va">False</span>)<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb57-7"><a href="#cb57-7"></a><span class="bu">print</span>(<span class="ss">f'MAE   : </span><span class="sc">{</span>mean_absolute_error(y_val, y_pred_1000)<span class="sc">}</span><span class="ss">'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>model1 : epochs = 5
RMSE  : 7.343708509578071
MAE   : 6.769834949548357

-------------------------

model1 : epochs = 1000
RMSE  : 2.216046941057742
MAE   : 1.7544673845767975</code></pre>
</div>
</div>
<hr>
</section>
</section>
<section id="excercise-2.-mobile-분류" class="level2">
<h2 class="anchored" data-anchor-id="excercise-2.-mobile-분류">excercise 2. mobile (분류)</h2>
<section id="데이터-이해-및-준비" class="level3">
<h3 class="anchored" data-anchor-id="데이터-이해-및-준비">(1) 데이터 이해 및 준비</h3>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:1226,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1696309749380,&quot;user&quot;:{&quot;displayName&quot;:&quot;ccc flkwerkdai&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-outputid="8907f4ba-33e9-47e5-807f-263990e152b2" data-execution_count="195">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1"></a>path <span class="op">=</span> <span class="st">"https://raw.githubusercontent.com/DA4BAM/dataset/master/mobile_churn_simple.csv"</span></span>
<span id="cb59-2"><a href="#cb59-2"></a>data <span class="op">=</span> pd.read_csv(path)</span>
<span id="cb59-3"><a href="#cb59-3"></a>data[<span class="st">'CHURN'</span>] <span class="op">=</span> data[<span class="st">'CHURN'</span>].<span class="bu">map</span>({<span class="st">'STAY'</span>:<span class="dv">0</span>, <span class="st">'LEAVE'</span>:<span class="dv">1</span>})</span>
<span id="cb59-4"><a href="#cb59-4"></a>data.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="195">

  <div id="df-2b7a6bcd-e3bb-41aa-951f-2043a785d787" class="colab-df-container">
    <div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">INCOME</th>
<th data-quarto-table-cell-role="th">OVERAGE</th>
<th data-quarto-table-cell-role="th">LEFTOVER</th>
<th data-quarto-table-cell-role="th">HOUSE</th>
<th data-quarto-table-cell-role="th">HANDSET_PRICE</th>
<th data-quarto-table-cell-role="th">OVER_15MINS_CALLS_PER_MONTH</th>
<th data-quarto-table-cell-role="th">AVERAGE_CALL_DURATION</th>
<th data-quarto-table-cell-role="th">CHURN</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>31953</td>
<td>0</td>
<td>6</td>
<td>313378</td>
<td>161</td>
<td>0</td>
<td>4</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>36147</td>
<td>0</td>
<td>13</td>
<td>800586</td>
<td>244</td>
<td>0</td>
<td>6</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>27273</td>
<td>230</td>
<td>0</td>
<td>305049</td>
<td>201</td>
<td>16</td>
<td>15</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>120070</td>
<td>38</td>
<td>33</td>
<td>788235</td>
<td>780</td>
<td>3</td>
<td>2</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>29215</td>
<td>208</td>
<td>85</td>
<td>224784</td>
<td>241</td>
<td>21</td>
<td>1</td>
<td>0</td>
</tr>
</tbody>
</table>


</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-2b7a6bcd-e3bb-41aa-951f-2043a785d787')" title="Convert this dataframe to an interactive table." style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"></path>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-2b7a6bcd-e3bb-41aa-951f-2043a785d787 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-2b7a6bcd-e3bb-41aa-951f-2043a785d787');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-6b537820-fbeb-4cb0-ba2b-45a3ac5b30dd">
  <button class="colab-df-quickchart" onclick="quickchart('df-6b537820-fbeb-4cb0-ba2b-45a3ac5b30dd')" title="Suggest charts." style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"></path>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-6b537820-fbeb-4cb0-ba2b-45a3ac5b30dd button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:3,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1696309763366,&quot;user&quot;:{&quot;displayName&quot;:&quot;ccc flkwerkdai&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-execution_count="197">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1"></a>target <span class="op">=</span> <span class="st">'CHURN'</span></span>
<span id="cb60-2"><a href="#cb60-2"></a>x <span class="op">=</span> data.drop(target, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb60-3"><a href="#cb60-3"></a>y <span class="op">=</span> data[target]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><code>-</code> 데이터 분할</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:2,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1696309805331,&quot;user&quot;:{&quot;displayName&quot;:&quot;ccc flkwerkdai&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-execution_count="198">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1"></a>x_train, x_val, y_train, y_val <span class="op">=</span> train_test_split(x,y, test_size <span class="op">=</span> <span class="fl">.2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><code>-</code> scaling</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:2,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1696309873641,&quot;user&quot;:{&quot;displayName&quot;:&quot;ccc flkwerkdai&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-execution_count="201">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1"></a>scaler <span class="op">=</span> MinMaxScaler()</span>
<span id="cb62-2"><a href="#cb62-2"></a>x_train <span class="op">=</span> scaler.fit_transform(x_train)</span>
<span id="cb62-3"><a href="#cb62-3"></a>x_val <span class="op">=</span> scaler.fit_transform(x_val)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="모델링-1" class="level3">
<h3 class="anchored" data-anchor-id="모델링-1">(2) 모델링</h3>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:1,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1696309962570,&quot;user&quot;:{&quot;displayName&quot;:&quot;ccc flkwerkdai&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-execution_count="203">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1"></a><span class="im">from</span> keras.models <span class="im">import</span> Sequential</span>
<span id="cb63-2"><a href="#cb63-2"></a><span class="im">from</span> keras.layers <span class="im">import</span> Dense</span>
<span id="cb63-3"><a href="#cb63-3"></a><span class="im">from</span> keras.backend <span class="im">import</span> clear_session</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:3,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1696310077811,&quot;user&quot;:{&quot;displayName&quot;:&quot;ccc flkwerkdai&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-execution_count="207">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1"></a>nf <span class="op">=</span> x_train.shape[<span class="dv">1</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:3,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1696310104045,&quot;user&quot;:{&quot;displayName&quot;:&quot;ccc flkwerkdai&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-outputid="6a7d8bef-c16c-4915-c43c-60dd36116884" data-execution_count="209">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1"></a>y_train.unique()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="209">
<pre><code>array([0, 1])</code></pre>
</div>
</div>
<p><code>-</code> 여기서도 epochs에 따른 모델들 사이 성능 차이 비교</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:503,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1696310505891,&quot;user&quot;:{&quot;displayName&quot;:&quot;ccc flkwerkdai&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-outputid="0afcc9b8-1f25-4f92-bfc0-5549cb74b587" data-execution_count="216">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb67-1"><a href="#cb67-1"></a><span class="im">import</span> tensorflow <span class="im">as</span> tf</span>
<span id="cb67-2"><a href="#cb67-2"></a>device_name <span class="op">=</span> tf.test.gpu_device_name()</span>
<span id="cb67-3"><a href="#cb67-3"></a>device_name</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="216">
<pre><code>'/device:GPU:0'</code></pre>
</div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:126312,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1696311295582,&quot;user&quot;:{&quot;displayName&quot;:&quot;ccc flkwerkdai&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-outputid="16c22a42-765c-4107-8051-d8d0178c8a2f" data-execution_count="220">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb69-1"><a href="#cb69-1"></a>e <span class="op">=</span> [<span class="dv">5</span>,<span class="dv">100</span>]</span>
<span id="cb69-2"><a href="#cb69-2"></a></span>
<span id="cb69-3"><a href="#cb69-3"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">2</span>) :</span>
<span id="cb69-4"><a href="#cb69-4"></a>  <span class="cf">with</span> tf.device(<span class="st">'/device:GPU:0'</span>):</span>
<span id="cb69-5"><a href="#cb69-5"></a>    <span class="bu">exec</span>(<span class="ss">f"model</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss"> = Sequential([ Dense(1, input_shape = (nf,), activation = 'sigmoid') ])"</span>)</span>
<span id="cb69-6"><a href="#cb69-6"></a>    <span class="bu">exec</span>(<span class="ss">f"model</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">.compile(optimizer='adam', loss='binary_crossentropy')"</span>)</span>
<span id="cb69-7"><a href="#cb69-7"></a>    <span class="bu">exec</span>(<span class="ss">f"model</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">.fit(x_train,y_train,epochs = </span><span class="sc">{</span>e[i]<span class="sc">}</span><span class="ss">,verbose=1)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch 1/5
500/500 [==============================] - 3s 4ms/step - loss: 0.7537
Epoch 2/5
500/500 [==============================] - 1s 2ms/step - loss: 0.7043
Epoch 3/5
500/500 [==============================] - 1s 2ms/step - loss: 0.6776
Epoch 4/5
500/500 [==============================] - 1s 2ms/step - loss: 0.6612
Epoch 5/5
500/500 [==============================] - 1s 2ms/step - loss: 0.6513
Epoch 1/100
500/500 [==============================] - 2s 3ms/step - loss: 0.6921
Epoch 2/100
500/500 [==============================] - 2s 3ms/step - loss: 0.6716
Epoch 3/100
500/500 [==============================] - 1s 2ms/step - loss: 0.6589
Epoch 4/100
500/500 [==============================] - 1s 2ms/step - loss: 0.6509
Epoch 5/100
500/500 [==============================] - 1s 2ms/step - loss: 0.6457
Epoch 6/100
500/500 [==============================] - 1s 2ms/step - loss: 0.6423
Epoch 7/100
500/500 [==============================] - 1s 2ms/step - loss: 0.6399
Epoch 8/100
500/500 [==============================] - 1s 2ms/step - loss: 0.6383
Epoch 9/100
500/500 [==============================] - 1s 2ms/step - loss: 0.6372
Epoch 10/100
500/500 [==============================] - 1s 2ms/step - loss: 0.6363
Epoch 11/100
500/500 [==============================] - 1s 2ms/step - loss: 0.6358
Epoch 12/100
500/500 [==============================] - 1s 3ms/step - loss: 0.6354
Epoch 13/100
500/500 [==============================] - 1s 3ms/step - loss: 0.6351
Epoch 14/100
500/500 [==============================] - 1s 2ms/step - loss: 0.6348
Epoch 15/100
500/500 [==============================] - 1s 2ms/step - loss: 0.6346
Epoch 16/100
500/500 [==============================] - 1s 2ms/step - loss: 0.6344
Epoch 17/100
500/500 [==============================] - 1s 2ms/step - loss: 0.6343
Epoch 18/100
500/500 [==============================] - 1s 2ms/step - loss: 0.6341
Epoch 19/100
500/500 [==============================] - 1s 2ms/step - loss: 0.6341
Epoch 20/100
500/500 [==============================] - 1s 2ms/step - loss: 0.6340
Epoch 21/100
500/500 [==============================] - 1s 2ms/step - loss: 0.6339
Epoch 22/100
500/500 [==============================] - 1s 3ms/step - loss: 0.6339
Epoch 23/100
500/500 [==============================] - 2s 3ms/step - loss: 0.6338
Epoch 24/100
500/500 [==============================] - 1s 3ms/step - loss: 0.6338
Epoch 25/100
500/500 [==============================] - 1s 2ms/step - loss: 0.6337
Epoch 26/100
500/500 [==============================] - 1s 2ms/step - loss: 0.6337
Epoch 27/100
500/500 [==============================] - 1s 2ms/step - loss: 0.6337
Epoch 28/100
500/500 [==============================] - 1s 2ms/step - loss: 0.6336
Epoch 29/100
500/500 [==============================] - 1s 2ms/step - loss: 0.6336
Epoch 30/100
500/500 [==============================] - 1s 2ms/step - loss: 0.6336
Epoch 31/100
500/500 [==============================] - 1s 2ms/step - loss: 0.6336
Epoch 32/100
500/500 [==============================] - 1s 2ms/step - loss: 0.6336
Epoch 33/100
500/500 [==============================] - 1s 3ms/step - loss: 0.6335
Epoch 34/100
500/500 [==============================] - 2s 3ms/step - loss: 0.6335
Epoch 35/100
500/500 [==============================] - 1s 2ms/step - loss: 0.6335
Epoch 36/100
500/500 [==============================] - 1s 2ms/step - loss: 0.6336
Epoch 37/100
500/500 [==============================] - 1s 2ms/step - loss: 0.6335
Epoch 38/100
500/500 [==============================] - 1s 2ms/step - loss: 0.6335
Epoch 39/100
500/500 [==============================] - 1s 2ms/step - loss: 0.6334
Epoch 40/100
500/500 [==============================] - 1s 2ms/step - loss: 0.6335
Epoch 41/100
500/500 [==============================] - 1s 2ms/step - loss: 0.6335
Epoch 42/100
500/500 [==============================] - 1s 2ms/step - loss: 0.6335
Epoch 43/100
500/500 [==============================] - 1s 2ms/step - loss: 0.6335
Epoch 44/100
500/500 [==============================] - 2s 3ms/step - loss: 0.6335
Epoch 45/100
500/500 [==============================] - 1s 3ms/step - loss: 0.6335
Epoch 46/100
500/500 [==============================] - 1s 2ms/step - loss: 0.6335
Epoch 47/100
500/500 [==============================] - 1s 2ms/step - loss: 0.6334
Epoch 48/100
500/500 [==============================] - 1s 2ms/step - loss: 0.6335
Epoch 49/100
500/500 [==============================] - 1s 2ms/step - loss: 0.6335
Epoch 50/100
500/500 [==============================] - 1s 2ms/step - loss: 0.6335
Epoch 51/100
500/500 [==============================] - 1s 2ms/step - loss: 0.6334
Epoch 52/100
500/500 [==============================] - 1s 2ms/step - loss: 0.6334
Epoch 53/100
500/500 [==============================] - 1s 2ms/step - loss: 0.6334
Epoch 54/100
500/500 [==============================] - 1s 3ms/step - loss: 0.6335
Epoch 55/100
500/500 [==============================] - 2s 3ms/step - loss: 0.6335
Epoch 56/100
500/500 [==============================] - 1s 2ms/step - loss: 0.6334
Epoch 57/100
500/500 [==============================] - 1s 2ms/step - loss: 0.6334
Epoch 58/100
500/500 [==============================] - 1s 3ms/step - loss: 0.6335
Epoch 59/100
500/500 [==============================] - 2s 3ms/step - loss: 0.6335
Epoch 60/100
500/500 [==============================] - 1s 2ms/step - loss: 0.6335
Epoch 61/100
500/500 [==============================] - 1s 2ms/step - loss: 0.6334
Epoch 62/100
500/500 [==============================] - 1s 2ms/step - loss: 0.6334
Epoch 63/100
500/500 [==============================] - 1s 2ms/step - loss: 0.6335
Epoch 64/100
500/500 [==============================] - 1s 3ms/step - loss: 0.6335
Epoch 65/100
500/500 [==============================] - 2s 3ms/step - loss: 0.6335
Epoch 66/100
500/500 [==============================] - 1s 2ms/step - loss: 0.6334
Epoch 67/100
500/500 [==============================] - 1s 2ms/step - loss: 0.6335
Epoch 68/100
500/500 [==============================] - 1s 2ms/step - loss: 0.6334
Epoch 69/100
500/500 [==============================] - 1s 2ms/step - loss: 0.6335
Epoch 70/100
500/500 [==============================] - 1s 2ms/step - loss: 0.6335
Epoch 71/100
500/500 [==============================] - 1s 2ms/step - loss: 0.6335
Epoch 72/100
500/500 [==============================] - 1s 2ms/step - loss: 0.6335
Epoch 73/100
500/500 [==============================] - 1s 2ms/step - loss: 0.6335
Epoch 74/100
500/500 [==============================] - 1s 2ms/step - loss: 0.6334
Epoch 75/100
500/500 [==============================] - 1s 3ms/step - loss: 0.6335
Epoch 76/100
500/500 [==============================] - 1s 3ms/step - loss: 0.6334
Epoch 77/100
500/500 [==============================] - 1s 2ms/step - loss: 0.6334
Epoch 78/100
500/500 [==============================] - 1s 2ms/step - loss: 0.6334
Epoch 79/100
500/500 [==============================] - 1s 2ms/step - loss: 0.6335
Epoch 80/100
500/500 [==============================] - 1s 2ms/step - loss: 0.6334
Epoch 81/100
500/500 [==============================] - 1s 2ms/step - loss: 0.6334
Epoch 82/100
500/500 [==============================] - 1s 2ms/step - loss: 0.6334
Epoch 83/100
500/500 [==============================] - 1s 2ms/step - loss: 0.6334
Epoch 84/100
500/500 [==============================] - 1s 2ms/step - loss: 0.6335
Epoch 85/100
500/500 [==============================] - 1s 3ms/step - loss: 0.6335
Epoch 86/100
500/500 [==============================] - 2s 3ms/step - loss: 0.6334
Epoch 87/100
500/500 [==============================] - 1s 2ms/step - loss: 0.6335
Epoch 88/100
500/500 [==============================] - 1s 2ms/step - loss: 0.6334
Epoch 89/100
500/500 [==============================] - 1s 2ms/step - loss: 0.6335
Epoch 90/100
500/500 [==============================] - 1s 2ms/step - loss: 0.6334
Epoch 91/100
500/500 [==============================] - 1s 2ms/step - loss: 0.6335
Epoch 92/100
500/500 [==============================] - 1s 2ms/step - loss: 0.6334
Epoch 93/100
500/500 [==============================] - 1s 2ms/step - loss: 0.6335
Epoch 94/100
500/500 [==============================] - 1s 2ms/step - loss: 0.6334
Epoch 95/100
500/500 [==============================] - 1s 2ms/step - loss: 0.6335
Epoch 96/100
500/500 [==============================] - 2s 3ms/step - loss: 0.6334
Epoch 97/100
500/500 [==============================] - 1s 3ms/step - loss: 0.6334
Epoch 98/100
500/500 [==============================] - 1s 2ms/step - loss: 0.6334
Epoch 99/100
500/500 [==============================] - 1s 2ms/step - loss: 0.6334
Epoch 100/100
500/500 [==============================] - 1s 2ms/step - loss: 0.6335</code></pre>
</div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:3,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1696311754651,&quot;user&quot;:{&quot;displayName&quot;:&quot;ccc flkwerkdai&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-execution_count="238">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb71-1"><a href="#cb71-1"></a>train_error_5 <span class="op">=</span> model0.history.history[<span class="st">"loss"</span>]</span>
<span id="cb71-2"><a href="#cb71-2"></a>train_error_100  <span class="op">=</span> model1.history.history[<span class="st">"loss"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><code>-</code> epoch에 따른 train loss를 살펴본 결과 특정 epoch이후에는 loss값이 변화가 미비하다…</p>
<ul>
<li>대충보니 <code>epoch = 10</code>정도만 해도 될 것같음..</li>
</ul>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:601,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1696312028963,&quot;user&quot;:{&quot;displayName&quot;:&quot;ccc flkwerkdai&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-outputid="33d4b98f-121f-4acb-db02-984579243d2d" data-execution_count="248">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb72-1"><a href="#cb72-1"></a>plt.figure(figsize <span class="op">=</span> (<span class="dv">4</span>,<span class="dv">4</span>))</span>
<span id="cb72-2"><a href="#cb72-2"></a>plt.plot(train_error_5,label <span class="op">=</span> <span class="st">"epochs = 5"</span>)</span>
<span id="cb72-3"><a href="#cb72-3"></a>plt.plot(train_error_100,label <span class="op">=</span> <span class="st">"epochs = 100"</span>)</span>
<span id="cb72-4"><a href="#cb72-4"></a>plt.legend()</span>
<span id="cb72-5"><a href="#cb72-5"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2023-10-03-00. 딥러닝 (1)_files/figure-html/cell-54-output-1.png" class="img-fluid"></p>
</div>
</div>
<p><code>-</code> epoch = 10으로 셋팅 후 결과 리포트 작성</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:12624,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1696312105654,&quot;user&quot;:{&quot;displayName&quot;:&quot;ccc flkwerkdai&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-outputid="c272b813-ae36-44ec-b3cd-932e850d824a" data-execution_count="249">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb73-1"><a href="#cb73-1"></a>model2 <span class="op">=</span> Sequential([ Dense(<span class="dv">1</span>, input_shape <span class="op">=</span> (nf,), activation <span class="op">=</span> <span class="st">'sigmoid'</span>) ])</span>
<span id="cb73-2"><a href="#cb73-2"></a>model2.<span class="bu">compile</span>(optimizer<span class="op">=</span><span class="st">'adam'</span>, loss<span class="op">=</span><span class="st">'binary_crossentropy'</span>)</span>
<span id="cb73-3"><a href="#cb73-3"></a>model2.fit(x_train,y_train,epochs <span class="op">=</span> <span class="dv">10</span>,verbose<span class="op">=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch 1/10
500/500 [==============================] - 2s 2ms/step - loss: 0.7028
Epoch 2/10
500/500 [==============================] - 1s 3ms/step - loss: 0.6771
Epoch 3/10
500/500 [==============================] - 1s 2ms/step - loss: 0.6625
Epoch 4/10
500/500 [==============================] - 1s 2ms/step - loss: 0.6532
Epoch 5/10
500/500 [==============================] - 1s 2ms/step - loss: 0.6472
Epoch 6/10
500/500 [==============================] - 1s 3ms/step - loss: 0.6431
Epoch 7/10
500/500 [==============================] - 1s 3ms/step - loss: 0.6403
Epoch 8/10
500/500 [==============================] - 1s 2ms/step - loss: 0.6384
Epoch 9/10
500/500 [==============================] - 1s 2ms/step - loss: 0.6371
Epoch 10/10
500/500 [==============================] - 1s 2ms/step - loss: 0.6362</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="249">
<pre><code>&lt;keras.src.callbacks.History at 0x7dddd9705c00&gt;</code></pre>
</div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:711,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1696312186056,&quot;user&quot;:{&quot;displayName&quot;:&quot;ccc flkwerkdai&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-outputid="3cc47c9d-fda4-4eff-ee74-179e195e2bbc" data-execution_count="252">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb76-1"><a href="#cb76-1"></a>plt.figure(figsize <span class="op">=</span> (<span class="dv">4</span>,<span class="dv">4</span>))</span>
<span id="cb76-2"><a href="#cb76-2"></a>plt.title(<span class="st">"logistic model with DL (epochs = 10)"</span>)</span>
<span id="cb76-3"><a href="#cb76-3"></a>plt.plot(model2.history.history[<span class="st">"loss"</span>])</span>
<span id="cb76-4"><a href="#cb76-4"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2023-10-03-00. 딥러닝 (1)_files/figure-html/cell-56-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:718,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1696312295414,&quot;user&quot;:{&quot;displayName&quot;:&quot;ccc flkwerkdai&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-outputid="fcfe9a66-efd2-49ec-9e8c-e5840c4b4a7f" data-execution_count="256">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb77-1"><a href="#cb77-1"></a>y_pred <span class="op">=</span> np.where(model2.predict(x_val)<span class="op">&gt;=</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb77-2"><a href="#cb77-2"></a></span>
<span id="cb77-3"><a href="#cb77-3"></a><span class="bu">print</span>(confusion_matrix(y_val, y_pred))</span>
<span id="cb77-4"><a href="#cb77-4"></a><span class="bu">print</span>(<span class="st">'-'</span><span class="op">*</span><span class="dv">50</span>)</span>
<span id="cb77-5"><a href="#cb77-5"></a><span class="bu">print</span>(classification_report(y_val, y_pred))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>125/125 [==============================] - 0s 2ms/step
[[1320  727]
 [ 729 1224]]
--------------------------------------------------
              precision    recall  f1-score   support

           0       0.64      0.64      0.64      2047
           1       0.63      0.63      0.63      1953

    accuracy                           0.64      4000
   macro avg       0.64      0.64      0.64      4000
weighted avg       0.64      0.64      0.64      4000
</code></pre>
</div>
</div>
<p><code>-</code> 최종 결과 시각화</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:4,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1696312402937,&quot;user&quot;:{&quot;displayName&quot;:&quot;ccc flkwerkdai&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-execution_count="257">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb79-1"><a href="#cb79-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> <span class="op">*</span></span>
<span id="cb79-2"><a href="#cb79-2"></a>pre <span class="op">=</span> precision_score(y_val, y_pred)</span>
<span id="cb79-3"><a href="#cb79-3"></a>recall <span class="op">=</span> recall_score(y_val, y_pred)</span>
<span id="cb79-4"><a href="#cb79-4"></a>f1 <span class="op">=</span> f1_score(y_val, y_pred)</span>
<span id="cb79-5"><a href="#cb79-5"></a>acc <span class="op">=</span> accuracy_score(y_val, y_pred)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:7,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1696312589692,&quot;user&quot;:{&quot;displayName&quot;:&quot;ccc flkwerkdai&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-outputid="06642096-93a4-46f9-fdfd-ec9986df16f3" data-execution_count="268">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb80-1"><a href="#cb80-1"></a>measure <span class="op">=</span> [<span class="st">"precision"</span>, <span class="st">"recall"</span>, <span class="st">"F1-score"</span>, <span class="st">"accuracy"</span>]</span>
<span id="cb80-2"><a href="#cb80-2"></a>value <span class="op">=</span> [pre,recall,f1,acc]</span>
<span id="cb80-3"><a href="#cb80-3"></a></span>
<span id="cb80-4"><a href="#cb80-4"></a>result <span class="op">=</span> pd.DataFrame(value,columns <span class="op">=</span> [<span class="st">"value"</span>])</span>
<span id="cb80-5"><a href="#cb80-5"></a>result[<span class="st">"measure"</span>] <span class="op">=</span> measure</span>
<span id="cb80-6"><a href="#cb80-6"></a>fig <span class="op">=</span> result.plot(x <span class="op">=</span> <span class="st">"measure"</span>, y <span class="op">=</span> <span class="st">"value"</span>, kind <span class="op">=</span> <span class="st">"bar"</span>,</span>
<span id="cb80-7"><a href="#cb80-7"></a>            backend <span class="op">=</span> <span class="st">"plotly"</span>,color <span class="op">=</span> <span class="st">"measure"</span>)</span>
<span id="cb80-8"><a href="#cb80-8"></a></span>
<span id="cb80-9"><a href="#cb80-9"></a>fig.update_yaxes(<span class="bu">range</span> <span class="op">=</span> [<span class="fl">0.62</span>,<span class="fl">0.64</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">


<meta charset="utf-8">

    <div>            <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_SVG"></script><script type="text/javascript">if (window.MathJax && window.MathJax.Hub && window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}</script>                <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script charset="utf-8" src="https://cdn.plot.ly/plotly-2.24.1.min.js"></script>                <div id="36b2f65c-863c-42e9-859b-841c43df91b5" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("36b2f65c-863c-42e9-859b-841c43df91b5")) {                    Plotly.newPlot(                        "36b2f65c-863c-42e9-859b-841c43df91b5",                        [{"alignmentgroup":"True","hovertemplate":"measure=%{x}\u003cbr\u003evalue=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"precision","marker":{"color":"#636efa","pattern":{"shape":""}},"name":"precision","offsetgroup":"precision","orientation":"v","showlegend":true,"textposition":"auto","x":["precision"],"xaxis":"x","y":[0.6273705791901589],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","hovertemplate":"measure=%{x}\u003cbr\u003evalue=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"recall","marker":{"color":"#EF553B","pattern":{"shape":""}},"name":"recall","offsetgroup":"recall","orientation":"v","showlegend":true,"textposition":"auto","x":["recall"],"xaxis":"x","y":[0.6267281105990783],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","hovertemplate":"measure=%{x}\u003cbr\u003evalue=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"F1-score","marker":{"color":"#00cc96","pattern":{"shape":""}},"name":"F1-score","offsetgroup":"F1-score","orientation":"v","showlegend":true,"textposition":"auto","x":["F1-score"],"xaxis":"x","y":[0.6270491803278688],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","hovertemplate":"measure=%{x}\u003cbr\u003evalue=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"accuracy","marker":{"color":"#ab63fa","pattern":{"shape":""}},"name":"accuracy","offsetgroup":"accuracy","orientation":"v","showlegend":true,"textposition":"auto","x":["accuracy"],"xaxis":"x","y":[0.636],"yaxis":"y","type":"bar"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"measure"},"categoryorder":"array","categoryarray":["precision","recall","F1-score","accuracy"]},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"value"},"range":[0.62,0.64]},"legend":{"title":{"text":"measure"},"tracegroupgap":0},"margin":{"t":60},"barmode":"relative"},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('36b2f65c-863c-42e9-859b-841c43df91b5');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                            </script>        </div>


</div>
</div>
</section>
<section id="summary" class="level3">
<h3 class="anchored" data-anchor-id="summary">summary</h3>
<p><code>1</code> epoch을 늘려도 성능이 그렇게 좋지 않음</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:2,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1696312745259,&quot;user&quot;:{&quot;displayName&quot;:&quot;ccc flkwerkdai&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-execution_count="272">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb81-1"><a href="#cb81-1"></a><span class="im">from</span> keras.optimizers <span class="im">import</span> Adam</span>
<span id="cb81-2"><a href="#cb81-2"></a>Adam?</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><code>2</code> 아마도 기존에 제공하는 학습률이 너무 작아서 로컬 미니멈에 빠지는 것 같음</p>
<ul>
<li>아래를 통해서 <code>Adam</code>에서 기본적으로 제공하는 학습률이 <code>0.001</code>임을 확인 가능</li>
</ul>
<div class="sourceCode" id="cb82"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb82-1"><a href="#cb82-1"></a><span class="im">from</span> keras.optimizers <span class="im">import</span> Adam</span>
<span id="cb82-2"><a href="#cb82-2"></a>Adam?</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><code>3</code> 또한, 모델 적합시 검증용 데이터를 이용하지 않아 학습시 잘못된 학습을 한 경우에도 그냥 반영하는 것 같음</p>
<p><code>4</code> 생각해볼 수 있는 접근법</p>
<ul>
<li><p>그렇다면, 학습 시 검증용 데이터를 이용</p></li>
<li><p>그리고, <code>epoch</code>와 <code>learning_rate</code>를 적절히 이용한다면..모델 성능을 높일 수 있지 않을까??</p></li>
<li><p>그리고 은닉층을 여러개 추가한다면???</p></li>
</ul>
<hr>
</section>
</section>
<section id="excercise-3.-boston-회귀" class="level2">
<h2 class="anchored" data-anchor-id="excercise-3.-boston-회귀">excercise 3. Boston (회귀)</h2>
<section id="데이터-이해-및-준비-1" class="level3">
<h3 class="anchored" data-anchor-id="데이터-이해-및-준비-1">(1) 데이터 이해 및 준비</h3>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:5,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1696313237188,&quot;user&quot;:{&quot;displayName&quot;:&quot;ccc flkwerkdai&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-outputid="5ae3785e-1959-43ee-89c7-f4fbffb54efc" data-execution_count="273">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb83-1"><a href="#cb83-1"></a>path <span class="op">=</span> <span class="st">'https://raw.githubusercontent.com/DA4BAM/dataset/master/boston.csv'</span></span>
<span id="cb83-2"><a href="#cb83-2"></a>data <span class="op">=</span> pd.read_csv(path)</span>
<span id="cb83-3"><a href="#cb83-3"></a>data.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="273">

  <div id="df-41752826-86f5-41fe-b727-54eb437be64e" class="colab-df-container">
    <div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">crim</th>
<th data-quarto-table-cell-role="th">zn</th>
<th data-quarto-table-cell-role="th">indus</th>
<th data-quarto-table-cell-role="th">chas</th>
<th data-quarto-table-cell-role="th">nox</th>
<th data-quarto-table-cell-role="th">rm</th>
<th data-quarto-table-cell-role="th">age</th>
<th data-quarto-table-cell-role="th">dis</th>
<th data-quarto-table-cell-role="th">rad</th>
<th data-quarto-table-cell-role="th">tax</th>
<th data-quarto-table-cell-role="th">ptratio</th>
<th data-quarto-table-cell-role="th">lstat</th>
<th data-quarto-table-cell-role="th">medv</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>0.00632</td>
<td>18.0</td>
<td>2.31</td>
<td>0</td>
<td>0.538</td>
<td>6.575</td>
<td>65.2</td>
<td>4.0900</td>
<td>1</td>
<td>296</td>
<td>15.3</td>
<td>4.98</td>
<td>24.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>0.02731</td>
<td>0.0</td>
<td>7.07</td>
<td>0</td>
<td>0.469</td>
<td>6.421</td>
<td>78.9</td>
<td>4.9671</td>
<td>2</td>
<td>242</td>
<td>17.8</td>
<td>9.14</td>
<td>21.6</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>0.02729</td>
<td>0.0</td>
<td>7.07</td>
<td>0</td>
<td>0.469</td>
<td>7.185</td>
<td>61.1</td>
<td>4.9671</td>
<td>2</td>
<td>242</td>
<td>17.8</td>
<td>4.03</td>
<td>34.7</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>0.03237</td>
<td>0.0</td>
<td>2.18</td>
<td>0</td>
<td>0.458</td>
<td>6.998</td>
<td>45.8</td>
<td>6.0622</td>
<td>3</td>
<td>222</td>
<td>18.7</td>
<td>2.94</td>
<td>33.4</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>0.06905</td>
<td>0.0</td>
<td>2.18</td>
<td>0</td>
<td>0.458</td>
<td>7.147</td>
<td>54.2</td>
<td>6.0622</td>
<td>3</td>
<td>222</td>
<td>18.7</td>
<td>5.33</td>
<td>36.2</td>
</tr>
</tbody>
</table>


</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-41752826-86f5-41fe-b727-54eb437be64e')" title="Convert this dataframe to an interactive table." style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"></path>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-41752826-86f5-41fe-b727-54eb437be64e button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-41752826-86f5-41fe-b727-54eb437be64e');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-fe213977-fc27-420e-9742-95af9e54e2d5">
  <button class="colab-df-quickchart" onclick="quickchart('df-fe213977-fc27-420e-9742-95af9e54e2d5')" title="Suggest charts." style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"></path>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-fe213977-fc27-420e-9742-95af9e54e2d5 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:3,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1696313625540,&quot;user&quot;:{&quot;displayName&quot;:&quot;ccc flkwerkdai&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-execution_count="282">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb84-1"><a href="#cb84-1"></a>target <span class="op">=</span> <span class="st">"medv"</span></span>
<span id="cb84-2"><a href="#cb84-2"></a></span>
<span id="cb84-3"><a href="#cb84-3"></a>x <span class="op">=</span> data.drop(target, axis <span class="op">=</span> <span class="dv">1</span>)</span>
<span id="cb84-4"><a href="#cb84-4"></a>y<span class="op">=</span> data[target]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><code>-</code> 데이터 분할</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:3,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1696313629382,&quot;user&quot;:{&quot;displayName&quot;:&quot;ccc flkwerkdai&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-execution_count="283">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb85-1"><a href="#cb85-1"></a>x_train, x_val, y_train, y_val <span class="op">=</span> train_test_split(x, y, test_size<span class="op">=</span><span class="fl">.2</span>, random_state <span class="op">=</span> <span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><code>-</code> scaling</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:3,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1696313630668,&quot;user&quot;:{&quot;displayName&quot;:&quot;ccc flkwerkdai&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-execution_count="284">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb86-1"><a href="#cb86-1"></a><span class="co"># 스케일러 선언</span></span>
<span id="cb86-2"><a href="#cb86-2"></a>scaler <span class="op">=</span> MinMaxScaler()</span>
<span id="cb86-3"><a href="#cb86-3"></a></span>
<span id="cb86-4"><a href="#cb86-4"></a><span class="co"># train 셋으로 fitting &amp; 적용</span></span>
<span id="cb86-5"><a href="#cb86-5"></a>x_train <span class="op">=</span> scaler.fit_transform(x_train)</span>
<span id="cb86-6"><a href="#cb86-6"></a></span>
<span id="cb86-7"><a href="#cb86-7"></a><span class="co"># validation 셋은 적용만!</span></span>
<span id="cb86-8"><a href="#cb86-8"></a>x_val <span class="op">=</span> scaler.transform(x_val)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="모델링-2" class="level3">
<h3 class="anchored" data-anchor-id="모델링-2">(2) 모델링</h3>
<p><code>-</code> 이번시간에 알아볼 것!</p>
<ul>
<li><p>학습률은 <code>0.01</code>, <code>activation = "relu"</code>, <code>optimizer = "adam"</code>, <code>epochs = 50</code> 고정!</p></li>
<li><p><code>validation_split = 0.2로 고정</code></p></li>
<li><p>은닉층과 은닉노드 개수에 따라 어떻게 모델 성능이 변화하는지 비교해보자.</p></li>
</ul>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: center;">model</th>
<th style="text-align: center;">은닉층</th>
<th style="text-align: center;">각 층에서 은닉노드의 개수</th>
<th style="text-align: center;">params</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">model1</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">(2,1)</td>
<td style="text-align: center;">26 + 3 = 29</td>
</tr>
<tr class="even">
<td style="text-align: center;">model2</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">(8,1)</td>
<td style="text-align: center;">104 + 9 = 113</td>
</tr>
<tr class="odd">
<td style="text-align: center;">model3</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">(8,4,1)</td>
<td style="text-align: center;">104 + 36 + 5 = 145</td>
</tr>
</tbody>
</table>
<section id="import-2" class="level4">
<h4 class="anchored" data-anchor-id="import-2">import</h4>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:3,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1696314605405,&quot;user&quot;:{&quot;displayName&quot;:&quot;ccc flkwerkdai&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-execution_count="288">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb87-1"><a href="#cb87-1"></a><span class="im">from</span> keras.models <span class="im">import</span> Sequential</span>
<span id="cb87-2"><a href="#cb87-2"></a><span class="im">from</span> keras.layers <span class="im">import</span> Dense</span>
<span id="cb87-3"><a href="#cb87-3"></a><span class="im">from</span> keras.backend <span class="im">import</span> clear_session</span>
<span id="cb87-4"><a href="#cb87-4"></a><span class="im">from</span> keras.optimizers <span class="im">import</span> Adam</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="model1-설계" class="level4">
<h4 class="anchored" data-anchor-id="model1-설계"><code>model1</code> 설계</h4>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:1,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1696315060236,&quot;user&quot;:{&quot;displayName&quot;:&quot;ccc flkwerkdai&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-execution_count="297">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb88-1"><a href="#cb88-1"></a>nf <span class="op">=</span> x_train.shape[<span class="dv">1</span>]</span>
<span id="cb88-2"><a href="#cb88-2"></a>lr <span class="op">=</span> <span class="fl">0.01</span></span>
<span id="cb88-3"><a href="#cb88-3"></a>at <span class="op">=</span> <span class="st">"relu"</span> <span class="co">## 활성화 함수</span></span>
<span id="cb88-4"><a href="#cb88-4"></a>e <span class="op">=</span> <span class="dv">50</span> <span class="co">## epochs</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: center;">model</th>
<th style="text-align: center;">은닉층</th>
<th style="text-align: center;">각 층에서 은닉노드의 개수</th>
<th style="text-align: center;">params</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">model1</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">(2,1)</td>
<td style="text-align: center;">26 + 3 = 29</td>
</tr>
<tr class="even">
<td style="text-align: center;">model2</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">(8,1)</td>
<td style="text-align: center;">104 + 9 = 113</td>
</tr>
<tr class="odd">
<td style="text-align: center;">model3</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">(8,4,1)</td>
<td style="text-align: center;">104 + 36 + 5 = 145</td>
</tr>
</tbody>
</table>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:3,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1696316529270,&quot;user&quot;:{&quot;displayName&quot;:&quot;ccc flkwerkdai&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-outputid="e5e4f2ee-8c24-4ed2-9673-047aac8c89e8" data-execution_count="357">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb89-1"><a href="#cb89-1"></a>clear_session()</span>
<span id="cb89-2"><a href="#cb89-2"></a>model1 <span class="op">=</span> Sequential(Dense(<span class="dv">2</span>, input_shape <span class="op">=</span>(nf,),activation<span class="op">=</span>at)) <span class="co">## 첫 번째 은닉층</span></span>
<span id="cb89-3"><a href="#cb89-3"></a>model1.add(Dense(<span class="dv">1</span>,activation<span class="op">=</span>at))</span>
<span id="cb89-4"><a href="#cb89-4"></a></span>
<span id="cb89-5"><a href="#cb89-5"></a>model1.summary() <span class="co">## 각 층에서 param 개수와 전체 param 개수 확인</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Model: "sequential"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 dense (Dense)               (None, 2)                 26        
                                                                 
 dense_1 (Dense)             (None, 1)                 3         
                                                                 
=================================================================
Total params: 29 (116.00 Byte)
Trainable params: 29 (116.00 Byte)
Non-trainable params: 0 (0.00 Byte)
_________________________________________________________________</code></pre>
</div>
</div>
<p><code>-</code> compile &amp; fit</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:2,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1696316533323,&quot;user&quot;:{&quot;displayName&quot;:&quot;ccc flkwerkdai&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-execution_count="358">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb91-1"><a href="#cb91-1"></a>model1.<span class="bu">compile</span>(optimizer <span class="op">=</span> Adam(learning_rate <span class="op">=</span> lr), loss <span class="op">=</span> <span class="st">"mse"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:3,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1696316534966,&quot;user&quot;:{&quot;displayName&quot;:&quot;ccc flkwerkdai&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-outputid="119deeb8-39a5-47c5-99f4-97a5f907628c" data-execution_count="359">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb92-1"><a href="#cb92-1"></a><span class="im">import</span> tensorflow <span class="im">as</span> tf</span>
<span id="cb92-2"><a href="#cb92-2"></a>device_name <span class="op">=</span> tf.test.gpu_device_name()</span>
<span id="cb92-3"><a href="#cb92-3"></a>device_name</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="359">
<pre><code>'/device:GPU:0'</code></pre>
</div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:5542,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1696316541931,&quot;user&quot;:{&quot;displayName&quot;:&quot;ccc flkwerkdai&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-execution_count="360">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb94-1"><a href="#cb94-1"></a><span class="cf">with</span> tf.device(<span class="st">'/device:GPU:0'</span>) :</span>
<span id="cb94-2"><a href="#cb94-2"></a>     model1.fit(x_train,y_train,epochs <span class="op">=</span> e, validation_split <span class="op">=</span> <span class="fl">0.2</span>, verbose <span class="op">=</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><code>-</code> train 및 val error 저장</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:5,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1696316541931,&quot;user&quot;:{&quot;displayName&quot;:&quot;ccc flkwerkdai&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-execution_count="361">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb95-1"><a href="#cb95-1"></a>total_train <span class="op">=</span> pd.DataFrame()</span>
<span id="cb95-2"><a href="#cb95-2"></a>total_val <span class="op">=</span> pd.DataFrame()</span>
<span id="cb95-3"><a href="#cb95-3"></a>model1_train_loss <span class="op">=</span> model1.history.history[<span class="st">"loss"</span>]</span>
<span id="cb95-4"><a href="#cb95-4"></a>model1_val_loss <span class="op">=</span> model1.history.history[<span class="st">"val_loss"</span>]</span>
<span id="cb95-5"><a href="#cb95-5"></a></span>
<span id="cb95-6"><a href="#cb95-6"></a>total_train.loc[:,<span class="dv">0</span>] <span class="op">=</span> model1_train_loss</span>
<span id="cb95-7"><a href="#cb95-7"></a>total_val.loc[:,<span class="dv">0</span>] <span class="op">=</span> model1_val_loss</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><code>-</code> predict</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:5,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1696316541932,&quot;user&quot;:{&quot;displayName&quot;:&quot;ccc flkwerkdai&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-outputid="6f548fd6-66cc-43f6-fd5f-71447fe9212d" data-execution_count="362">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb96-1"><a href="#cb96-1"></a>total_pred <span class="op">=</span> pd.DataFrame()</span>
<span id="cb96-2"><a href="#cb96-2"></a>model1_pred <span class="op">=</span> model1.predict(x_val).reshape(<span class="op">-</span><span class="dv">1</span>)</span>
<span id="cb96-3"><a href="#cb96-3"></a>total_pred.loc[:,<span class="dv">0</span>] <span class="op">=</span> model1_pred</span>
<span id="cb96-4"><a href="#cb96-4"></a><span class="co">#total_pred</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>4/4 [==============================] - 0s 2ms/step</code></pre>
</div>
</div>
</section>
<section id="model2-설계" class="level4">
<h4 class="anchored" data-anchor-id="model2-설계">model2 설계</h4>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: center;">model</th>
<th style="text-align: center;">은닉층</th>
<th style="text-align: center;">각 층에서 은닉노드의 개수</th>
<th style="text-align: center;">params</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">model1</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">(2,1)</td>
<td style="text-align: center;">26 + 3 = 29</td>
</tr>
<tr class="even">
<td style="text-align: center;">model2</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">(8,1)</td>
<td style="text-align: center;">104 + 9 = 113</td>
</tr>
<tr class="odd">
<td style="text-align: center;">model3</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">(8,4,1)</td>
<td style="text-align: center;">104 + 36 + 5 = 145</td>
</tr>
</tbody>
</table>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:5,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1696316541932,&quot;user&quot;:{&quot;displayName&quot;:&quot;ccc flkwerkdai&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-outputid="6ed41ac3-8ff9-4ef2-94ad-e104ec0bbecb" data-execution_count="363">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb98-1"><a href="#cb98-1"></a>model2 <span class="op">=</span> Sequential(Dense(<span class="dv">8</span>, input_shape <span class="op">=</span> (nf,), activation <span class="op">=</span> at))</span>
<span id="cb98-2"><a href="#cb98-2"></a></span>
<span id="cb98-3"><a href="#cb98-3"></a>model2.add(Dense(<span class="dv">1</span>,activation <span class="op">=</span> at))</span>
<span id="cb98-4"><a href="#cb98-4"></a></span>
<span id="cb98-5"><a href="#cb98-5"></a>model2.summary()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Model: "sequential_1"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 dense_2 (Dense)             (None, 8)                 104       
                                                                 
 dense_3 (Dense)             (None, 1)                 9         
                                                                 
=================================================================
Total params: 113 (452.00 Byte)
Trainable params: 113 (452.00 Byte)
Non-trainable params: 0 (0.00 Byte)
_________________________________________________________________</code></pre>
</div>
</div>
<p><code>-</code> compile &amp; fit</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:3,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1696316542462,&quot;user&quot;:{&quot;displayName&quot;:&quot;ccc flkwerkdai&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-execution_count="364">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb100-1"><a href="#cb100-1"></a>model2.<span class="bu">compile</span>(optimizer <span class="op">=</span> Adam(learning_rate <span class="op">=</span> lr), loss <span class="op">=</span> <span class="st">"mse"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:5002,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1696316548235,&quot;user&quot;:{&quot;displayName&quot;:&quot;ccc flkwerkdai&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-execution_count="365">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb101-1"><a href="#cb101-1"></a><span class="cf">with</span> tf.device(<span class="st">'/device:GPU:0'</span>) :</span>
<span id="cb101-2"><a href="#cb101-2"></a>     model2.fit(x_train,y_train,epochs <span class="op">=</span> e, validation_split <span class="op">=</span> <span class="fl">0.2</span>, verbose <span class="op">=</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:3,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1696316548235,&quot;user&quot;:{&quot;displayName&quot;:&quot;ccc flkwerkdai&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-execution_count="366">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb102-1"><a href="#cb102-1"></a>model2_train_loss <span class="op">=</span> model2.history.history[<span class="st">"loss"</span>]</span>
<span id="cb102-2"><a href="#cb102-2"></a>model2_val_loss <span class="op">=</span> model2.history.history[<span class="st">"val_loss"</span>]</span>
<span id="cb102-3"><a href="#cb102-3"></a></span>
<span id="cb102-4"><a href="#cb102-4"></a>total_train.loc[:,<span class="dv">1</span>] <span class="op">=</span> model2_train_loss</span>
<span id="cb102-5"><a href="#cb102-5"></a>total_val.loc[:,<span class="dv">1</span>] <span class="op">=</span> model2_val_loss</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:801,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1696316549034,&quot;user&quot;:{&quot;displayName&quot;:&quot;ccc flkwerkdai&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-outputid="aec28e43-4696-41ce-aa42-503cf943bbba" data-execution_count="367">
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb103-1"><a href="#cb103-1"></a>model2_pred <span class="op">=</span> model2.predict(x_val).reshape(<span class="op">-</span><span class="dv">1</span>)</span>
<span id="cb103-2"><a href="#cb103-2"></a>total_pred.loc[:,<span class="dv">1</span>] <span class="op">=</span> model2_pred</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>4/4 [==============================] - 0s 3ms/step</code></pre>
</div>
</div>
</section>
<section id="model3-설계" class="level4">
<h4 class="anchored" data-anchor-id="model3-설계">model3 설계</h4>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: center;">model</th>
<th style="text-align: center;">은닉층</th>
<th style="text-align: center;">각 층에서 은닉노드의 개수</th>
<th style="text-align: center;">params</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">model1</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">(2,1)</td>
<td style="text-align: center;">26 + 3 = 29</td>
</tr>
<tr class="even">
<td style="text-align: center;">model2</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">(8,1)</td>
<td style="text-align: center;">104 + 9 = 113</td>
</tr>
<tr class="odd">
<td style="text-align: center;">model3</td>
<td style="text-align: center;">3</td>
<td style="text-align: center;">(8,4,1)</td>
<td style="text-align: center;">104 + 36 + 5 = 145</td>
</tr>
</tbody>
</table>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:3,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1696316549750,&quot;user&quot;:{&quot;displayName&quot;:&quot;ccc flkwerkdai&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-outputid="ca368983-a052-405e-9958-c41c3fb119e6" data-execution_count="368">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb105-1"><a href="#cb105-1"></a>model3 <span class="op">=</span> Sequential(Dense(<span class="dv">8</span>, input_shape <span class="op">=</span> (nf,), activation <span class="op">=</span> at))</span>
<span id="cb105-2"><a href="#cb105-2"></a></span>
<span id="cb105-3"><a href="#cb105-3"></a>model3.add(Dense(<span class="dv">4</span>, activation <span class="op">=</span> at))</span>
<span id="cb105-4"><a href="#cb105-4"></a></span>
<span id="cb105-5"><a href="#cb105-5"></a>model3.add(Dense(<span class="dv">1</span>, activation <span class="op">=</span> at))</span>
<span id="cb105-6"><a href="#cb105-6"></a>model3.summary()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Model: "sequential_2"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 dense_4 (Dense)             (None, 8)                 104       
                                                                 
 dense_5 (Dense)             (None, 4)                 36        
                                                                 
 dense_6 (Dense)             (None, 1)                 5         
                                                                 
=================================================================
Total params: 145 (580.00 Byte)
Trainable params: 145 (580.00 Byte)
Non-trainable params: 0 (0.00 Byte)
_________________________________________________________________</code></pre>
</div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:1,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1696316551188,&quot;user&quot;:{&quot;displayName&quot;:&quot;ccc flkwerkdai&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-execution_count="369">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb107-1"><a href="#cb107-1"></a>model3.<span class="bu">compile</span>(optimizer<span class="op">=</span>Adam(learning_rate<span class="op">=</span>lr), loss <span class="op">=</span> <span class="st">"mse"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:5617,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1696316557784,&quot;user&quot;:{&quot;displayName&quot;:&quot;ccc flkwerkdai&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-execution_count="370">
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb108-1"><a href="#cb108-1"></a><span class="cf">with</span> tf.device(<span class="st">'/device:GPU:0'</span>) :</span>
<span id="cb108-2"><a href="#cb108-2"></a>     model3.fit(x_train,y_train,epochs <span class="op">=</span> e, validation_split <span class="op">=</span> <span class="fl">0.2</span>, verbose <span class="op">=</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:4,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1696316557784,&quot;user&quot;:{&quot;displayName&quot;:&quot;ccc flkwerkdai&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-outputid="c561206a-8854-439d-e04f-dbfc93e8c53d" data-execution_count="371">
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb109-1"><a href="#cb109-1"></a>model3_train_loss <span class="op">=</span> model3.history.history[<span class="st">"loss"</span>]</span>
<span id="cb109-2"><a href="#cb109-2"></a>model3_val_loss <span class="op">=</span> model3.history.history[<span class="st">"val_loss"</span>]</span>
<span id="cb109-3"><a href="#cb109-3"></a></span>
<span id="cb109-4"><a href="#cb109-4"></a>total_train.loc[:,<span class="dv">2</span>] <span class="op">=</span> model3_train_loss</span>
<span id="cb109-5"><a href="#cb109-5"></a>total_val.loc[:,<span class="dv">2</span>] <span class="op">=</span> model3_val_loss</span>
<span id="cb109-6"><a href="#cb109-6"></a></span>
<span id="cb109-7"><a href="#cb109-7"></a>model3_pred <span class="op">=</span> model3.predict(x_val).reshape(<span class="op">-</span><span class="dv">1</span>)</span>
<span id="cb109-8"><a href="#cb109-8"></a>total_pred.loc[:,<span class="dv">2</span>] <span class="op">=</span> model3_pred</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>4/4 [==============================] - 0s 3ms/step</code></pre>
</div>
</div>
<p><code>-</code>결과 시각화</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: center;">model</th>
<th style="text-align: center;">은닉층</th>
<th style="text-align: center;">각 층에서 은닉노드의 개수</th>
<th style="text-align: center;">params</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">model1</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">(2,1)</td>
<td style="text-align: center;">26 + 3 = 29</td>
</tr>
<tr class="even">
<td style="text-align: center;">model2</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">(8,1)</td>
<td style="text-align: center;">104 + 9 = 113</td>
</tr>
<tr class="odd">
<td style="text-align: center;">model3</td>
<td style="text-align: center;">3</td>
<td style="text-align: center;">(8,4,1)</td>
<td style="text-align: center;">104 + 36 + 5 = 145</td>
</tr>
</tbody>
</table>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:2,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1696317048223,&quot;user&quot;:{&quot;displayName&quot;:&quot;ccc flkwerkdai&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-execution_count="393">
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb111-1"><a href="#cb111-1"></a>total_train.columns <span class="op">=</span> [<span class="st">"model1"</span>, <span class="st">"model2"</span>,<span class="st">"model3"</span>]</span>
<span id="cb111-2"><a href="#cb111-2"></a>total_val.columns <span class="op">=</span> [<span class="st">"model1"</span>, <span class="st">"model2"</span>,<span class="st">"model3"</span>]</span>
<span id="cb111-3"><a href="#cb111-3"></a>total_pred.columns <span class="op">=</span> [<span class="st">"model1"</span>, <span class="st">"model2"</span>,<span class="st">"model3"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><code>-</code> tidydata 생성</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:1103,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1696317376363,&quot;user&quot;:{&quot;displayName&quot;:&quot;ccc flkwerkdai&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-execution_count="409">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb112-1"><a href="#cb112-1"></a>total_train2 <span class="op">=</span> total_train.melt(var_name <span class="op">=</span> <span class="st">"model"</span>,</span>
<span id="cb112-2"><a href="#cb112-2"></a>                 value_name <span class="op">=</span><span class="st">"loss"</span>)</span>
<span id="cb112-3"><a href="#cb112-3"></a>total_train2[<span class="st">"label"</span>] <span class="op">=</span> <span class="st">"train"</span></span>
<span id="cb112-4"><a href="#cb112-4"></a>total_train2[<span class="st">"epochs"</span>] <span class="op">=</span> <span class="bu">list</span>(<span class="bu">range</span>(<span class="dv">1</span>,<span class="dv">51</span>))<span class="op">*</span><span class="dv">3</span></span>
<span id="cb112-5"><a href="#cb112-5"></a></span>
<span id="cb112-6"><a href="#cb112-6"></a></span>
<span id="cb112-7"><a href="#cb112-7"></a>total_val2 <span class="op">=</span> total_val.melt(var_name <span class="op">=</span> <span class="st">"model"</span>,</span>
<span id="cb112-8"><a href="#cb112-8"></a>                 value_name <span class="op">=</span><span class="st">"loss"</span>)</span>
<span id="cb112-9"><a href="#cb112-9"></a>total_val2[<span class="st">"label"</span>] <span class="op">=</span> <span class="st">"val"</span></span>
<span id="cb112-10"><a href="#cb112-10"></a>total_val2[<span class="st">"epochs"</span>] <span class="op">=</span> <span class="bu">list</span>(<span class="bu">range</span>(<span class="dv">1</span>,<span class="dv">51</span>))<span class="op">*</span><span class="dv">3</span></span>
<span id="cb112-11"><a href="#cb112-11"></a></span>
<span id="cb112-12"><a href="#cb112-12"></a></span>
<span id="cb112-13"><a href="#cb112-13"></a>total1 <span class="op">=</span> pd.concat([total_train2, total_val2],axis <span class="op">=</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><code>-</code> train, val loss 시각화</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:564,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1696317788459,&quot;user&quot;:{&quot;displayName&quot;:&quot;ccc flkwerkdai&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-outputid="15f75d2d-4ad8-4768-b1dc-eb8e70901cf9" data-execution_count="422">
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb113-1"><a href="#cb113-1"></a>fig <span class="op">=</span> total1.plot(x<span class="op">=</span> <span class="st">"epochs"</span>, y <span class="op">=</span> <span class="st">"loss"</span>,</span>
<span id="cb113-2"><a href="#cb113-2"></a>            color <span class="op">=</span> <span class="st">"label"</span>, facet_col <span class="op">=</span> <span class="st">"model"</span>,kind <span class="op">=</span> <span class="st">"scatter"</span>,</span>
<span id="cb113-3"><a href="#cb113-3"></a>            backend <span class="op">=</span> <span class="st">"plotly"</span>, width <span class="op">=</span> <span class="dv">1200</span>, height <span class="op">=</span> <span class="dv">400</span>, opacity<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb113-4"><a href="#cb113-4"></a>fig.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">


<meta charset="utf-8">

    <div>            <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_SVG"></script><script type="text/javascript">if (window.MathJax && window.MathJax.Hub && window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}</script>                <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script charset="utf-8" src="https://cdn.plot.ly/plotly-2.24.1.min.js"></script>                <div id="5aec7018-358d-4347-8283-24a833bede8c" class="plotly-graph-div" style="height:400px; width:1200px;"></div>            <script type="text/javascript">                                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("5aec7018-358d-4347-8283-24a833bede8c")) {                    Plotly.newPlot(                        "5aec7018-358d-4347-8283-24a833bede8c",                        [{"hovertemplate":"label=train\u003cbr\u003emodel=model1\u003cbr\u003eepochs=%{x}\u003cbr\u003eloss=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"train","marker":{"color":"#636efa","opacity":0.5,"symbol":"circle"},"mode":"markers","name":"train","orientation":"v","showlegend":true,"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50],"xaxis":"x","y":[588.3671875,564.5887451171875,535.0449829101562,499.7142028808594,457.7481689453125,412.3114318847656,364.2822570800781,316.9623107910156,273.6578369140625,236.1331024169922,206.0424041748047,184.97779846191406,168.77171325683594,159.07167053222656,152.2201690673828,145.8559112548828,140.6610565185547,135.817626953125,131.44015502929688,127.4608383178711,123.51642608642578,119.42896270751953,115.94258117675781,112.06487274169922,108.33552551269531,104.8267593383789,101.44517517089844,98.12740325927734,95.16477966308594,92.4450912475586,89.38923645019531,85.40888214111328,82.1517105102539,77.12019348144531,72.90023040771484,68.59927368164062,64.48526763916016,61.131439208984375,58.62015151977539,56.58134078979492,54.66424560546875,52.7150993347168,50.593109130859375,48.885231018066406,47.273712158203125,45.699249267578125,44.28995132446289,43.329166412353516,42.29775619506836,41.22629165649414],"yaxis":"y","type":"scatter"},{"hovertemplate":"label=train\u003cbr\u003emodel=model2\u003cbr\u003eepochs=%{x}\u003cbr\u003eloss=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"train","marker":{"color":"#636efa","opacity":0.5,"symbol":"circle"},"mode":"markers","name":"train","orientation":"v","showlegend":false,"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50],"xaxis":"x2","y":[568.6937255859375,525.255126953125,461.0907897949219,370.0251159667969,276.9706115722656,206.15530395507812,169.4698944091797,153.23275756835938,143.6080322265625,132.70863342285156,124.26922607421875,115.19477081298828,107.60102081298828,100.62480926513672,94.28861999511719,88.2003173828125,83.1274185180664,78.54823303222656,74.83384704589844,71.41387176513672,68.59848022460938,65.87916564941406,64.20378112792969,63.004661560058594,61.21358108520508,59.97818374633789,58.56559753417969,57.60926055908203,56.303314208984375,55.49462890625,54.59100341796875,53.38821792602539,52.450199127197266,51.5242919921875,50.494998931884766,49.740203857421875,48.66935348510742,47.75958251953125,47.18976593017578,46.069271087646484,45.48316192626953,45.01009750366211,43.10610580444336,42.41312789916992,41.68061447143555,40.96101379394531,40.431461334228516,39.50993728637695,38.97520446777344,38.21408462524414],"yaxis":"y2","type":"scatter"},{"hovertemplate":"label=train\u003cbr\u003emodel=model3\u003cbr\u003eepochs=%{x}\u003cbr\u003eloss=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"train","marker":{"color":"#636efa","opacity":0.5,"symbol":"circle"},"mode":"markers","name":"train","orientation":"v","showlegend":false,"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50],"xaxis":"x3","y":[528.1237182617188,367.9937744140625,207.1160430908203,151.3037872314453,122.30812072753906,100.86581420898438,82.0274658203125,70.4297866821289,61.795345306396484,57.78582000732422,53.71626663208008,51.00015640258789,48.484230041503906,46.223609924316406,43.885597229003906,41.64697265625,39.818641662597656,38.273834228515625,36.19548034667969,34.1076545715332,33.10211181640625,30.400556564331055,29.30601692199707,28.68189811706543,27.257909774780273,27.077707290649414,27.198572158813477,25.108360290527344,24.43914031982422,25.29930877685547,24.103736877441406,23.761409759521484,23.808372497558594,23.8420467376709,23.455448150634766,22.559131622314453,22.248279571533203,22.455398559570312,21.457077026367188,22.299571990966797,21.260971069335938,20.83519744873047,20.323760986328125,20.462060928344727,19.875259399414062,19.62991714477539,24.13567352294922,19.47357177734375,18.226449966430664,17.68700408935547],"yaxis":"y3","type":"scatter"},{"hovertemplate":"label=val\u003cbr\u003emodel=model1\u003cbr\u003eepochs=%{x}\u003cbr\u003eloss=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"val","marker":{"color":"#EF553B","opacity":0.5,"symbol":"circle"},"mode":"markers","name":"val","orientation":"v","showlegend":true,"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50],"xaxis":"x","y":[632.5967407226562,604.491943359375,570.4749145507812,529.7796630859375,483.4343566894531,433.413818359375,382.62481689453125,334.7388000488281,292.56439208984375,257.4813232421875,229.4046630859375,209.4788818359375,195.5582275390625,186.1837615966797,178.7000732421875,171.21888732910156,164.1680908203125,158.13031005859375,152.35406494140625,147.3336181640625,142.34136962890625,137.31729125976562,132.31661987304688,126.9315185546875,122.39741516113281,118.13980865478516,113.76080322265625,109.23855590820312,104.6856689453125,100.92227172851562,96.85335540771484,91.7296371459961,86.4291000366211,80.19831085205078,74.11271667480469,68.21316528320312,62.85672378540039,58.50381088256836,55.792171478271484,53.365455627441406,50.43592834472656,47.21078109741211,44.63618850708008,43.67142105102539,41.78681182861328,40.42890167236328,39.07493209838867,38.282474517822266,36.921165466308594,37.19845199584961],"yaxis":"y","type":"scatter"},{"hovertemplate":"label=val\u003cbr\u003emodel=model2\u003cbr\u003eepochs=%{x}\u003cbr\u003eloss=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"val","marker":{"color":"#EF553B","opacity":0.5,"symbol":"circle"},"mode":"markers","name":"val","orientation":"v","showlegend":false,"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50],"xaxis":"x2","y":[601.425048828125,546.0784301757812,458.8454895019531,357.87969970703125,270.44281005859375,212.93321228027344,187.29127502441406,174.21792602539062,161.14663696289062,148.29190063476562,137.2145233154297,126.24430084228516,116.4673843383789,107.99946594238281,99.1494140625,91.21533966064453,84.086669921875,78.0074234008789,72.97051239013672,68.29438018798828,63.82099914550781,61.295013427734375,59.85700607299805,56.56626892089844,54.74696731567383,54.011695861816406,51.40992736816406,49.844852447509766,49.199153900146484,48.58934783935547,47.17330551147461,45.587249755859375,44.2573356628418,43.3407096862793,42.73908615112305,41.34574890136719,41.00569534301758,39.988521575927734,39.940940856933594,37.941253662109375,36.88066482543945,36.109039306640625,35.751182556152344,35.18441390991211,34.57558059692383,34.272117614746094,33.10518264770508,32.18994140625,31.26651382446289,31.269084930419922],"yaxis":"y2","type":"scatter"},{"hovertemplate":"label=val\u003cbr\u003emodel=model3\u003cbr\u003eepochs=%{x}\u003cbr\u003eloss=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"val","marker":{"color":"#EF553B","opacity":0.5,"symbol":"circle"},"mode":"markers","name":"val","orientation":"v","showlegend":false,"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50],"xaxis":"x3","y":[496.4258728027344,303.5113830566406,187.9069061279297,158.30718994140625,125.67039489746094,96.04783630371094,75.47361755371094,60.39219665527344,53.820045471191406,45.852386474609375,42.374149322509766,40.36226272583008,37.12623596191406,34.863197326660156,33.51593780517578,30.171600341796875,27.97578239440918,27.972002029418945,23.656309127807617,22.142391204833984,21.18473243713379,18.426424026489258,18.074064254760742,16.353992462158203,15.047327041625977,17.136146545410156,14.28102970123291,13.868989944458008,15.503846168518066,13.047779083251953,12.561248779296875,12.034578323364258,12.167716026306152,12.443278312683105,12.161230087280273,13.448431015014648,11.61343002319336,12.142644882202148,11.203574180603027,12.668275833129883,10.947221755981445,12.5856351852417,10.591748237609863,12.052739143371582,11.113462448120117,10.803330421447754,15.226274490356445,10.51226806640625,11.124387741088867,10.630871772766113],"yaxis":"y3","type":"scatter"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"xaxis":{"anchor":"y","domain":[0.0,0.31999999999999995],"title":{"text":"epochs"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"loss"}},"xaxis2":{"anchor":"y2","domain":[0.33999999999999997,0.6599999999999999],"matches":"x","title":{"text":"epochs"}},"yaxis2":{"anchor":"x2","domain":[0.0,1.0],"matches":"y","showticklabels":false},"xaxis3":{"anchor":"y3","domain":[0.6799999999999999,0.9999999999999999],"matches":"x","title":{"text":"epochs"}},"yaxis3":{"anchor":"x3","domain":[0.0,1.0],"matches":"y","showticklabels":false},"annotations":[{"font":{},"showarrow":false,"text":"model=model1","x":0.15999999999999998,"xanchor":"center","xref":"paper","y":1.0,"yanchor":"bottom","yref":"paper"},{"font":{},"showarrow":false,"text":"model=model2","x":0.49999999999999994,"xanchor":"center","xref":"paper","y":1.0,"yanchor":"bottom","yref":"paper"},{"font":{},"showarrow":false,"text":"model=model3","x":0.8399999999999999,"xanchor":"center","xref":"paper","y":1.0,"yanchor":"bottom","yref":"paper"}],"legend":{"title":{"text":"label"},"tracegroupgap":0},"margin":{"t":60},"height":400,"width":1200},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('5aec7018-358d-4347-8283-24a833bede8c');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                            </script>        </div>


</div>
</div>
<p><code>-</code> train, val loss만 보면 <code>model2</code>가 가장 잘 적합된 모델인 것 같다.</p>
<p><code>-</code> test data 예측결과 시각화</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:2,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1696318092694,&quot;user&quot;:{&quot;displayName&quot;:&quot;ccc flkwerkdai&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-execution_count="434">
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb114-1"><a href="#cb114-1"></a>total_pred[<span class="st">"y_true"</span>] <span class="op">=</span> y_val.reset_index(drop<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:1304,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1696318281534,&quot;user&quot;:{&quot;displayName&quot;:&quot;ccc flkwerkdai&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-outputid="ed895ad1-0310-430a-c599-0ac790b5333e" data-execution_count="445">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb115-1"><a href="#cb115-1"></a>fig, axes <span class="op">=</span> plt.subplots(<span class="dv">1</span>,<span class="dv">3</span>,figsize <span class="op">=</span> (<span class="dv">12</span>,<span class="dv">4</span>))</span>
<span id="cb115-2"><a href="#cb115-2"></a></span>
<span id="cb115-3"><a href="#cb115-3"></a>ax1, ax2, ax3 <span class="op">=</span> axes</span>
<span id="cb115-4"><a href="#cb115-4"></a>ax1.plot(total_pred[<span class="st">"y_true"</span>], label <span class="op">=</span>  <span class="vs">r"$y_</span><span class="sc">{true}</span><span class="vs">$"</span>, alpha <span class="op">=</span> <span class="fl">0.5</span>)</span>
<span id="cb115-5"><a href="#cb115-5"></a>ax1.plot(total_pred[<span class="st">"model1"</span>],<span class="st">"--g"</span>, label <span class="op">=</span>  <span class="vs">r"$y_</span><span class="sc">{model1}</span><span class="vs">$"</span>)</span>
<span id="cb115-6"><a href="#cb115-6"></a>ax1.legend()</span>
<span id="cb115-7"><a href="#cb115-7"></a></span>
<span id="cb115-8"><a href="#cb115-8"></a>ax2.plot(total_pred[<span class="st">"y_true"</span>], label <span class="op">=</span>  <span class="vs">r"$y_</span><span class="sc">{true}</span><span class="vs">$"</span>, alpha <span class="op">=</span> <span class="fl">0.5</span>)</span>
<span id="cb115-9"><a href="#cb115-9"></a>ax2.plot(total_pred[<span class="st">"model2"</span>],<span class="st">"--r"</span>, label <span class="op">=</span>  <span class="vs">r"$y_</span><span class="sc">{model2}</span><span class="vs">$"</span>)</span>
<span id="cb115-10"><a href="#cb115-10"></a>ax2.legend()</span>
<span id="cb115-11"><a href="#cb115-11"></a></span>
<span id="cb115-12"><a href="#cb115-12"></a>ax3.plot(total_pred[<span class="st">"y_true"</span>], label <span class="op">=</span>  <span class="vs">r"$y_</span><span class="sc">{true}</span><span class="vs">$"</span>, alpha <span class="op">=</span> <span class="fl">0.5</span>)</span>
<span id="cb115-13"><a href="#cb115-13"></a>ax3.plot(total_pred[<span class="st">"model3"</span>],<span class="st">"--b"</span>, label <span class="op">=</span>  <span class="vs">r"$y_</span><span class="sc">{model3}</span><span class="vs">$"</span>)</span>
<span id="cb115-14"><a href="#cb115-14"></a>ax3.legend()</span>
<span id="cb115-15"><a href="#cb115-15"></a></span>
<span id="cb115-16"><a href="#cb115-16"></a>fig.tight_layout()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="2023-10-03-00. 딥러닝 (1)_files/figure-html/cell-86-output-1.png" class="img-fluid"></p>
</div>
</div>
<p><code>-</code> test data에 대한 예측결과 <code>model3</code>가 가장 잘 예측하고 있는것 같다.</p>
<ul>
<li>근데 이것을 수치적으로 확인하기 위해 <code>MAE</code> 수치만 비교해보자.</li>
</ul>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:757,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1696318650613,&quot;user&quot;:{&quot;displayName&quot;:&quot;ccc flkwerkdai&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-outputid="57889995-b007-40ec-b69c-c836e3d0dafc" data-execution_count="449">
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb116-1"><a href="#cb116-1"></a>model1_mae <span class="op">=</span> mean_absolute_error(y_val, model1_pred)</span>
<span id="cb116-2"><a href="#cb116-2"></a>model2_mae <span class="op">=</span> mean_absolute_error(y_val, model2_pred)</span>
<span id="cb116-3"><a href="#cb116-3"></a>model3_mae <span class="op">=</span> mean_absolute_error(y_val, model3_pred)</span>
<span id="cb116-4"><a href="#cb116-4"></a></span>
<span id="cb116-5"><a href="#cb116-5"></a>mae <span class="op">=</span> [model1_mae, model2_mae, model3_mae]</span>
<span id="cb116-6"><a href="#cb116-6"></a>model <span class="op">=</span> [<span class="st">"model1"</span>, <span class="st">"model2"</span>,<span class="st">"model3"</span>]</span>
<span id="cb116-7"><a href="#cb116-7"></a></span>
<span id="cb116-8"><a href="#cb116-8"></a>fig <span class="op">=</span> pd.DataFrame({<span class="st">"model"</span>: model,<span class="st">"mae"</span> : mae}).<span class="op">\</span></span>
<span id="cb116-9"><a href="#cb116-9"></a>      plot(kind <span class="op">=</span> <span class="st">"bar"</span>,backend <span class="op">=</span> <span class="st">"plotly"</span>,</span>
<span id="cb116-10"><a href="#cb116-10"></a>           x <span class="op">=</span> <span class="st">"model"</span>, y<span class="op">=</span> <span class="st">"mae"</span>,color <span class="op">=</span> <span class="st">"model"</span>,width <span class="op">=</span> <span class="dv">400</span>, height <span class="op">=</span> <span class="dv">400</span>,</span>
<span id="cb116-11"><a href="#cb116-11"></a>              title <span class="op">=</span> <span class="st">"Mean Absolute error by model"</span>)</span>
<span id="cb116-12"><a href="#cb116-12"></a>fig.update_yaxes(<span class="bu">range</span> <span class="op">=</span> (<span class="dv">3</span>,<span class="fl">4.5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">


<meta charset="utf-8">

    <div>            <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_SVG"></script><script type="text/javascript">if (window.MathJax && window.MathJax.Hub && window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}</script>                <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script charset="utf-8" src="https://cdn.plot.ly/plotly-2.24.1.min.js"></script>                <div id="a5de88ba-2e31-4744-95da-c996a064a022" class="plotly-graph-div" style="height:400px; width:400px;"></div>            <script type="text/javascript">                                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("a5de88ba-2e31-4744-95da-c996a064a022")) {                    Plotly.newPlot(                        "a5de88ba-2e31-4744-95da-c996a064a022",                        [{"alignmentgroup":"True","hovertemplate":"model=%{x}\u003cbr\u003emae=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"model1","marker":{"color":"#636efa","pattern":{"shape":""}},"name":"model1","offsetgroup":"model1","orientation":"v","showlegend":true,"textposition":"auto","x":["model1"],"xaxis":"x","y":[4.155901571348602],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","hovertemplate":"model=%{x}\u003cbr\u003emae=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"model2","marker":{"color":"#EF553B","pattern":{"shape":""}},"name":"model2","offsetgroup":"model2","orientation":"v","showlegend":true,"textposition":"auto","x":["model2"],"xaxis":"x","y":[4.15302646487367],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","hovertemplate":"model=%{x}\u003cbr\u003emae=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"model3","marker":{"color":"#00cc96","pattern":{"shape":""}},"name":"model3","offsetgroup":"model3","orientation":"v","showlegend":true,"textposition":"auto","x":["model3"],"xaxis":"x","y":[3.083148829142253],"yaxis":"y","type":"bar"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"model"},"categoryorder":"array","categoryarray":["model1","model2","model3"]},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"mae"},"range":[3,4.5]},"legend":{"title":{"text":"model"},"tracegroupgap":0},"title":{"text":"Mean Absolute error by model"},"barmode":"relative","height":400,"width":400},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('a5de88ba-2e31-4744-95da-c996a064a022');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                            </script>        </div>


</div>
</div>
</section>
</section>
<section id="summary-1" class="level3">
<h3 class="anchored" data-anchor-id="summary-1">(3) summary</h3>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: center;">model</th>
<th style="text-align: center;">은닉층</th>
<th style="text-align: center;">각 층에서 은닉노드의 개수</th>
<th style="text-align: center;">params</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">model1</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">(2,1)</td>
<td style="text-align: center;">26 + 3 = 29</td>
</tr>
<tr class="even">
<td style="text-align: center;">model2</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">(8,1)</td>
<td style="text-align: center;">104 + 9 = 113</td>
</tr>
<tr class="odd">
<td style="text-align: center;">model3</td>
<td style="text-align: center;">3</td>
<td style="text-align: center;">(8,4,1)</td>
<td style="text-align: center;">104 + 36 + 5 = 145</td>
</tr>
</tbody>
</table>
<ul>
<li><p><code>epochs, activation, learning_rate, optimizer</code>를 고정시켜놓고 은닉층의 수와 노드의 수에 따라 예측 성능을 비교해봤음</p></li>
<li><p>비교결과 <code>model2</code>가 가장 학습 데이터에 적합했으나 실제로는 <code>model3</code>와 비교해보면 과적합 문제가 의심됨.</p></li>
<li><p>insight1 : 은닉층의 수와 노드의 수 즉, 파라미터 수를 어떻게 조절하냐에 따라서도 모델 성능이 달라질 수 있음!!</p></li>
</ul>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../../../posts/DX/04. 머신러닝/2023-09-28-08. summary (1).html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">08. summary (1)</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../../../posts/DX/05. 딥러닝/2023-10-04-01. 딥러닝 (2).html" class="pagination-link">
        <span class="nav-page-text">01. 딥러닝 (2)</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>