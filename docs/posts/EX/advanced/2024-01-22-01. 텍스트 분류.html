<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.433">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="GC">
<meta name="dcterms.date" content="2024-01-22">

<title>C.I.C - 01. 텍스트 분류</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../">
<link href="../../../posts/EX/advanced/2024-01-22-02.이미지_분류.html" rel="next">
<link href="../../../posts/EX/advanced/2024-01-21-00. Associate review.html" rel="prev">
<script src="../../../site_libs/quarto-html/quarto.js"></script>
<script src="../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../../../styles.css">
</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">Posts</li><li class="breadcrumb-item"><a href="../../../posts/EX/2023-10-30-00. Churn.html">EX</a></li><li class="breadcrumb-item"><a href="../../../posts/EX/advanced/2024-01-08-04. MNIST.html">Advanced</a></li><li class="breadcrumb-item"><a href="../../../posts/EX/advanced/2024-01-22-01. 텍스트 분류.html">01. 텍스트 분류</a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">01. 텍스트 분류</h1>
                                <div class="quarto-categories">
                <div class="quarto-category">python</div>
                <div class="quarto-category">PRO</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>GC </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">January 22, 2024</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../../../">C.I.C</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../about.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><strong>About Me</strong></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Posts</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="false">
 <span class="menu-text">DX</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/2023-07-31-00.intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">00. Intro &amp; setting</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/2023-08-19-01. Plotly test.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">01. Plotly test</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/2023-10-26-02. BERTopic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">02. BERTopic</span></a>
  </div>
</li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false">
 <span class="menu-text">00. 데이터 다루기</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth3 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/00. 데이터 다루기/2023-08-09-00. Python Basic (1).html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">00. Python Basic (1)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/00. 데이터 다루기/2023-08-10-01. Python Basic (2) .html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">01. Python Basic (2)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/00. 데이터 다루기/2023-08-11-02. Python Basic (3) .html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">02. Python Basic (3)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/00. 데이터 다루기/2023-08-14-03. Python Basic (4).html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">03. Python Basic (4)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/00. 데이터 다루기/2023-08-16-04. Python Basic (5).html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">04. Python Basic (5)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/00. 데이터 다루기/2023-08-17-05. Python Basic (6).html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">05. Python Basic (6)</span></a>
  </div>
</li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="false">
 <span class="menu-text">Extra</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth4 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/00. 데이터 다루기/extra/2023-08-08-Extra 00. 밈.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Extra 00. 밈</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/00. 데이터 다루기/extra/2023-08-09-Extra 01. 클래스.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Extra 01. 클래스</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/00. 데이터 다루기/extra/2023-08-10-Extra 02. 클래스 탐구 (1).html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Extra 02. 클래스 탐구 (1)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/00. 데이터 다루기/extra/2023-08-14-Extra 03. 클래스 탐구 (2).html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Extra 03. 클래스 탐구 (2)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/00. 데이터 다루기/extra/2023-08-15-Extra 04. 클래스 탐구 (3).html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Extra 04. 클래스 탐구 (3)</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="false">
 <span class="menu-text">01. 데이터 다듬기</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth3 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/01. 데이터 다듬기/2023-08-18-00. numpy &amp; pandas (1).html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">00. numpy &amp; pandas (1)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/01. 데이터 다듬기/2023-08-18-01. numpy &amp; pandas (2).html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">01. numpy &amp; pandas (2)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/01. 데이터 다듬기/2023-08-21-02. numpy &amp; pandas (3).html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">02. numpy &amp; pandas (3)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/01. 데이터 다듬기/2023-08-22-03. numpy &amp; pandas (4).html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">03. numpy &amp; pandas (4)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/01. 데이터 다듬기/2023-08-23-04. numpy &amp; pandas (5).html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">04. numpy &amp; pandas (5)</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="false">
 <span class="menu-text">02. 데이터 분석</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth3 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/02. 데이터 분석/2023-08-28-00. 데이터 분석 (1).html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">00. 데이터 분석 (1)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/02. 데이터 분석/2023-08-29-01. 데이터 분석 (2).html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">01. 데이터 분석 (2)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/02. 데이터 분석/2023-09-01-02. 데이터 분석 (2).html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">02. 데이터 분석 (3)</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="false">
 <span class="menu-text">03. 데이터 수집</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth3 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/03. 데이터 수집/2023-09-04-00. 데이터 수집 (1).html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">00. 데이터 수집 (1)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/03. 데이터 수집/2023-09-05-01. 데이터 수집 (2).html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">01. 데이터 수집 (2)</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="false">
 <span class="menu-text">04. 머신러닝</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth3 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/04. 머신러닝/2023-09-11-00. intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">00. Intro</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/04. 머신러닝/2023-09-12-01. 머신러닝 (1).html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">01. 머신러닝 (1)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/04. 머신러닝/2023-09-13-02. 머신러닝 (2).html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">02. 머신러닝 (2)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/04. 머신러닝/2023-09-14-03. 머신러닝 (3).html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">03. 머신러닝 (3)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/04. 머신러닝/2023-09-15-04. 머신러닝 (4).html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">04. 머신러닝 (4)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/04. 머신러닝/2023-09-15-05. 종합실습.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">05. 종합실습</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/04. 머신러닝/2023-09-18-06. 머신러닝 (5).html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">06. 머신러닝 (5)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/04. 머신러닝/2023-09-19-07. 머신러닝 (6).html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">07. 머신러닝 (6)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/04. 머신러닝/2023-09-28-08. summary (1).html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">08. summary (1)</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" aria-expanded="false">
 <span class="menu-text">05. 딥러닝</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth3 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/05. 딥러닝/2023-10-03-00. 딥러닝 (1).html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">00. 딥러닝 (1)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/05. 딥러닝/2023-10-04-01. 딥러닝 (2).html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">01. 딥러닝 (2)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/05. 딥러닝/2023-10-05-02. 딥러닝 (3).html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">02. 딥러닝 (3)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/05. 딥러닝/2023-10-06-03. 딥러닝 (4).html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">03. 딥러닝 (4)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/05. 딥러닝/2023-10-10-Extra 01. 언어지능 (1).html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Extra 01. 언어지능</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/05. 딥러닝/2023-10-11-Extra 02. 시각지능.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Extra 02. 시각지능</span></a>
  </div>
</li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" aria-expanded="false">
 <span class="menu-text">Summary</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-10" class="collapse list-unstyled sidebar-section depth4 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/05. 딥러닝/summary/2023-10-18-summary 01. RNN.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">summary 01. RNN</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/05. 딥러닝/summary/2023-10-18-summary 02. LSTM.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">summary 02. LSTM</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/05. 딥러닝/summary/2023-10-18-summary 03. transformer.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">summary 03. Transformer</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" aria-expanded="false">
 <span class="menu-text">06. 데이터분석표현</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-11" class="collapse list-unstyled sidebar-section depth3 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/06. 데이터분석표현/2023-10-23-00. streamlit.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">00. streamlit</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-12" aria-expanded="false">
 <span class="menu-text">07. IT 인프라</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-12" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-12" class="collapse list-unstyled sidebar-section depth3 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/07. IT 인프라/2023-11-06-00. IT 인프라 (1).html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">00. IT 인프라 (1)</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-13" aria-expanded="false">
 <span class="menu-text">09. 제안전략수립</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-13" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-13" class="collapse list-unstyled sidebar-section depth3 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/09. 제안전략수립/2023-11-23-00. 제안전략수립.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">00. 제안전략수립</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/09. 제안전략수립/2023-11-24-01. 환경분석 기법의 이해.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">01. 환경분석 기법의 이해</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/09. 제안전략수립/2023-11-27-02. 고객가치정의 및 아이디어 도출.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">02. 고객가치정의 및 아이디어 도출</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/09. 제안전략수립/2023-11-28-03. 실행계획 수립.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">03. 실행계획 수립</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/09. 제안전략수립/2023-11-29-04. 사업정의.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">04. 사업정의</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/09. 제안전략수립/2023-11-30-05. 제안서 작성 (1).html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">05. 제안서 작성 (1)</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-14" aria-expanded="false">
 <span class="menu-text">BP</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-14" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-14" class="collapse list-unstyled sidebar-section depth3 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/BP/2023-12-28-00. model train (1).html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">00. model train (1)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/BP/2023-12-28-01. model train (2).html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">01. model train (2)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/BP/2023-12-28-02. model fit &amp; save.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">02. model fit &amp; save</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/BP/2024-01-01-03. model theory.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">03. model theory</span></a>
  </div>
</li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-15" aria-expanded="false">
 <span class="menu-text">Extra</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-15" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-15" class="collapse list-unstyled sidebar-section depth4 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/BP/Extra/2024-01-15-00. CA (1).html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">00. CA (1)</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-16" aria-expanded="false">
 <span class="menu-text">MP</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-16" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-16" class="collapse list-unstyled sidebar-section depth3 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/DX/MP/2023-08-24-00. MP (1).html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">00. MP (1)</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-17" aria-expanded="true">
 <span class="menu-text">EX</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-17" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-17" class="collapse list-unstyled sidebar-section depth2 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/EX/2023-10-30-00. Churn.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">00. Churn</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/EX/2023-10-31-01. VOC.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">01. VOC</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/EX/2023-11-01-02. iris.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">02. iris</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/EX/2023-11-01-03. Titanic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">03. Titanic</span></a>
  </div>
</li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-18" aria-expanded="true">
 <span class="menu-text">Advanced</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-18" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-18" class="collapse list-unstyled sidebar-section depth3 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/EX/advanced/2024-01-08-04. MNIST.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">04. MNIST</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/EX/advanced/2024-01-21-00. Associate review.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">00. Associate Review</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/EX/advanced/2024-01-22-01. 텍스트 분류.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">01. 텍스트 분류</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/EX/advanced/2024-01-22-02.이미지_분류.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">02. 이미지 분류</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#데이터-로드" id="toc-데이터-로드" class="nav-link active" data-scroll-target="#데이터-로드">데이터 로드</a></li>
  <li><a href="#eda" id="toc-eda" class="nav-link" data-scroll-target="#eda">EDA</a>
  <ul class="collapse">
  <li><a href="#리뷰-길이-분포-확인" id="toc-리뷰-길이-분포-확인" class="nav-link" data-scroll-target="#리뷰-길이-분포-확인">리뷰 길이 분포 확인</a></li>
  <li><a href="#라벨-분포-확인" id="toc-라벨-분포-확인" class="nav-link" data-scroll-target="#라벨-분포-확인">라벨 분포 확인</a></li>
  <li><a href="#정수-맵핑-단어-확인" id="toc-정수-맵핑-단어-확인" class="nav-link" data-scroll-target="#정수-맵핑-단어-확인">정수 맵핑 단어 확인</a></li>
  </ul></li>
  <li><a href="#모델-설계-1.simplernn-embedding" id="toc-모델-설계-1.simplernn-embedding" class="nav-link" data-scroll-target="#모델-설계-1.simplernn-embedding">모델 설계 1.SimpleRNN + Embedding</a>
  <ul class="collapse">
  <li><a href="#loss-시각화" id="toc-loss-시각화" class="nav-link" data-scroll-target="#loss-시각화">loss 시각화</a></li>
  <li><a href="#predict" id="toc-predict" class="nav-link" data-scroll-target="#predict">predict</a></li>
  </ul></li>
  <li><a href="#모델-설계-2.-lstm" id="toc-모델-설계-2.-lstm" class="nav-link" data-scroll-target="#모델-설계-2.-lstm">모델 설계 2. LSTM</a></li>
  <li><a href="#모델-설계3.-cnn" id="toc-모델-설계3.-cnn" class="nav-link" data-scroll-target="#모델-설계3.-cnn">모델 설계3. CNN</a></li>
  <li><a href="#summary" id="toc-summary" class="nav-link" data-scroll-target="#summary">summary</a></li>
  <li><a href="#do-next" id="toc-do-next" class="nav-link" data-scroll-target="#do-next">do next</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<p><code>-</code> <a href="https://www.tensorflow.org/tutorials/keras/text_classification?hl=ko">tensorflow 튜토리얼 : 영화 리뷰를 사용한 텍스트 분류</a></p>
<p><code>-</code> environment : [colab]</p>
<section id="데이터-로드" class="level1">
<h1>데이터 로드</h1>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:5,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1705837156839,&quot;user&quot;:{&quot;displayName&quot;:&quot;ccc flkwerkdai&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-tags="[]" data-execution_count="21">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1"></a><span class="im">import</span> tensorflow <span class="im">as</span> tf</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="co">#plt.rcParams["font.family"] = "Malgun Gothic"  코랩에서는 안됨</span></span>
<span id="cb1-4"><a href="#cb1-4"></a></span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="im">from</span> tensorflow <span class="im">import</span> keras</span>
<span id="cb1-6"><a href="#cb1-6"></a></span>
<span id="cb1-7"><a href="#cb1-7"></a><span class="im">from</span> keras.models <span class="im">import</span> <span class="op">*</span></span>
<span id="cb1-8"><a href="#cb1-8"></a><span class="im">from</span> keras.layers <span class="im">import</span> <span class="op">*</span></span>
<span id="cb1-9"><a href="#cb1-9"></a><span class="im">from</span> keras.losses <span class="im">import</span> <span class="op">*</span></span>
<span id="cb1-10"><a href="#cb1-10"></a><span class="im">from</span> keras.backend <span class="im">import</span> <span class="op">*</span></span>
<span id="cb1-11"><a href="#cb1-11"></a><span class="im">from</span> keras.optimizers <span class="im">import</span> <span class="op">*</span></span>
<span id="cb1-12"><a href="#cb1-12"></a><span class="im">from</span> keras.datasets <span class="im">import</span> <span class="op">*</span></span>
<span id="cb1-13"><a href="#cb1-13"></a><span class="im">from</span> keras.utils <span class="im">import</span> <span class="op">*</span></span>
<span id="cb1-14"><a href="#cb1-14"></a><span class="im">from</span> keras.callbacks <span class="im">import</span> <span class="op">*</span></span>
<span id="cb1-15"><a href="#cb1-15"></a><span class="im">import</span> numpy <span class="im">as</span> np</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><code>-</code> 데이터 설명</p>
<ul>
<li>IMDB : 50,000개의 영화 리뷰 데이터<code>(train, test 각각 25,000개)</code></li>
</ul>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:4651,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1705837161487,&quot;user&quot;:{&quot;displayName&quot;:&quot;ccc flkwerkdai&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-tags="[]" data-execution_count="22">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1"></a>(x_train, y_train), (x_test, y_test) <span class="op">=</span> imdb.load_data()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:292,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1705837161774,&quot;user&quot;:{&quot;displayName&quot;:&quot;ccc flkwerkdai&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-outputid="3e9adb29-8e90-4a88-f691-f668852eb8d2" data-tags="[]" data-execution_count="23">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1"></a><span class="bu">print</span>(x_train.shape)</span>
<span id="cb3-2"><a href="#cb3-2"></a><span class="bu">print</span>(x_test.shape)</span>
<span id="cb3-3"><a href="#cb3-3"></a><span class="bu">print</span>(y_train.shape)</span>
<span id="cb3-4"><a href="#cb3-4"></a><span class="bu">print</span>(y_test.shape)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(25000,)
(25000,)
(25000,)
(25000,)</code></pre>
</div>
</div>
</section>
<section id="eda" class="level1">
<h1>EDA</h1>
<section id="리뷰-길이-분포-확인" class="level2">
<h2 class="anchored" data-anchor-id="리뷰-길이-분포-확인">리뷰 길이 분포 확인</h2>
<p><code>-</code> train 리뷰 길이 분포 시각화</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:2,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1705837161774,&quot;user&quot;:{&quot;displayName&quot;:&quot;ccc flkwerkdai&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-execution_count="24">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:1135,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1705837162908,&quot;user&quot;:{&quot;displayName&quot;:&quot;ccc flkwerkdai&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-outputid="45ca09a6-e3e7-48a3-895b-ed93f3c5f6cf" data-tags="[]" data-execution_count="25">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1"></a>review_length <span class="op">=</span> [<span class="bu">len</span>(i) <span class="cf">for</span> i <span class="kw">in</span> x_train]</span>
<span id="cb6-2"><a href="#cb6-2"></a></span>
<span id="cb6-3"><a href="#cb6-3"></a>fig,axes <span class="op">=</span> plt.subplots(<span class="dv">1</span>,<span class="dv">2</span>, figsize <span class="op">=</span> (<span class="dv">12</span>,<span class="dv">4</span>))</span>
<span id="cb6-4"><a href="#cb6-4"></a></span>
<span id="cb6-5"><a href="#cb6-5"></a>ax1, ax2 <span class="op">=</span> axes</span>
<span id="cb6-6"><a href="#cb6-6"></a></span>
<span id="cb6-7"><a href="#cb6-7"></a>ax1.hist(review_length)</span>
<span id="cb6-8"><a href="#cb6-8"></a><span class="co">#ax1.set_title("리뷰길이 hist")</span></span>
<span id="cb6-9"><a href="#cb6-9"></a>ax2.boxplot(review_length)</span>
<span id="cb6-10"><a href="#cb6-10"></a><span class="co">#ax2.set_title("리뷰길이 boxplot")</span></span>
<span id="cb6-11"><a href="#cb6-11"></a>fig.tight_layout()</span>
<span id="cb6-12"><a href="#cb6-12"></a>plt.show()</span>
<span id="cb6-13"><a href="#cb6-13"></a></span>
<span id="cb6-14"><a href="#cb6-14"></a><span class="bu">print</span>(<span class="ss">f"리뷰의 최대 길이  : </span><span class="sc">{</span><span class="bu">max</span>(review_length)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb6-15"><a href="#cb6-15"></a><span class="bu">print</span>(<span class="ss">f"리뷰의 평균 길이  : </span><span class="sc">{</span>np<span class="sc">.</span>mean(review_length)<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2024-01-22-01. 텍스트 분류_files/figure-html/cell-6-output-1.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>리뷰의 최대 길이  : 2494
리뷰의 평균 길이  : 238.71364</code></pre>
</div>
</div>
</section>
<section id="라벨-분포-확인" class="level2">
<h2 class="anchored" data-anchor-id="라벨-분포-확인">라벨 분포 확인</h2>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:10,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1705837162908,&quot;user&quot;:{&quot;displayName&quot;:&quot;ccc flkwerkdai&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-outputid="c2744a28-fac7-4cc7-cc3a-8cfc2dd10bba" data-tags="[]" data-execution_count="26">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1"></a>index <span class="op">=</span> np.unique(y_train, return_counts<span class="op">=</span><span class="va">True</span>)[<span class="dv">0</span>]</span>
<span id="cb8-2"><a href="#cb8-2"></a>counts <span class="op">=</span> np.unique(y_train, return_counts<span class="op">=</span><span class="va">True</span>)[<span class="dv">1</span>]</span>
<span id="cb8-3"><a href="#cb8-3"></a></span>
<span id="cb8-4"><a href="#cb8-4"></a>np.asarray((index, counts))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="26">
<pre><code>array([[    0,     1],
       [12500, 12500]])</code></pre>
</div>
</div>
</section>
<section id="정수-맵핑-단어-확인" class="level2">
<h2 class="anchored" data-anchor-id="정수-맵핑-단어-확인">정수 맵핑 단어 확인</h2>
<p><code>-</code> imdb.get_word_index()에 각 단어와 맵핑되는 정수가 저장되어 있음</p>
<ul>
<li>주의 : 저장된 값에 +3을 해야 실제 맵핑되는 정수임 <strong>(이것은 IMDB 리뷰 데이터 셋에서 정한 규칙이다.)</strong></li>
</ul>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:8,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1705837162908,&quot;user&quot;:{&quot;displayName&quot;:&quot;ccc flkwerkdai&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-tags="[]" data-execution_count="27">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1"></a>word_to_index <span class="op">=</span> imdb.get_word_index()</span>
<span id="cb10-2"><a href="#cb10-2"></a><span class="co">#word_to_index</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:8,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1705837162908,&quot;user&quot;:{&quot;displayName&quot;:&quot;ccc flkwerkdai&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-tags="[]" data-execution_count="28">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1"></a>index_to_word <span class="op">=</span> {}</span>
<span id="cb11-2"><a href="#cb11-2"></a></span>
<span id="cb11-3"><a href="#cb11-3"></a><span class="cf">for</span> key, value <span class="kw">in</span> word_to_index.items() :</span>
<span id="cb11-4"><a href="#cb11-4"></a>    index_to_word[value<span class="op">+</span><span class="dv">3</span>] <span class="op">=</span> key</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li><code>index_to_word</code>에 인덱스를 집어넣으면 전처리 전에 어떤 단어였는지 확인할 수 있음.
<ul>
<li>0,1,2,3은 특별토큰, 정수 4부터가 실제 IMDB 리뷰 데이터셋에서 내림차순으로 빈도수가 영단어임</li>
</ul></li>
</ul>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:8,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1705837162909,&quot;user&quot;:{&quot;displayName&quot;:&quot;ccc flkwerkdai&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-outputid="b529adc0-5977-4874-fcb0-8579c4d22684" data-tags="[]" data-execution_count="29">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1"></a><span class="bu">print</span>(<span class="ss">f"빈도수 상위 1등 단어 : </span><span class="sc">{</span>index_to_word[<span class="dv">4</span>]<span class="sc">}</span><span class="ss">"</span> )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>빈도수 상위 1등 단어 : the</code></pre>
</div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:7,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1705837162909,&quot;user&quot;:{&quot;displayName&quot;:&quot;ccc flkwerkdai&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-outputid="a4767386-c244-4091-d9ca-18785e0b8322" data-tags="[]" data-execution_count="30">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1"></a><span class="bu">print</span>(<span class="ss">f"빈도수 상위 3938등 단어 : </span><span class="sc">{</span>index_to_word[<span class="dv">3941</span>]<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>빈도수 상위 3938등 단어 : suited</code></pre>
</div>
</div>
<p><code>-</code> 첫 번째 훈련용 리뷰의 각 단어가 정수로 바뀌기 전에 어떤 단어들이 었는지 확인</p>
<ul>
<li>아래작업은 0,1,2,3 특별토큰의 값을 집어넣는 과정</li>
</ul>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:6,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1705837162909,&quot;user&quot;:{&quot;displayName&quot;:&quot;ccc flkwerkdai&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-tags="[]" data-execution_count="31">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1"></a><span class="cf">for</span> index, token <span class="kw">in</span> <span class="bu">enumerate</span>((<span class="st">"&lt;pad&gt;"</span>, <span class="st">"&lt;sos&gt;"</span>, <span class="st">"&lt;unk&gt;"</span>)):</span>
<span id="cb16-2"><a href="#cb16-2"></a>  index_to_word[index] <span class="op">=</span> token</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:6,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1705837162909,&quot;user&quot;:{&quot;displayName&quot;:&quot;ccc flkwerkdai&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-outputid="67b2c912-f4f0-4d4b-95a1-0ae2f826d0b6" data-tags="[]" data-execution_count="32">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1"></a>index_to_word[<span class="dv">0</span>], index_to_word[<span class="dv">1</span>], index_to_word[<span class="dv">2</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="32">
<pre><code>('&lt;pad&gt;', '&lt;sos&gt;', '&lt;unk&gt;')</code></pre>
</div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:5,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1705837162909,&quot;user&quot;:{&quot;displayName&quot;:&quot;ccc flkwerkdai&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-outputid="2828dbde-cf91-4862-a7f2-34d5eda036f9" data-tags="[]" data-execution_count="33">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1"></a><span class="bu">print</span>(<span class="st">" "</span>.join([index_to_word[i] <span class="cf">for</span> i <span class="kw">in</span> x_train[<span class="dv">0</span>]]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;sos&gt; this film was just brilliant casting location scenery story direction everyone's really suited the part they played and you could just imagine being there robert redford's is an amazing actor and now the same being director norman's father came from the same scottish island as myself so i loved the fact there was a real connection with this film the witty remarks throughout the film were great it was just brilliant so much that i bought the film as soon as it was released for retail and would recommend it to everyone to watch and the fly fishing was amazing really cried at the end it was so sad and you know what they say if you cry at a film it must have been good and this definitely was also congratulations to the two little boy's that played the part's of norman and paul they were just brilliant children are often left out of the praising list i think because the stars that play them all grown up are such a big profile for the whole film but these children are amazing and should be praised for what they have done don't you think the whole story was so lovely because it was true and was someone's life after all that was shared with us all</code></pre>
</div>
</div>
</section>
</section>
<section id="모델-설계-1.simplernn-embedding" class="level1">
<h1>모델 설계 1.SimpleRNN + Embedding</h1>
<p><code>-</code> 단어집합의 크기를 10,000으로 제한하고, 리뷰 최대 길이는 20으로 제한하여 패딩을 진행</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:4888,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1705837661819,&quot;user&quot;:{&quot;displayName&quot;:&quot;ccc flkwerkdai&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-tags="[]" data-execution_count="43">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1"></a>max_len <span class="op">=</span> <span class="dv">20</span></span>
<span id="cb21-2"><a href="#cb21-2"></a>vocab_size <span class="op">=</span> <span class="dv">10000</span></span>
<span id="cb21-3"><a href="#cb21-3"></a></span>
<span id="cb21-4"><a href="#cb21-4"></a>(x_train, y_train), (x_test, y_test) <span class="op">=</span> imdb.load_data(num_words <span class="op">=</span> vocab_size)</span>
<span id="cb21-5"><a href="#cb21-5"></a></span>
<span id="cb21-6"><a href="#cb21-6"></a>x_train <span class="op">=</span> pad_sequences(x_train, maxlen<span class="op">=</span> max_len)</span>
<span id="cb21-7"><a href="#cb21-7"></a>x_test <span class="op">=</span> pad_sequences(x_test, maxlen<span class="op">=</span> max_len)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><code>-</code> <strong>임베딩 벡터 차원은</strong> 10, <strong>은닉노드 수는</strong> 32로 설정</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:5,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1705837916661,&quot;user&quot;:{&quot;displayName&quot;:&quot;ccc flkwerkdai&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-execution_count="46">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1"></a>SimpleRNN?</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:84825,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1705837749065,&quot;user&quot;:{&quot;displayName&quot;:&quot;ccc flkwerkdai&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-outputid="c59b5c93-71df-48af-ca95-834319ededeb" data-tags="[]" data-execution_count="44">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1"></a>embedding_dim <span class="op">=</span> <span class="dv">10</span></span>
<span id="cb23-2"><a href="#cb23-2"></a>hidden_units <span class="op">=</span> <span class="dv">20</span></span>
<span id="cb23-3"><a href="#cb23-3"></a></span>
<span id="cb23-4"><a href="#cb23-4"></a>clear_session()</span>
<span id="cb23-5"><a href="#cb23-5"></a>model <span class="op">=</span> Sequential()</span>
<span id="cb23-6"><a href="#cb23-6"></a>model.add(Embedding(input_dim <span class="op">=</span> vocab_size <span class="op">+</span> <span class="dv">1</span>,  output_dim <span class="op">=</span> embedding_dim, input_length  <span class="op">=</span> max_len ))</span>
<span id="cb23-7"><a href="#cb23-7"></a><span class="co">## input_dim  : 단어 목록의 크기</span></span>
<span id="cb23-8"><a href="#cb23-8"></a><span class="co">## output_dim : 임베딩 차원</span></span>
<span id="cb23-9"><a href="#cb23-9"></a><span class="co">## input_length : 인풋 시퀀스의 길이</span></span>
<span id="cb23-10"><a href="#cb23-10"></a>model.add(SimpleRNN(hidden_units))</span>
<span id="cb23-11"><a href="#cb23-11"></a>model.add(Dense(<span class="dv">1</span>, activation <span class="op">=</span> <span class="st">"sigmoid"</span>))</span>
<span id="cb23-12"><a href="#cb23-12"></a></span>
<span id="cb23-13"><a href="#cb23-13"></a>model.<span class="bu">compile</span>(optimizer <span class="op">=</span> Adam(<span class="fl">0.001</span>), loss <span class="op">=</span> <span class="st">"binary_crossentropy"</span>, metrics <span class="op">=</span> [<span class="st">"acc"</span>])</span>
<span id="cb23-14"><a href="#cb23-14"></a></span>
<span id="cb23-15"><a href="#cb23-15"></a>es <span class="op">=</span> EarlyStopping(monitor <span class="op">=</span> <span class="st">"val_loss"</span>, mode <span class="op">=</span>  <span class="st">"min"</span>, patience <span class="op">=</span> <span class="dv">5</span>, verbose <span class="op">=</span> <span class="dv">1</span>)</span>
<span id="cb23-16"><a href="#cb23-16"></a>mc <span class="op">=</span> ModelCheckpoint(<span class="st">"RNN1.h5"</span>, mode <span class="op">=</span> <span class="st">"min"</span>, save_best_only <span class="op">=</span> <span class="va">True</span>, verbose <span class="op">=</span> <span class="dv">1</span> )</span>
<span id="cb23-17"><a href="#cb23-17"></a></span>
<span id="cb23-18"><a href="#cb23-18"></a>history1 <span class="op">=</span> model.fit(x_train, y_train, epochs <span class="op">=</span> <span class="dv">10</span>,</span>
<span id="cb23-19"><a href="#cb23-19"></a>                   callbacks <span class="op">=</span> [es, mc], validation_split <span class="op">=</span> <span class="fl">0.2</span>).history</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch 1/10
625/625 [==============================] - ETA: 0s - loss: 0.5670 - acc: 0.6936
Epoch 1: val_loss improved from inf to 0.50182, saving model to RNN1.h5
625/625 [==============================] - 23s 33ms/step - loss: 0.5670 - acc: 0.6936 - val_loss: 0.5018 - val_acc: 0.7490
Epoch 2/10
  8/625 [..............................] - ETA: 9s - loss: 0.4269 - acc: 0.8086623/625 [============================&gt;.] - ETA: 0s - loss: 0.4080 - acc: 0.8167
Epoch 2: val_loss did not improve from 0.50182
625/625 [==============================] - 14s 22ms/step - loss: 0.4082 - acc: 0.8166 - val_loss: 0.5076 - val_acc: 0.7472
Epoch 3/10
622/625 [============================&gt;.] - ETA: 0s - loss: 0.3067 - acc: 0.8729
Epoch 3: val_loss did not improve from 0.50182
625/625 [==============================] - 13s 22ms/step - loss: 0.3066 - acc: 0.8727 - val_loss: 0.5756 - val_acc: 0.7404
Epoch 4/10
622/625 [============================&gt;.] - ETA: 0s - loss: 0.1966 - acc: 0.9280
Epoch 4: val_loss did not improve from 0.50182
625/625 [==============================] - 11s 18ms/step - loss: 0.1967 - acc: 0.9279 - val_loss: 0.7042 - val_acc: 0.7114
Epoch 5/10
623/625 [============================&gt;.] - ETA: 0s - loss: 0.1219 - acc: 0.9576
Epoch 5: val_loss did not improve from 0.50182
625/625 [==============================] - 12s 19ms/step - loss: 0.1221 - acc: 0.9575 - val_loss: 0.8506 - val_acc: 0.7212
Epoch 6/10
622/625 [============================&gt;.] - ETA: 0s - loss: 0.0707 - acc: 0.9775
Epoch 6: val_loss did not improve from 0.50182
625/625 [==============================] - 11s 18ms/step - loss: 0.0708 - acc: 0.9775 - val_loss: 1.0163 - val_acc: 0.7092
Epoch 6: early stopping</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>/usr/local/lib/python3.10/dist-packages/keras/src/engine/training.py:3103: UserWarning: You are saving your model as an HDF5 file via `model.save()`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')`.
  saving_api.save_model(</code></pre>
</div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:261,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1705837808492,&quot;user&quot;:{&quot;displayName&quot;:&quot;ccc flkwerkdai&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-outputid="d3ecd321-c29e-482c-c87c-be473262dbf5" data-execution_count="45">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1"></a>model.summary()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Model: "sequential"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 embedding (Embedding)       (None, 20, 10)            100010    
                                                                 
 simple_rnn (SimpleRNN)      (None, 20)                620       
                                                                 
 dense (Dense)               (None, 1)                 21        
                                                                 
=================================================================
Total params: 100651 (393.17 KB)
Trainable params: 100651 (393.17 KB)
Non-trainable params: 0 (0.00 Byte)
_________________________________________________________________</code></pre>
</div>
</div>
<p><code>-</code> 임베딩 층의 파라미터 수 : <code>(vocab_size +1) x ( embedding output_dim)</code></p>
<p><code>-</code> RNN 파라미터 수 : <code>(embedding output_dim + RNN output_dim + 1) x ( RNN output_dim)</code></p>
<ul>
<li>시계열 데이터로 생각하면 , 20일치 데이터(input_length)를 10개의 차원으로 전달해서 20개의 아웃풋레이어(RNN output_dim)를 가지는 RNN layer에 올린 것</li>
</ul>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:291,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1705838503601,&quot;user&quot;:{&quot;displayName&quot;:&quot;ccc flkwerkdai&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-outputid="988d20d6-7a89-46e7-927d-93b5a9637dc4" data-execution_count="49">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1"></a>(<span class="dv">10</span> <span class="op">+</span> <span class="dv">20</span> <span class="op">+</span><span class="dv">1</span>)<span class="op">*</span><span class="dv">20</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="49">
<pre><code>620</code></pre>
</div>
</div>
<section id="loss-시각화" class="level2">
<h2 class="anchored" data-anchor-id="loss-시각화">loss 시각화</h2>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:1142,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1705838682842,&quot;user&quot;:{&quot;displayName&quot;:&quot;ccc flkwerkdai&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-outputid="b32be7db-fcb9-4dbb-aea5-473135c48364" data-execution_count="50">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1"></a>plt.figure(figsize <span class="op">=</span> (<span class="dv">8</span>,<span class="dv">4</span>))</span>
<span id="cb30-2"><a href="#cb30-2"></a>plt.plot(history1[<span class="st">"loss"</span>], label <span class="op">=</span> <span class="st">"train_loss"</span>)</span>
<span id="cb30-3"><a href="#cb30-3"></a>plt.plot(history1[<span class="st">"val_loss"</span>], label <span class="op">=</span> <span class="st">"val_loss"</span>)</span>
<span id="cb30-4"><a href="#cb30-4"></a>plt.legend()</span>
<span id="cb30-5"><a href="#cb30-5"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2024-01-22-01. 텍스트 분류_files/figure-html/cell-20-output-1.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="predict" class="level2">
<h2 class="anchored" data-anchor-id="predict">predict</h2>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:5772,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1705838694913,&quot;user&quot;:{&quot;displayName&quot;:&quot;ccc flkwerkdai&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-outputid="997c6fcc-09f6-434f-bae3-c5dee720378f" data-tags="[]" data-execution_count="51">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1"></a>rnn_pred1 <span class="op">=</span>  model.predict(x_test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>782/782 [==============================] - 3s 3ms/step</code></pre>
</div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:292,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1705838820410,&quot;user&quot;:{&quot;displayName&quot;:&quot;ccc flkwerkdai&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-execution_count="58">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1"></a>rnn_pred1 <span class="op">=</span> np.where(rnn_pred1<span class="op">&gt;</span><span class="fl">0.5</span>,<span class="dv">1</span>,<span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:3,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1705838821852,&quot;user&quot;:{&quot;displayName&quot;:&quot;ccc flkwerkdai&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-tags="[]" data-execution_count="59">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> <span class="op">*</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:259,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1705838823141,&quot;user&quot;:{&quot;displayName&quot;:&quot;ccc flkwerkdai&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-outputid="9620ee7d-c411-4489-840e-32cb6f889328" data-execution_count="60">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1"></a><span class="bu">print</span>(confusion_matrix(y_test, rnn_pred1))</span>
<span id="cb35-2"><a href="#cb35-2"></a><span class="bu">print</span>(classification_report(y_test, rnn_pred1))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[8756 3744]
 [3500 9000]]
              precision    recall  f1-score   support

           0       0.71      0.70      0.71     12500
           1       0.71      0.72      0.71     12500

    accuracy                           0.71     25000
   macro avg       0.71      0.71      0.71     25000
weighted avg       0.71      0.71      0.71     25000
</code></pre>
</div>
</div>
</section>
</section>
<section id="모델-설계-2.-lstm" class="level1">
<h1>모델 설계 2. LSTM</h1>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:449,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1705839373142,&quot;user&quot;:{&quot;displayName&quot;:&quot;ccc flkwerkdai&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-execution_count="61">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1"></a>EarlyStopping?</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:645,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1705839713304,&quot;user&quot;:{&quot;displayName&quot;:&quot;ccc flkwerkdai&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-execution_count="72">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1"></a>clear_session()</span>
<span id="cb38-2"><a href="#cb38-2"></a></span>
<span id="cb38-3"><a href="#cb38-3"></a>model <span class="op">=</span> Sequential()</span>
<span id="cb38-4"><a href="#cb38-4"></a>model.add(Embedding(input_dim <span class="op">=</span> vocab_size <span class="op">+</span> <span class="dv">1</span>, output_dim <span class="op">=</span> embedding_dim, input_length <span class="op">=</span> max_len))</span>
<span id="cb38-5"><a href="#cb38-5"></a>model.add(LSTM(hidden_units))</span>
<span id="cb38-6"><a href="#cb38-6"></a>model.add(Dense(<span class="dv">1</span>, activation <span class="op">=</span> <span class="st">"sigmoid"</span>))</span>
<span id="cb38-7"><a href="#cb38-7"></a></span>
<span id="cb38-8"><a href="#cb38-8"></a>model.<span class="bu">compile</span>(optimizer <span class="op">=</span> Adam(<span class="fl">0.01</span>), loss <span class="op">=</span> <span class="st">"binary_crossentropy"</span>, metrics <span class="op">=</span> [<span class="st">"acc"</span>])</span>
<span id="cb38-9"><a href="#cb38-9"></a></span>
<span id="cb38-10"><a href="#cb38-10"></a>es <span class="op">=</span> EarlyStopping(mode <span class="op">=</span> <span class="st">"min"</span>, monitor <span class="op">=</span> <span class="st">"val_loss"</span>, patience <span class="op">=</span> <span class="dv">5</span>, verbose <span class="op">=</span> <span class="dv">1</span>)</span>
<span id="cb38-11"><a href="#cb38-11"></a>mc <span class="op">=</span> ModelCheckpoint(<span class="st">"LSTM.h5"</span>, mode <span class="op">=</span> <span class="st">"min"</span>, save_best_only <span class="op">=</span> <span class="va">True</span>, verbose <span class="op">=</span> <span class="dv">1</span> )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:32807,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1705839749017,&quot;user&quot;:{&quot;displayName&quot;:&quot;ccc flkwerkdai&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-outputid="e177a296-fd24-4736-9084-686cb41a36b9" data-execution_count="73">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1"></a>history2 <span class="op">=</span> model.fit(x_train, y_train, epochs <span class="op">=</span> <span class="dv">10</span>, callbacks <span class="op">=</span> [es,mc],</span>
<span id="cb39-2"><a href="#cb39-2"></a>                     validation_split <span class="op">=</span> <span class="fl">0.2</span>, verbose <span class="op">=</span> <span class="dv">1</span>).history</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch 1/10
623/625 [============================&gt;.] - ETA: 0s - loss: 0.5281 - acc: 0.7258
Epoch 1: val_loss improved from inf to 0.50094, saving model to LSTM.h5
625/625 [==============================] - 12s 15ms/step - loss: 0.5283 - acc: 0.7255 - val_loss: 0.5009 - val_acc: 0.7414
Epoch 2/10
 34/625 [&gt;.............................] - ETA: 2s - loss: 0.3461 - acc: 0.8493625/625 [==============================] - ETA: 0s - loss: 0.3804 - acc: 0.8264
Epoch 2: val_loss did not improve from 0.50094
625/625 [==============================] - 5s 8ms/step - loss: 0.3804 - acc: 0.8264 - val_loss: 0.5033 - val_acc: 0.7534
Epoch 3/10
618/625 [============================&gt;.] - ETA: 0s - loss: 0.2874 - acc: 0.8742
Epoch 3: val_loss did not improve from 0.50094
625/625 [==============================] - 4s 6ms/step - loss: 0.2875 - acc: 0.8743 - val_loss: 0.6100 - val_acc: 0.7492
Epoch 4/10
625/625 [==============================] - ETA: 0s - loss: 0.2162 - acc: 0.9088
Epoch 4: val_loss did not improve from 0.50094
625/625 [==============================] - 4s 7ms/step - loss: 0.2162 - acc: 0.9088 - val_loss: 0.6736 - val_acc: 0.7470
Epoch 5/10
619/625 [============================&gt;.] - ETA: 0s - loss: 0.1592 - acc: 0.9352
Epoch 5: val_loss did not improve from 0.50094
625/625 [==============================] - 4s 7ms/step - loss: 0.1598 - acc: 0.9351 - val_loss: 0.8045 - val_acc: 0.7416
Epoch 6/10
617/625 [============================&gt;.] - ETA: 0s - loss: 0.1186 - acc: 0.9536
Epoch 6: val_loss did not improve from 0.50094
625/625 [==============================] - 4s 6ms/step - loss: 0.1186 - acc: 0.9538 - val_loss: 0.9415 - val_acc: 0.7422
Epoch 6: early stopping</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>/usr/local/lib/python3.10/dist-packages/keras/src/engine/training.py:3103: UserWarning: You are saving your model as an HDF5 file via `model.save()`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')`.
  saving_api.save_model(</code></pre>
</div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:7059,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1705839759593,&quot;user&quot;:{&quot;displayName&quot;:&quot;ccc flkwerkdai&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-outputid="c22eda44-a893-4423-b973-6f8a51e56cc7" data-execution_count="74">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1"></a>plt.figure(figsize <span class="op">=</span> (<span class="dv">8</span>,<span class="dv">4</span>))</span>
<span id="cb42-2"><a href="#cb42-2"></a>plt.plot(history2[<span class="st">"loss"</span>], label <span class="op">=</span> <span class="st">"train_loss"</span>)</span>
<span id="cb42-3"><a href="#cb42-3"></a>plt.plot(history2[<span class="st">"val_loss"</span>], label <span class="op">=</span> <span class="st">"val_loss"</span>)</span>
<span id="cb42-4"><a href="#cb42-4"></a>plt.legend()</span>
<span id="cb42-5"><a href="#cb42-5"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2024-01-22-01. 텍스트 분류_files/figure-html/cell-28-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:3182,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1705839765983,&quot;user&quot;:{&quot;displayName&quot;:&quot;ccc flkwerkdai&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-outputid="ef49155d-7129-4629-b6e2-549fdcc08b96" data-execution_count="75">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1"></a>lstm_pred1 <span class="op">=</span>  model.predict(x_test)</span>
<span id="cb43-2"><a href="#cb43-2"></a>lstm_pred1 <span class="op">=</span> np.where(lstm_pred1<span class="op">&gt;</span><span class="fl">0.5</span>,<span class="dv">1</span>,<span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>782/782 [==============================] - 2s 2ms/step</code></pre>
</div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:3,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1705839765984,&quot;user&quot;:{&quot;displayName&quot;:&quot;ccc flkwerkdai&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-outputid="f3a32d27-7b79-441d-ad28-07378c5c95c8" data-execution_count="76">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1"></a><span class="bu">print</span>(confusion_matrix(y_test, lstm_pred1))</span>
<span id="cb45-2"><a href="#cb45-2"></a><span class="bu">print</span>(classification_report(y_test, lstm_pred1))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[9545 2955]
 [3653 8847]]
              precision    recall  f1-score   support

           0       0.72      0.76      0.74     12500
           1       0.75      0.71      0.73     12500

    accuracy                           0.74     25000
   macro avg       0.74      0.74      0.74     25000
weighted avg       0.74      0.74      0.74     25000
</code></pre>
</div>
</div>
<p><code>-</code> 성능이 RNN보다 좋기는 하나 그렇게 막 뛰어나진 않음..</p>
</section>
<section id="모델-설계3.-cnn" class="level1">
<h1>모델 설계3. CNN</h1>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:277,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1705840170566,&quot;user&quot;:{&quot;displayName&quot;:&quot;ccc flkwerkdai&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-execution_count="77">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1"></a>num_filters <span class="op">=</span> <span class="dv">10</span> <span class="co">## 새록게 만들려는 커널 수 (feature map의 수) 10개 생성</span></span>
<span id="cb47-2"><a href="#cb47-2"></a></span>
<span id="cb47-3"><a href="#cb47-3"></a>kernel_size <span class="op">=</span> <span class="dv">3</span> <span class="co">## 커널의 크기</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:316,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1705840364795,&quot;user&quot;:{&quot;displayName&quot;:&quot;ccc flkwerkdai&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-execution_count="78">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1"></a>model <span class="op">=</span> Sequential()</span>
<span id="cb48-2"><a href="#cb48-2"></a></span>
<span id="cb48-3"><a href="#cb48-3"></a>model.add(Embedding(input_dim <span class="op">=</span> vocab_size <span class="op">+</span> <span class="dv">1</span>, output_dim <span class="op">=</span> embedding_dim, input_length <span class="op">=</span> max_len))</span>
<span id="cb48-4"><a href="#cb48-4"></a>model.add(Conv1D(num_filters, kernel_size, padding <span class="op">=</span> <span class="st">"same"</span>, activation <span class="op">=</span> <span class="st">"relu"</span>))</span>
<span id="cb48-5"><a href="#cb48-5"></a>model.add(GlobalMaxPooling1D())</span>
<span id="cb48-6"><a href="#cb48-6"></a>model.add(Dense(hidden_units, activation <span class="op">=</span> <span class="st">"relu"</span>))</span>
<span id="cb48-7"><a href="#cb48-7"></a>model.add(Dense(<span class="dv">1</span>, activation <span class="op">=</span> <span class="st">"sigmoid"</span>))</span>
<span id="cb48-8"><a href="#cb48-8"></a></span>
<span id="cb48-9"><a href="#cb48-9"></a>model.<span class="bu">compile</span>(optimizer <span class="op">=</span> Adam(<span class="fl">0.01</span>), metrics <span class="op">=</span> [<span class="st">"acc"</span>], loss <span class="op">=</span> <span class="st">"binary_crossentropy"</span>)</span>
<span id="cb48-10"><a href="#cb48-10"></a></span>
<span id="cb48-11"><a href="#cb48-11"></a>es <span class="op">=</span> EarlyStopping(mode <span class="op">=</span> <span class="st">"min"</span>, monitor <span class="op">=</span> <span class="st">"val_loss"</span>, verbose <span class="op">=</span> <span class="dv">1</span>, patience <span class="op">=</span> <span class="dv">5</span>)</span>
<span id="cb48-12"><a href="#cb48-12"></a>mc <span class="op">=</span> mc <span class="op">=</span> ModelCheckpoint(<span class="st">"CNN.h5"</span>, mode <span class="op">=</span> <span class="st">"min"</span>, save_best_only <span class="op">=</span> <span class="va">True</span>, verbose <span class="op">=</span> <span class="dv">1</span> )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:38979,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1705840449362,&quot;user&quot;:{&quot;displayName&quot;:&quot;ccc flkwerkdai&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-outputid="b7cefe90-bd7a-4f5d-c4ae-3496be59e1b0" data-execution_count="79">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1"></a>history3 <span class="op">=</span> model.fit(x_train, y_train, epochs <span class="op">=</span> <span class="dv">10</span>, validation_split <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span id="cb49-2"><a href="#cb49-2"></a>              callbacks <span class="op">=</span> [es,mc]).history</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch 1/10
623/625 [============================&gt;.] - ETA: 0s - loss: 0.5519 - acc: 0.7008
Epoch 1: val_loss improved from inf to 0.50028, saving model to CNN.h5
625/625 [==============================] - 18s 24ms/step - loss: 0.5518 - acc: 0.7009 - val_loss: 0.5003 - val_acc: 0.7370
Epoch 2/10
 13/625 [..............................] - ETA: 2s - loss: 0.3673 - acc: 0.8269622/625 [============================&gt;.] - ETA: 0s - loss: 0.4185 - acc: 0.8055
Epoch 2: val_loss did not improve from 0.50028
625/625 [==============================] - 4s 6ms/step - loss: 0.4183 - acc: 0.8055 - val_loss: 0.5387 - val_acc: 0.7400
Epoch 3/10
623/625 [============================&gt;.] - ETA: 0s - loss: 0.3108 - acc: 0.8669
Epoch 3: val_loss did not improve from 0.50028
625/625 [==============================] - 5s 7ms/step - loss: 0.3111 - acc: 0.8669 - val_loss: 0.5776 - val_acc: 0.7450
Epoch 4/10
616/625 [============================&gt;.] - ETA: 0s - loss: 0.2270 - acc: 0.9083
Epoch 4: val_loss did not improve from 0.50028
625/625 [==============================] - 3s 5ms/step - loss: 0.2273 - acc: 0.9082 - val_loss: 0.6714 - val_acc: 0.7372
Epoch 5/10
622/625 [============================&gt;.] - ETA: 0s - loss: 0.1641 - acc: 0.9362
Epoch 5: val_loss did not improve from 0.50028
625/625 [==============================] - 4s 7ms/step - loss: 0.1643 - acc: 0.9360 - val_loss: 0.7790 - val_acc: 0.7376
Epoch 6/10
624/625 [============================&gt;.] - ETA: 0s - loss: 0.1187 - acc: 0.9548
Epoch 6: val_loss did not improve from 0.50028
625/625 [==============================] - 5s 8ms/step - loss: 0.1187 - acc: 0.9549 - val_loss: 0.9241 - val_acc: 0.7348
Epoch 6: early stopping</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>/usr/local/lib/python3.10/dist-packages/keras/src/engine/training.py:3103: UserWarning: You are saving your model as an HDF5 file via `model.save()`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')`.
  saving_api.save_model(</code></pre>
</div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:6,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1705840449362,&quot;user&quot;:{&quot;displayName&quot;:&quot;ccc flkwerkdai&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-outputid="9f2403dc-3356-4078-ac30-bf97e3c1df08" data-execution_count="80">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1"></a>model.summary()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Model: "sequential_1"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 embedding_1 (Embedding)     (None, 20, 10)            100010    
                                                                 
 conv1d (Conv1D)             (None, 20, 10)            310       
                                                                 
 global_max_pooling1d (Glob  (None, 10)                0         
 alMaxPooling1D)                                                 
                                                                 
 dense_1 (Dense)             (None, 20)                220       
                                                                 
 dense_2 (Dense)             (None, 1)                 21        
                                                                 
=================================================================
Total params: 100561 (392.82 KB)
Trainable params: 100561 (392.82 KB)
Non-trainable params: 0 (0.00 Byte)
_________________________________________________________________</code></pre>
</div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:520,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1705840482501,&quot;user&quot;:{&quot;displayName&quot;:&quot;ccc flkwerkdai&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-outputid="0a4d45f1-da28-4304-9625-a7978201f397" data-execution_count="83">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1"></a>plt.figure(figsize <span class="op">=</span> (<span class="dv">8</span>,<span class="dv">4</span>))</span>
<span id="cb54-2"><a href="#cb54-2"></a>plt.plot(history3[<span class="st">"loss"</span>], label <span class="op">=</span> <span class="st">"train_loss"</span>)</span>
<span id="cb54-3"><a href="#cb54-3"></a>plt.plot(history3[<span class="st">"val_loss"</span>], label <span class="op">=</span> <span class="st">"val_loss"</span>)</span>
<span id="cb54-4"><a href="#cb54-4"></a>plt.legend()</span>
<span id="cb54-5"><a href="#cb54-5"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2024-01-22-01. 텍스트 분류_files/figure-html/cell-35-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:2481,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1705840466623,&quot;user&quot;:{&quot;displayName&quot;:&quot;ccc flkwerkdai&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-outputid="1274f65e-5359-4c5d-b3d3-a1b068c33d90" data-execution_count="82">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1"></a>cnn_pred1 <span class="op">=</span>  model.predict(x_test)</span>
<span id="cb55-2"><a href="#cb55-2"></a>cnn_pred1 <span class="op">=</span> np.where(cnn_pred1<span class="op">&gt;</span><span class="fl">0.5</span>,<span class="dv">1</span>,<span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>782/782 [==============================] - 2s 2ms/step</code></pre>
</div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:313,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1705840501794,&quot;user&quot;:{&quot;displayName&quot;:&quot;ccc flkwerkdai&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-outputid="4b18f7f6-9c36-44ef-c444-7158d3ab5bb5" data-execution_count="85">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1"></a><span class="bu">print</span>(confusion_matrix(y_test, cnn_pred1))</span>
<span id="cb57-2"><a href="#cb57-2"></a><span class="bu">print</span>(classification_report(y_test, cnn_pred1))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[9166 3334]
 [3385 9115]]
              precision    recall  f1-score   support

           0       0.73      0.73      0.73     12500
           1       0.73      0.73      0.73     12500

    accuracy                           0.73     25000
   macro avg       0.73      0.73      0.73     25000
weighted avg       0.73      0.73      0.73     25000
</code></pre>
</div>
</div>
</section>
<section id="summary" class="level1">
<h1>summary</h1>
<p><code>1</code> 3가지 모델 전부 그렇게 성능의 차이가 나지는 않음.</p>
<p><code>2</code> 학습 시간 때문에 의도적으로 vocab_size와 <code>embedding node</code>의 수를 낮춰서 그런것 같음</p>
</section>
<section id="do-next" class="level1">
<h1>do next</h1>
<p><code>1</code> associate 복습</p>
<p><code>2</code> 이미지 분류 복습</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../../../posts/EX/advanced/2024-01-21-00. Associate review.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">00. Associate Review</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../../../posts/EX/advanced/2024-01-22-02.이미지_분류.html" class="pagination-link">
        <span class="nav-page-text">02. 이미지 분류</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>